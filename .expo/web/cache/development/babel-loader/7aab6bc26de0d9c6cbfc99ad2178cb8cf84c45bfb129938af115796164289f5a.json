{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\student\\\\StudentDashboard.tsx\";\nimport React, { useState, useEffect, lazy, Suspense } from 'react';\nimport { DashboardType } from '../../types';\nimport { THEME_CONFIG, ChartBarIcon, ChevronRightIcon, SUBJECT_COLORS, BookOpenIcon, CalendarIcon, SparklesIcon, GameControllerIcon } from '../../constants';\nimport Header from '../ui/Header';\nimport { StudentBottomNav } from '../ui/DashboardBottomNav';\nimport '../../data';\nimport ErrorBoundary from '../ui/ErrorBoundary';\nimport { StudentSidebar } from '../ui/DashboardSidebar';\nconst GlobalSearchScreen = lazy(() => import('../shared/GlobalSearchScreen'));\nconst StudyBuddy = lazy(() => import('../student/StudyBuddy'));\nconst AdventureQuestHost = lazy(() => import('../student/adventure/AdventureQuestHost'));\nconst ExamSchedule = lazy(() => import('../shared/ExamSchedule'));\nconst NoticeboardScreen = lazy(() => import('../shared/NoticeboardScreen'));\nconst CalendarScreen = lazy(() => import('../shared/CalendarScreen'));\nconst LibraryScreen = lazy(() => import('../shared/LibraryScreen'));\nconst CurriculumScreen = lazy(() => import('../shared/CurriculumScreen'));\nconst TimetableScreen = lazy(() => import('../shared/TimetableScreen'));\nconst AssignmentsScreen = lazy(() => import('../student/AssignmentsScreen'));\nconst SubjectsScreen = lazy(() => import('../student/SubjectsScreen'));\nconst ClassroomScreen = lazy(() => import('../student/ClassroomScreen'));\nconst AttendanceScreen = lazy(() => import('../student/AttendanceScreen'));\nconst ResultsScreen = lazy(() => import('../student/ResultsScreen'));\nconst StudentFinanceScreen = lazy(() => import('../student/StudentFinanceScreen'));\nconst AchievementsScreen = lazy(() => import('../student/AchievementsScreen'));\nconst StudentMessagesScreen = lazy(() => import('../student/StudentMessagesScreen'));\nconst StudentNewChatScreen = lazy(() => import('../student/NewMessageScreen'));\nconst EditProfileScreen = lazy(() => import('../shared/EditProfileScreen'));\nimport StudentProfileEnhanced from './StudentProfileEnhanced';\nconst VideoLessonScreen = lazy(() => import('../student/VideoLessonScreen'));\nconst AssignmentSubmissionScreen = lazy(() => import('../student/AssignmentSubmissionScreen'));\nconst AssignmentFeedbackScreen = lazy(() => import('../student/AssignmentFeedbackScreen'));\nconst AcademicReportScreen = lazy(() => import('../student/AcademicReportScreen'));\nconst ChatScreen = lazy(() => import('../shared/ChatScreen'));\nconst ExtracurricularsScreen = lazy(() => import('../student/ExtracurricularsScreen'));\nconst NotificationsScreen = lazy(() => import('../shared/NotificationsScreen'));\nconst QuizzesScreen = lazy(() => import('../student/QuizzesScreen'));\nconst QuizPlayerScreen = lazy(() => import('../student/QuizPlayerScreen'));\nconst GamesHubScreen = lazy(() => import('../student/games/GamesHubScreen'));\nconst MathSprintLobbyScreen = lazy(() => import('../student/games/MathSprintLobbyScreen'));\nconst MathSprintGameScreen = lazy(() => import('../student/games/MathSprintGameScreen'));\nconst MathSprintResultsScreen = lazy(() => import('../student/games/MathSprintResultsScreen'));\nconst GamePlayerScreen = lazy(() => import('../shared/GamePlayerScreen'));\nconst DashboardSuspenseFallback = () => _jsxDEV(\"div\", {\n  className: \"flex justify-center items-center h-full p-8\",\n  children: _jsxDEV(\"div\", {\n    className: \"w-10 h-10 border-4 border-t-4 border-gray-200 border-t-orange-600 rounded-full animate-spin\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 9\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 50,\n  columnNumber: 5\n}, this);\nimport { supabase } from '../../lib/supabase';\nconst TodayFocus = ({\n  schedule,\n  assignments,\n  theme,\n  navigateTo\n}) => {\n  const formatTime = timeStr => {\n    if (!timeStr) return '';\n    return timeStr.includes('T') ? new Date(timeStr).toLocaleTimeString([], {\n      hour: 'numeric',\n      minute: '2-digit'\n    }) : timeStr.substring(0, 5);\n  };\n  return _jsxDEV(\"div\", {\n    className: \"bg-white p-4 rounded-2xl shadow-sm\",\n    children: [_jsxDEV(\"h3\", {\n      className: \"font-bold text-lg text-gray-800 mb-3\",\n      children: \"Today's Focus\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      className: \"space-y-3\",\n      children: [schedule.length > 0 ? _jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [_jsxDEV(\"h4\", {\n          className: \"text-sm font-semibold text-gray-500\",\n          children: \"Next Up\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 25\n        }, this), schedule.slice(0, 2).map((entry, i) => _jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3\",\n          children: [_jsxDEV(\"div\", {\n            className: \"w-16 text-right\",\n            children: _jsxDEV(\"p\", {\n              className: \"font-semibold text-sm text-gray-700\",\n              children: entry.start_time || entry.startTime\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 84,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 33\n          }, this), _jsxDEV(\"div\", {\n            className: `w-1 h-10 rounded-full ${SUBJECT_COLORS[entry.subject] || 'bg-gray-400'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 33\n          }, this), _jsxDEV(\"p\", {\n            className: \"font-semibold text-gray-800\",\n            children: entry.subject\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 33\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 29\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 21\n      }, this) : _jsxDEV(\"p\", {\n        className: \"text-sm text-center text-gray-500 py-2\",\n        children: \"No more classes today!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }, this), _jsxDEV(\"div\", {\n        className: \"border-t border-gray-100 my-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this), assignments.length > 0 ? _jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [_jsxDEV(\"h4\", {\n          className: \"text-sm font-semibold text-gray-500\",\n          children: \"Assignments Due Soon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 25\n        }, this), assignments.map(hw => _jsxDEV(\"button\", {\n          onClick: () => navigateTo('assignmentSubmission', 'Submit Assignment', {\n            assignment: hw\n          }),\n          className: \"w-full flex justify-between items-center p-2 rounded-lg hover:bg-gray-50 transition-colors text-left\",\n          children: [_jsxDEV(\"div\", {\n            children: [_jsxDEV(\"p\", {\n              className: \"font-bold text-gray-800 text-sm\",\n              children: hw.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 37\n            }, this), _jsxDEV(\"p\", {\n              className: \"text-xs text-gray-500\",\n              children: [hw.subject, \" \\u2022 Due \", new Date(hw.due_date || hw.dueDate).toLocaleDateString('en-GB')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 33\n          }, this), _jsxDEV(ChevronRightIcon, {\n            className: \"text-gray-400 h-5 w-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 33\n          }, this)]\n        }, hw.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 29\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }, this) : _jsxDEV(\"p\", {\n        className: \"text-sm text-center text-gray-500 py-2\",\n        children: \"No assignments due soon. Great work!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n};\nconst Overview = ({\n  navigateTo,\n  student\n}) => {\n  const theme = THEME_CONFIG[DashboardType.Student];\n  const [todaySchedule, setTodaySchedule] = useState([]);\n  const [upcomingAssignments, setUpcomingAssignments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const today = new Date().toLocaleDateString('en-US', {\n          weekday: 'long'\n        });\n        const timetablePromise = supabase.from('timetable').select('*').eq('day', today).ilike('class_name', `%${student.grade}%`).order('start_time', {\n          ascending: true\n        }).limit(3);\n        const assignmentsPromise = supabase.from('assignments').select('*').gt('due_date', new Date().toISOString()).order('due_date', {\n          ascending: true\n        }).limit(2);\n        const [timetableResult, assignmentsResult] = await Promise.all([timetablePromise, assignmentsPromise]);\n        if (timetableResult.data) setTodaySchedule(timetableResult.data);\n        if (assignmentsResult.data) setUpcomingAssignments(assignmentsResult.data);\n      } catch (err) {\n        console.error('Error fetching overview data:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    if (student) fetchData();\n  }, [student]);\n  const quickAccessItems = [{\n    label: 'Subjects',\n    icon: _jsxDEV(BookOpenIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 36\n    }, this),\n    action: () => navigateTo('subjects', 'My Subjects')\n  }, {\n    label: 'Timetable',\n    icon: _jsxDEV(CalendarIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 37\n    }, this),\n    action: () => navigateTo('timetable', 'Timetable')\n  }, {\n    label: 'Results',\n    icon: _jsxDEV(ChartBarIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 35\n    }, this),\n    action: () => navigateTo('results', 'Academic Performance', {\n      studentId: student.id\n    })\n  }, {\n    label: 'Games',\n    icon: _jsxDEV(GameControllerIcon, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 33\n    }, this),\n    action: () => navigateTo('gamesHub', 'Games Hub')\n  }];\n  const aiTools = [{\n    label: 'AI Study Buddy',\n    description: 'Stuck on a problem?',\n    color: 'from-purple-500 to-indigo-600',\n    action: () => navigateTo('studyBuddy', 'Study Buddy')\n  }, {\n    label: 'AI Adventure Quest',\n    description: 'Turn any text into a fun quiz!',\n    color: 'from-teal-400 to-blue-500',\n    action: () => navigateTo('adventureQuest', 'AI Adventure Quest', {})\n  }];\n  if (loading) return _jsxDEV(\"div\", {\n    className: \"p-8 text-center text-gray-500\",\n    children: \"Loading overview...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 175,\n    columnNumber: 25\n  }, this);\n  return _jsxDEV(\"div\", {\n    className: \"p-4 lg:p-6 bg-gray-50 min-h-full\",\n    children: _jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 lg:grid-cols-3 gap-6\",\n      children: [_jsxDEV(\"div\", {\n        className: \"lg:col-span-2 space-y-6\",\n        children: [_jsxDEV(TodayFocus, {\n          schedule: todaySchedule,\n          assignments: upcomingAssignments,\n          theme: theme,\n          navigateTo: navigateTo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          children: [_jsxDEV(\"h3\", {\n            className: \"text-lg font-bold text-gray-800 mb-2 px-1\",\n            children: \"AI Tools\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }, this), _jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 md:grid-cols-2 gap-4\",\n            children: aiTools.map(tool => _jsxDEV(\"button\", {\n              onClick: tool.action,\n              className: `p-4 rounded-2xl shadow-lg text-white bg-gradient-to-r ${tool.color}`,\n              children: [_jsxDEV(SparklesIcon, {\n                className: \"h-6 w-6 mb-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 37\n              }, this), _jsxDEV(\"h4\", {\n                className: \"font-bold text-left\",\n                children: tool.label\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 37\n              }, this), _jsxDEV(\"p\", {\n                className: \"text-xs opacity-90 text-left\",\n                children: tool.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 37\n              }, this)]\n            }, tool.label, true, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 33\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"lg:col-span-1 space-y-6\",\n        children: _jsxDEV(\"div\", {\n          children: [_jsxDEV(\"h3\", {\n            className: \"text-lg font-bold text-gray-800 mb-2 px-1\",\n            children: \"Quick Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 25\n          }, this), _jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-3 text-center\",\n            children: quickAccessItems.map(item => _jsxDEV(\"button\", {\n              onClick: item.action,\n              className: \"bg-white p-3 rounded-2xl shadow-sm flex flex-col items-center justify-center space-y-2 hover:bg-orange-100 transition-colors\",\n              children: [_jsxDEV(\"div\", {\n                className: theme.iconColor,\n                children: React.cloneElement(item.icon, {\n                  className: 'h-7 w-7'\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 37\n              }, this), _jsxDEV(\"span\", {\n                className: `font-semibold ${theme.textColor} text-center text-xs`,\n                children: item.label\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 37\n              }, this)]\n            }, item.label, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 33\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 178,\n    columnNumber: 9\n  }, this);\n};\nimport { useRealtimeNotifications } from '../../hooks/useRealtimeNotifications';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StudentDashboard = ({\n  onLogout,\n  setIsHomePage,\n  currentUser\n}) => {\n  const [viewStack, setViewStack] = useState([{\n    view: 'overview',\n    title: 'Student Dashboard'\n  }]);\n  const [activeBottomNav, setActiveBottomNav] = useState('home');\n  const [version, setVersion] = useState(0);\n  const [isSearchOpen, setIsSearchOpen] = useState(false);\n  const [student, setStudent] = useState(null);\n  const [loadingStudent, setLoadingStudent] = useState(true);\n  const notificationCount = useRealtimeNotifications('student');\n  const forceUpdate = () => setVersion(v => v + 1);\n  useEffect(() => {\n    const fetchStudentAndNotifications = async () => {\n      try {\n        if (!currentUser?.email) {\n          setLoadingStudent(false);\n          return;\n        }\n        const isDemoEmail = currentUser.email?.endsWith('@school.com') || currentUser.email?.includes('student') || currentUser.email?.includes('demo');\n        const createDemoStudent = () => ({\n          id: 1,\n          name: currentUser.user_metadata?.full_name || 'Demo Student',\n          grade: 10,\n          section: 'A',\n          avatarUrl: 'https://i.pravatar.cc/150?img=1',\n          email: currentUser.email,\n          department: 'Science',\n          attendanceStatus: 'Present'\n        });\n        let studentData = null;\n        const {\n          data: students\n        } = await supabase.from('students').select('*').eq('user_id', currentUser.id).maybeSingle();\n        studentData = students;\n        if (!studentData && currentUser.email) {\n          const {\n            data: byEmail\n          } = await supabase.from('students').select('*').eq('email', currentUser.email).maybeSingle();\n          if (byEmail) studentData = byEmail;\n        }\n        if (studentData) {\n          const mappedStudent = Object.assign({}, studentData, {\n            id: studentData.id,\n            name: studentData.name,\n            grade: studentData.grade,\n            section: studentData.section,\n            avatarUrl: studentData.avatar_url\n          });\n          setStudent(mappedStudent);\n        } else if (isDemoEmail) {\n          setStudent(createDemoStudent());\n        } else {\n          console.warn('No linked student profile found.');\n        }\n      } catch (e) {\n        console.error('Error loading dashboard:', e);\n        const isDemoEmail = currentUser?.email?.endsWith('@school.com') || currentUser?.email?.includes('student') || currentUser?.email?.includes('demo');\n        if (isDemoEmail) {\n          setStudent({\n            id: 1,\n            name: 'Demo Student',\n            grade: 10,\n            section: 'A',\n            avatarUrl: 'https://i.pravatar.cc/150?img=1',\n            email: currentUser?.email || '',\n            department: 'Science',\n            attendanceStatus: 'Present'\n          });\n        }\n      } finally {\n        setLoadingStudent(false);\n      }\n    };\n    fetchStudentAndNotifications();\n  }, [currentUser]);\n  useEffect(() => {\n    const currentView = viewStack[viewStack.length - 1];\n    setIsHomePage(currentView.view === 'overview' && !isSearchOpen);\n    const viewToNavMap = {\n      overview: 'home',\n      subjects: 'home',\n      timetable: 'home',\n      results: 'results',\n      quizzes: 'quizzes',\n      quizPlayer: 'quizzes',\n      gamesHub: 'games',\n      mathSprintLobby: 'games',\n      mathSprintGame: 'games',\n      mathSprintResults: 'games',\n      gamePlayer: 'games',\n      messages: 'messages',\n      newChat: 'messages',\n      chat: 'messages',\n      profile: 'profile'\n    };\n    const targetNav = viewToNavMap[currentView.view];\n    if (targetNav) {\n      setActiveBottomNav(targetNav);\n    }\n  }, [viewStack, isSearchOpen, setIsHomePage]);\n  const navigateTo = (view, title, props = {}) => {\n    setViewStack(stack => [...stack, {\n      view,\n      props,\n      title\n    }]);\n  };\n  const handleBack = () => {\n    if (viewStack.length > 1) {\n      setViewStack(stack => stack.slice(0, -1));\n    }\n  };\n  const handleBottomNavClick = screen => {\n    if (!student) return;\n    setActiveBottomNav(screen);\n    switch (screen) {\n      case 'home':\n        setViewStack([{\n          view: 'overview',\n          title: 'Student Dashboard'\n        }]);\n        break;\n      case 'quizzes':\n        setViewStack([{\n          view: 'quizzes',\n          title: 'Assessments & Quizzes'\n        }]);\n        break;\n      case 'results':\n        setViewStack([{\n          view: 'results',\n          title: 'Academic Performance',\n          props: {\n            studentId: student.id\n          }\n        }]);\n        break;\n      case 'games':\n        setViewStack([{\n          view: 'gamesHub',\n          title: 'Games Hub'\n        }]);\n        break;\n      case 'messages':\n        setViewStack([{\n          view: 'messages',\n          title: 'Messages'\n        }]);\n        break;\n      case 'profile':\n        setViewStack([{\n          view: 'profile',\n          title: 'My Profile',\n          props: {}\n        }]);\n        break;\n      default:\n        setViewStack([{\n          view: 'overview',\n          title: 'Student Dashboard'\n        }]);\n    }\n  };\n  const handleNotificationClick = () => {\n    navigateTo('notifications', 'Notifications', {});\n  };\n  const viewComponents = React.useMemo(() => ({\n    overview: Overview,\n    studyBuddy: StudyBuddy,\n    adventureQuest: AdventureQuestHost,\n    examSchedule: ExamSchedule,\n    noticeboard: props => _jsxDEV(NoticeboardScreen, Object.assign({}, props, {\n      userType: \"student\"\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 38\n    }, this),\n    calendar: props => _jsxDEV(CalendarScreen, Object.assign({}, props, {\n      birthdayHighlights: student?.birthday ? [{\n        date: student.birthday,\n        label: 'Your Birthday'\n      }] : []\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 35\n    }, this),\n    library: LibraryScreen,\n    curriculum: CurriculumScreen,\n    timetable: props => _jsxDEV(TimetableScreen, Object.assign({}, props, {\n      context: {\n        userType: 'student',\n        userId: student?.id\n      }\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 36\n    }, this),\n    assignments: AssignmentsScreen,\n    subjects: SubjectsScreen,\n    classroom: ClassroomScreen,\n    attendance: AttendanceScreen,\n    results: ResultsScreen,\n    finances: StudentFinanceScreen,\n    achievements: AchievementsScreen,\n    messages: StudentMessagesScreen,\n    newChat: StudentNewChatScreen,\n    profile: props => _jsxDEV(StudentProfileEnhanced, Object.assign({}, props, {\n      studentId: student?.id,\n      student: student,\n      onLogout: onLogout\n    }, commonProps), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 34\n    }, this),\n    videoLesson: VideoLessonScreen,\n    assignmentSubmission: AssignmentSubmissionScreen,\n    assignmentFeedback: AssignmentFeedbackScreen,\n    academicReport: AcademicReportScreen,\n    chat: props => _jsxDEV(ChatScreen, Object.assign({}, props, {\n      currentUserId: student?.id\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 31\n    }, this),\n    extracurriculars: ExtracurricularsScreen,\n    notifications: props => _jsxDEV(NotificationsScreen, Object.assign({}, props, {\n      userType: \"student\",\n      navigateTo: navigateTo\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 40\n    }, this),\n    quizzes: QuizzesScreen,\n    quizPlayer: QuizPlayerScreen,\n    gamesHub: GamesHubScreen,\n    mathSprintLobby: MathSprintLobbyScreen,\n    mathSprintGame: MathSprintGameScreen,\n    mathSprintResults: MathSprintResultsScreen,\n    gamePlayer: GamePlayerScreen\n  }), [student]);\n  if (loadingStudent && !student) {\n    return _jsxDEV(\"div\", {\n      className: \"flex h-screen w-full items-center justify-center bg-gray-50\",\n      children: _jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [_jsxDEV(\"div\", {\n          className: \"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 17\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-gray-500 font-semibold\",\n          children: \"Loading your dashboard...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 446,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 16\n    }, this);\n  }\n  if (!student) {\n    return _jsxDEV(\"div\", {\n      className: \"flex flex-col items-center justify-center h-full p-6 text-center bg-gray-50\",\n      children: _jsxDEV(\"div\", {\n        className: \"bg-white p-8 rounded-2xl shadow-lg max-w-md w-full\",\n        children: [_jsxDEV(\"div\", {\n          className: \"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4\",\n          children: _jsxDEV(\"span\", {\n            className: \"text-3xl\",\n            children: \"\\uD83C\\uDF93\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 21\n        }, this), _jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-800 mb-2\",\n          children: \"Student Profile Not Found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-6\",\n          children: \"We couldn't find a student record linked to your account. Please contact the school administrator to set up your student profile.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          className: \"flex flex-col gap-3 w-full\",\n          children: _jsxDEV(\"button\", {\n            onClick: onLogout,\n            className: \"w-full py-3 px-4 bg-white text-gray-700 border border-gray-200 font-semibold rounded-xl hover:bg-gray-50 transition-colors\",\n            children: \"Back to Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          className: \"mt-4 pt-4 border-t border-gray-100\",\n          children: _jsxDEV(\"p\", {\n            className: \"text-xs text-gray-400\",\n            children: [\"User ID: \", currentUser?.id || 'N/A']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 474,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 473,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 13\n    }, this);\n  }\n  const currentNavigation = viewStack[viewStack.length - 1];\n  const ComponentToRender = viewComponents[currentNavigation.view];\n  const commonProps = {\n    navigateTo,\n    handleBack,\n    forceUpdate\n  };\n  return _jsxDEV(\"div\", {\n    className: \"flex h-screen w-full overflow-hidden bg-gray-50\",\n    children: [_jsxDEV(\"div\", {\n      className: \"hidden md:flex w-64 flex-col fixed inset-y-0 left-0 z-50\",\n      children: _jsxDEV(StudentSidebar, {\n        activeScreen: activeBottomNav,\n        setActiveScreen: handleBottomNavClick,\n        onLogout: onLogout\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 494,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col h-screen w-full md:ml-64 overflow-hidden\",\n      children: [_jsxDEV(Header, {\n        title: currentNavigation.title,\n        avatarUrl: student.avatarUrl,\n        bgColor: THEME_CONFIG[DashboardType.Student].mainBg,\n        onLogout: onLogout,\n        onBack: viewStack.length > 1 ? handleBack : undefined,\n        onNotificationClick: handleNotificationClick,\n        notificationCount: notificationCount,\n        onSearchClick: () => setIsSearchOpen(true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"flex-1 overflow-y-auto\",\n        style: {\n          marginTop: '-4rem'\n        },\n        children: _jsxDEV(\"div\", {\n          className: \"pt-16 min-h-full pb-20 md:pb-6\",\n          children: _jsxDEV(ErrorBoundary, {\n            children: _jsxDEV(\"div\", {\n              className: \"animate-slide-in-up\",\n              children: _jsxDEV(Suspense, {\n                fallback: _jsxDEV(DashboardSuspenseFallback, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 520,\n                  columnNumber: 53\n                }, this),\n                children: ComponentToRender ? _jsxDEV(ComponentToRender, Object.assign({}, currentNavigation.props, {\n                  studentId: student.id,\n                  student: student\n                }, commonProps), void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 522,\n                  columnNumber: 41\n                }, this) : _jsxDEV(\"div\", {\n                  className: \"p-6\",\n                  children: [\"View not found: \", currentNavigation.view]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 524,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 520,\n                columnNumber: 33\n              }, this)\n            }, `${viewStack.length}-${version}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 516,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"md:hidden\",\n        children: _jsxDEV(StudentBottomNav, {\n          activeScreen: activeBottomNav,\n          setActiveScreen: handleBottomNavClick\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 17\n      }, this), _jsxDEV(Suspense, {\n        fallback: _jsxDEV(DashboardSuspenseFallback, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 37\n        }, this),\n        children: isSearchOpen && _jsxDEV(GlobalSearchScreen, {\n          dashboardType: DashboardType.Student,\n          navigateTo: navigateTo,\n          onClose: () => setIsSearchOpen(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 540,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 491,\n    columnNumber: 9\n  }, this);\n};\nexport default StudentDashboard;","map":{"version":3,"names":["React","useState","useEffect","lazy","Suspense","DashboardType","THEME_CONFIG","ChartBarIcon","ChevronRightIcon","SUBJECT_COLORS","BookOpenIcon","CalendarIcon","SparklesIcon","GameControllerIcon","Header","StudentBottomNav","ErrorBoundary","StudentSidebar","GlobalSearchScreen","StudyBuddy","AdventureQuestHost","ExamSchedule","NoticeboardScreen","CalendarScreen","LibraryScreen","CurriculumScreen","TimetableScreen","AssignmentsScreen","SubjectsScreen","ClassroomScreen","AttendanceScreen","ResultsScreen","StudentFinanceScreen","AchievementsScreen","StudentMessagesScreen","StudentNewChatScreen","EditProfileScreen","StudentProfileEnhanced","VideoLessonScreen","AssignmentSubmissionScreen","AssignmentFeedbackScreen","AcademicReportScreen","ChatScreen","ExtracurricularsScreen","NotificationsScreen","QuizzesScreen","QuizPlayerScreen","GamesHubScreen","MathSprintLobbyScreen","MathSprintGameScreen","MathSprintResultsScreen","GamePlayerScreen","DashboardSuspenseFallback","_jsxDEV","className","children","fileName","_jsxFileName","lineNumber","columnNumber","supabase","TodayFocus","schedule","assignments","theme","navigateTo","formatTime","timeStr","includes","Date","toLocaleTimeString","hour","minute","substring","length","slice","map","entry","i","start_time","startTime","subject","hw","onClick","assignment","title","due_date","dueDate","toLocaleDateString","id","Overview","student","Student","todaySchedule","setTodaySchedule","upcomingAssignments","setUpcomingAssignments","loading","setLoading","fetchData","today","weekday","timetablePromise","from","select","eq","ilike","grade","order","ascending","limit","assignmentsPromise","gt","toISOString","timetableResult","assignmentsResult","Promise","all","data","err","console","error","quickAccessItems","label","icon","action","studentId","aiTools","description","color","tool","item","iconColor","cloneElement","textColor","useRealtimeNotifications","jsxDEV","StudentDashboard","onLogout","setIsHomePage","currentUser","viewStack","setViewStack","view","activeBottomNav","setActiveBottomNav","version","setVersion","isSearchOpen","setIsSearchOpen","setStudent","loadingStudent","setLoadingStudent","notificationCount","forceUpdate","v","fetchStudentAndNotifications","email","isDemoEmail","endsWith","createDemoStudent","name","user_metadata","full_name","section","avatarUrl","department","attendanceStatus","studentData","students","maybeSingle","byEmail","mappedStudent","Object","assign","avatar_url","warn","e","currentView","viewToNavMap","overview","subjects","timetable","results","quizzes","quizPlayer","gamesHub","mathSprintLobby","mathSprintGame","mathSprintResults","gamePlayer","messages","newChat","chat","profile","targetNav","props","stack","handleBack","handleBottomNavClick","screen","handleNotificationClick","viewComponents","useMemo","studyBuddy","adventureQuest","examSchedule","noticeboard","userType","calendar","birthdayHighlights","birthday","date","library","curriculum","context","userId","classroom","attendance","finances","achievements","commonProps","videoLesson","assignmentSubmission","assignmentFeedback","academicReport","currentUserId","extracurriculars","notifications","currentNavigation","ComponentToRender","activeScreen","setActiveScreen","bgColor","mainBg","onBack","undefined","onNotificationClick","onSearchClick","style","marginTop","fallback","dashboardType","onClose"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/student/StudentDashboard.tsx"],"sourcesContent":["\r\n\r\nimport React, { useState, useMemo, useEffect, lazy, Suspense } from 'react';\r\nimport { DashboardType, Student, StudentAssignment } from '../../types';\r\nimport { THEME_CONFIG, ClockIcon, ClipboardListIcon, BellIcon, ChartBarIcon, ChevronRightIcon, SUBJECT_COLORS, BookOpenIcon, MegaphoneIcon, AttendanceSummaryIcon, CalendarIcon, ElearningIcon, StudyBuddyIcon, SparklesIcon, ReceiptIcon, AwardIcon, HelpIcon, GameControllerIcon } from '../../constants';\r\nimport Header from '../ui/Header';\r\nimport { StudentBottomNav } from '../ui/DashboardBottomNav';\r\n// import { mockNotifications } from '../../data'; // REMOVED\r\nimport { } from '../../data'; // Ensure no mocks imported\r\nimport ErrorBoundary from '../ui/ErrorBoundary';\r\nimport { StudentSidebar } from '../ui/DashboardSidebar';\r\n\r\n// Lazy load all view components\r\nconst GlobalSearchScreen = lazy(() => import('../shared/GlobalSearchScreen'));\r\nconst StudyBuddy = lazy(() => import('../student/StudyBuddy'));\r\nconst AdventureQuestHost = lazy(() => import('../student/adventure/AdventureQuestHost'));\r\nconst ExamSchedule = lazy(() => import('../shared/ExamSchedule'));\r\nconst NoticeboardScreen = lazy(() => import('../shared/NoticeboardScreen'));\r\nconst CalendarScreen = lazy(() => import('../shared/CalendarScreen'));\r\nconst LibraryScreen = lazy(() => import('../shared/LibraryScreen'));\r\nconst CurriculumScreen = lazy(() => import('../shared/CurriculumScreen'));\r\nconst TimetableScreen = lazy(() => import('../shared/TimetableScreen'));\r\nconst AssignmentsScreen = lazy(() => import('../student/AssignmentsScreen'));\r\nconst SubjectsScreen = lazy(() => import('../student/SubjectsScreen'));\r\nconst ClassroomScreen = lazy(() => import('../student/ClassroomScreen'));\r\nconst AttendanceScreen = lazy(() => import('../student/AttendanceScreen'));\r\nconst ResultsScreen = lazy(() => import('../student/ResultsScreen'));\r\nconst StudentFinanceScreen = lazy(() => import('../student/StudentFinanceScreen'));\r\nconst AchievementsScreen = lazy(() => import('../student/AchievementsScreen'));\r\nconst StudentMessagesScreen = lazy(() => import('../student/StudentMessagesScreen'));\r\nconst StudentNewChatScreen = lazy(() => import('../student/NewMessageScreen'));\r\nconst EditProfileScreen = lazy(() => import('../shared/EditProfileScreen'));\r\nimport StudentProfileEnhanced from './StudentProfileEnhanced';\r\nconst VideoLessonScreen = lazy(() => import('../student/VideoLessonScreen'));\r\nconst AssignmentSubmissionScreen = lazy(() => import('../student/AssignmentSubmissionScreen'));\r\nconst AssignmentFeedbackScreen = lazy(() => import('../student/AssignmentFeedbackScreen'));\r\nconst AcademicReportScreen = lazy(() => import('../student/AcademicReportScreen'));\r\nconst ChatScreen = lazy(() => import('../shared/ChatScreen'));\r\nconst ExtracurricularsScreen = lazy(() => import('../student/ExtracurricularsScreen'));\r\nconst NotificationsScreen = lazy(() => import('../shared/NotificationsScreen'));\r\nconst QuizzesScreen = lazy(() => import('../student/QuizzesScreen'));\r\nconst QuizPlayerScreen = lazy(() => import('../student/QuizPlayerScreen'));\r\nconst GamesHubScreen = lazy(() => import('../student/games/GamesHubScreen'));\r\nconst MathSprintLobbyScreen = lazy(() => import('../student/games/MathSprintLobbyScreen'));\r\nconst MathSprintGameScreen = lazy(() => import('../student/games/MathSprintGameScreen'));\r\nconst MathSprintResultsScreen = lazy(() => import('../student/games/MathSprintResultsScreen'));\r\nconst GamePlayerScreen = lazy(() => import('../shared/GamePlayerScreen'));\r\n\r\nconst DashboardSuspenseFallback = () => (\r\n    <div className=\"flex justify-center items-center h-full p-8\">\r\n        <div className=\"w-10 h-10 border-4 border-t-4 border-gray-200 border-t-orange-600 rounded-full animate-spin\"></div>\r\n    </div>\r\n);\r\n\r\ninterface ViewStackItem {\r\n    view: string;\r\n    props?: any;\r\n    title: string;\r\n}\r\n\r\nimport { supabase } from '../../lib/supabase';\r\n\r\n// ... (other imports remain)\r\n\r\n// Remove global loggedInStudent\r\n\r\nconst TodayFocus: React.FC<{ schedule: any[], assignments: any[], theme: any, navigateTo: (view: string, title: string, props?: any) => void }> = ({ schedule, assignments, theme, navigateTo }) => {\r\n    const formatTime = (timeStr: string) => {\r\n        if (!timeStr) return '';\r\n        // If it's full date string or just time\r\n        return timeStr.includes('T') ? new Date(timeStr).toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' }) : timeStr.substring(0, 5);\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-4 rounded-2xl shadow-sm\">\r\n            <h3 className=\"font-bold text-lg text-gray-800 mb-3\">Today's Focus</h3>\r\n            <div className=\"space-y-3\">\r\n                {schedule.length > 0 ? (\r\n                    <div className=\"space-y-2\">\r\n                        <h4 className=\"text-sm font-semibold text-gray-500\">Next Up</h4>\r\n                        {schedule.slice(0, 2).map((entry, i) => (\r\n                            <div key={i} className=\"flex items-center space-x-3\">\r\n                                <div className=\"w-16 text-right\">\r\n                                    <p className=\"font-semibold text-sm text-gray-700\">{entry.start_time || entry.startTime}</p>\r\n                                </div>\r\n                                <div className={`w-1 h-10 rounded-full ${SUBJECT_COLORS[entry.subject] || 'bg-gray-400'}`}></div>\r\n                                <p className=\"font-semibold text-gray-800\">{entry.subject}</p>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <p className=\"text-sm text-center text-gray-500 py-2\">No more classes today!</p>\r\n                )}\r\n\r\n                <div className=\"border-t border-gray-100 my-2\"></div>\r\n\r\n                {assignments.length > 0 ? (\r\n                    <div className=\"space-y-2\">\r\n                        <h4 className=\"text-sm font-semibold text-gray-500\">Assignments Due Soon</h4>\r\n                        {assignments.map(hw => (\r\n                            <button\r\n                                key={hw.id}\r\n                                onClick={() => navigateTo('assignmentSubmission', 'Submit Assignment', { assignment: hw })}\r\n                                className=\"w-full flex justify-between items-center p-2 rounded-lg hover:bg-gray-50 transition-colors text-left\"\r\n                            >\r\n                                <div>\r\n                                    <p className=\"font-bold text-gray-800 text-sm\">{hw.title}</p>\r\n                                    <p className=\"text-xs text-gray-500\">{hw.subject} &bull; Due {new Date(hw.due_date || hw.dueDate).toLocaleDateString('en-GB')}</p>\r\n                                </div>\r\n                                <ChevronRightIcon className=\"text-gray-400 h-5 w-5\" />\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <p className=\"text-sm text-center text-gray-500 py-2\">No assignments due soon. Great work!</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst Overview: React.FC<{ navigateTo: (view: string, title: string, props?: any) => void; student: Student }> = ({ navigateTo, student }) => {\r\n    const theme = THEME_CONFIG[DashboardType.Student];\r\n    const [todaySchedule, setTodaySchedule] = useState<any[]>([]);\r\n    const [upcomingAssignments, setUpcomingAssignments] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                const today = new Date().toLocaleDateString('en-US', { weekday: 'long' });\r\n\r\n                const timetablePromise = supabase\r\n                    .from('timetable')\r\n                    .select('*')\r\n                    .eq('day', today)\r\n                    .ilike('class_name', `%${student.grade}%`)\r\n                    .order('start_time', { ascending: true })\r\n                    .limit(3);\r\n\r\n                const assignmentsPromise = supabase\r\n                    .from('assignments')\r\n                    .select('*')\r\n                    .gt('due_date', new Date().toISOString())\r\n                    .order('due_date', { ascending: true })\r\n                    .limit(2);\r\n\r\n                const [timetableResult, assignmentsResult] = await Promise.all([timetablePromise, assignmentsPromise]);\r\n\r\n                if (timetableResult.data) setTodaySchedule(timetableResult.data);\r\n                if (assignmentsResult.data) setUpcomingAssignments(assignmentsResult.data);\r\n\r\n            } catch (err) {\r\n                console.error('Error fetching overview data:', err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        if (student) fetchData();\r\n    }, [student]);\r\n\r\n    const quickAccessItems = [\r\n        { label: 'Subjects', icon: <BookOpenIcon />, action: () => navigateTo('subjects', 'My Subjects') },\r\n        { label: 'Timetable', icon: <CalendarIcon />, action: () => navigateTo('timetable', 'Timetable') },\r\n        { label: 'Results', icon: <ChartBarIcon />, action: () => navigateTo('results', 'Academic Performance', { studentId: student.id }) },\r\n        { label: 'Games', icon: <GameControllerIcon />, action: () => navigateTo('gamesHub', 'Games Hub') },\r\n    ];\r\n\r\n    const aiTools = [\r\n        { label: 'AI Study Buddy', description: 'Stuck on a problem?', color: 'from-purple-500 to-indigo-600', action: () => navigateTo('studyBuddy', 'Study Buddy') },\r\n        { label: 'AI Adventure Quest', description: 'Turn any text into a fun quiz!', color: 'from-teal-400 to-blue-500', action: () => navigateTo('adventureQuest', 'AI Adventure Quest', {}) },\r\n    ];\r\n\r\n    if (loading) return <div className=\"p-8 text-center text-gray-500\">Loading overview...</div>;\r\n\r\n    return (\r\n        <div className=\"p-4 lg:p-6 bg-gray-50 min-h-full\">\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n                {/* Main content */}\r\n                <div className=\"lg:col-span-2 space-y-6\">\r\n                    <TodayFocus schedule={todaySchedule} assignments={upcomingAssignments} theme={theme} navigateTo={navigateTo} />\r\n                    <div>\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-2 px-1\">AI Tools</h3>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            {aiTools.map(tool => (\r\n                                <button key={tool.label} onClick={tool.action} className={`p-4 rounded-2xl shadow-lg text-white bg-gradient-to-r ${tool.color}`}>\r\n                                    <SparklesIcon className=\"h-6 w-6 mb-2\" />\r\n                                    <h4 className=\"font-bold text-left\">{tool.label}</h4>\r\n                                    <p className=\"text-xs opacity-90 text-left\">{tool.description}</p>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                {/* Sidebar */}\r\n                <div className=\"lg:col-span-1 space-y-6\">\r\n                    <div>\r\n                        <h3 className=\"text-lg font-bold text-gray-800 mb-2 px-1\">Quick Actions</h3>\r\n                        <div className=\"grid grid-cols-2 gap-3 text-center\">\r\n                            {quickAccessItems.map(item => (\r\n                                <button key={item.label} onClick={item.action} className=\"bg-white p-3 rounded-2xl shadow-sm flex flex-col items-center justify-center space-y-2 hover:bg-orange-100 transition-colors\">\r\n                                    <div className={theme.iconColor}>{React.cloneElement(item.icon, { className: 'h-7 w-7' })}</div>\r\n                                    <span className={`font-semibold ${theme.textColor} text-center text-xs`}>{item.label}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\ninterface StudentDashboardProps {\r\n    onLogout: () => void;\r\n    setIsHomePage: (isHome: boolean) => void;\r\n    currentUser: any;\r\n}\r\n\r\nimport { useRealtimeNotifications } from '../../hooks/useRealtimeNotifications';\r\n\r\n// ... (top level)\r\n\r\nconst StudentDashboard: React.FC<StudentDashboardProps> = ({ onLogout, setIsHomePage, currentUser }) => {\r\n\r\n    // ... inside component ...\r\n\r\n    const [viewStack, setViewStack] = useState<ViewStackItem[]>([{ view: 'overview', title: 'Student Dashboard' }]);\r\n    const [activeBottomNav, setActiveBottomNav] = useState('home');\r\n    const [version, setVersion] = useState(0);\r\n    const [isSearchOpen, setIsSearchOpen] = useState(false);\r\n\r\n    // State for student data\r\n    const [student, setStudent] = useState<Student | null>(null);\r\n    const [loadingStudent, setLoadingStudent] = useState(true);\r\n\r\n    // Real-time notifications\r\n    const notificationCount = useRealtimeNotifications('student');\r\n\r\n    const forceUpdate = () => setVersion(v => v + 1);\r\n\r\n    useEffect(() => {\r\n        const fetchStudentAndNotifications = async () => {\r\n            try {\r\n                if (!currentUser?.email) {\r\n                    setLoadingStudent(false);\r\n                    return;\r\n                }\r\n\r\n                const isDemoEmail = currentUser.email?.endsWith('@school.com') ||\r\n                    currentUser.email?.includes('student') ||\r\n                    currentUser.email?.includes('demo');\r\n\r\n                const createDemoStudent = (): Student => ({\r\n                    id: 1,\r\n                    name: currentUser.user_metadata?.full_name || 'Demo Student',\r\n                    grade: 10,\r\n                    section: 'A',\r\n                    avatarUrl: 'https://i.pravatar.cc/150?img=1',\r\n                    email: currentUser.email,\r\n                    department: 'Science',\r\n                    attendanceStatus: 'Present',\r\n                } as Student);\r\n\r\n                // 1. Try to fetch Student Data by user_id\r\n                let studentData = null;\r\n                const { data: students } = await supabase\r\n                    .from('students')\r\n                    .select('*')\r\n                    .eq('user_id', currentUser.id)\r\n                    .maybeSingle();\r\n\r\n                studentData = students;\r\n\r\n                // Fallback lookup by email\r\n                if (!studentData && currentUser.email) {\r\n                    const { data: byEmail } = await supabase\r\n                        .from('students')\r\n                        .select('*')\r\n                        .eq('email', currentUser.email)\r\n                        .maybeSingle();\r\n                    if (byEmail) studentData = byEmail;\r\n                }\r\n\r\n                if (studentData) {\r\n                    const mappedStudent: Student = {\r\n                        ...studentData,\r\n                        id: studentData.id,\r\n                        name: studentData.name,\r\n                        grade: studentData.grade,\r\n                        section: studentData.section,\r\n                        avatarUrl: studentData.avatar_url,\r\n                    } as any;\r\n\r\n                    // Update state immediately when student is found\r\n                    setStudent(mappedStudent);\r\n                } else if (isDemoEmail) {\r\n                    // Use demo student fallback for quick logins\r\n                    setStudent(createDemoStudent());\r\n                } else {\r\n                    console.warn('No linked student profile found.');\r\n                }\r\n\r\n            } catch (e) {\r\n                console.error('Error loading dashboard:', e);\r\n                // Final fallback\r\n                const isDemoEmail = currentUser?.email?.endsWith('@school.com') ||\r\n                    currentUser?.email?.includes('student') ||\r\n                    currentUser?.email?.includes('demo');\r\n\r\n                if (isDemoEmail) {\r\n                    setStudent({\r\n                        id: 1,\r\n                        name: 'Demo Student',\r\n                        grade: 10,\r\n                        section: 'A',\r\n                        avatarUrl: 'https://i.pravatar.cc/150?img=1',\r\n                        email: currentUser?.email || '',\r\n                        department: 'Science',\r\n                        attendanceStatus: 'Present',\r\n                    } as Student);\r\n                }\r\n            } finally {\r\n                setLoadingStudent(false);\r\n            }\r\n        };\r\n        fetchStudentAndNotifications();\r\n    }, [currentUser]);\r\n\r\n    useEffect(() => {\r\n        const currentView = viewStack[viewStack.length - 1];\r\n        setIsHomePage(currentView.view === 'overview' && !isSearchOpen);\r\n\r\n        // Sync bottom nav state\r\n        const viewToNavMap: Record<string, string> = {\r\n            overview: 'home',\r\n            subjects: 'home',\r\n            timetable: 'home',\r\n            results: 'results',\r\n            quizzes: 'quizzes',\r\n            quizPlayer: 'quizzes',\r\n            gamesHub: 'games',\r\n            mathSprintLobby: 'games',\r\n            mathSprintGame: 'games',\r\n            mathSprintResults: 'games',\r\n            gamePlayer: 'games',\r\n            messages: 'messages',\r\n            newChat: 'messages',\r\n            chat: 'messages',\r\n            profile: 'profile',\r\n        };\r\n\r\n        const targetNav = viewToNavMap[currentView.view];\r\n        if (targetNav) {\r\n            setActiveBottomNav(targetNav);\r\n        }\r\n    }, [viewStack, isSearchOpen, setIsHomePage]);\r\n\r\n    const navigateTo = (view: string, title: string, props: any = {}) => {\r\n        setViewStack(stack => [...stack, { view, props, title }]);\r\n    };\r\n\r\n    const handleBack = () => {\r\n        if (viewStack.length > 1) {\r\n            setViewStack(stack => stack.slice(0, -1));\r\n        }\r\n    };\r\n\r\n    const handleBottomNavClick = (screen: string) => {\r\n        if (!student) return;\r\n        setActiveBottomNav(screen);\r\n        switch (screen) {\r\n            case 'home':\r\n                setViewStack([{ view: 'overview', title: 'Student Dashboard' }]);\r\n                break;\r\n            case 'quizzes':\r\n                setViewStack([{ view: 'quizzes', title: 'Assessments & Quizzes' }]);\r\n                break;\r\n            case 'results':\r\n                setViewStack([{ view: 'results', title: 'Academic Performance', props: { studentId: student.id } }]);\r\n                break;\r\n            case 'games':\r\n                setViewStack([{ view: 'gamesHub', title: 'Games Hub' }]);\r\n                break;\r\n            case 'messages':\r\n                setViewStack([{ view: 'messages', title: 'Messages' }]);\r\n                break;\r\n            case 'profile':\r\n                setViewStack([{ view: 'profile', title: 'My Profile', props: {} }]);\r\n                break;\r\n            default:\r\n                setViewStack([{ view: 'overview', title: 'Student Dashboard' }]);\r\n        }\r\n    };\r\n\r\n    const handleNotificationClick = () => {\r\n        navigateTo('notifications', 'Notifications', {});\r\n    };\r\n\r\n    const viewComponents = React.useMemo(() => ({\r\n        overview: Overview,\r\n        studyBuddy: StudyBuddy,\r\n        adventureQuest: AdventureQuestHost,\r\n        examSchedule: ExamSchedule,\r\n        noticeboard: (props: any) => <NoticeboardScreen {...props} userType=\"student\" />,\r\n        calendar: (props: any) => <CalendarScreen {...props} birthdayHighlights={student?.birthday ? [{ date: student.birthday, label: 'Your Birthday' }] : []} />,\r\n        library: LibraryScreen,\r\n        curriculum: CurriculumScreen,\r\n        timetable: (props: any) => <TimetableScreen {...props} context={{ userType: 'student', userId: student?.id }} />,\r\n        assignments: AssignmentsScreen,\r\n        subjects: SubjectsScreen,\r\n        classroom: ClassroomScreen,\r\n        attendance: AttendanceScreen,\r\n        results: ResultsScreen,\r\n        finances: StudentFinanceScreen,\r\n        achievements: AchievementsScreen,\r\n        messages: StudentMessagesScreen,\r\n        newChat: StudentNewChatScreen,\r\n        profile: (props: any) => <StudentProfileEnhanced\r\n            {...props}\r\n            studentId={student?.id}\r\n            student={student} // Will be passed by commonProps but explicit here is fine\r\n            onLogout={onLogout}\r\n            {...commonProps}\r\n        />,\r\n        videoLesson: VideoLessonScreen,\r\n        assignmentSubmission: AssignmentSubmissionScreen,\r\n        assignmentFeedback: AssignmentFeedbackScreen,\r\n        academicReport: AcademicReportScreen,\r\n        chat: (props: any) => <ChatScreen {...props} currentUserId={student?.id} />,\r\n        extracurriculars: ExtracurricularsScreen,\r\n        notifications: (props: any) => <NotificationsScreen {...props} userType=\"student\" navigateTo={navigateTo} />,\r\n        quizzes: QuizzesScreen,\r\n        quizPlayer: QuizPlayerScreen,\r\n        gamesHub: GamesHubScreen,\r\n        mathSprintLobby: MathSprintLobbyScreen,\r\n        mathSprintGame: MathSprintGameScreen,\r\n        mathSprintResults: MathSprintResultsScreen,\r\n        gamePlayer: GamePlayerScreen,\r\n    }), [student]);\r\n\r\n    // Optimistic UI: Only show full loading spinner if we are loading AND have no student data\r\n    if (loadingStudent && !student) {\r\n        return <div className=\"flex h-screen w-full items-center justify-center bg-gray-50\">\r\n            <div className=\"text-center\">\r\n                <div className=\"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\r\n                <p className=\"text-gray-500 font-semibold\">Loading your dashboard...</p>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    if (!student) {\r\n        return (\r\n            <div className=\"flex flex-col items-center justify-center h-full p-6 text-center bg-gray-50\">\r\n                <div className=\"bg-white p-8 rounded-2xl shadow-lg max-w-md w-full\">\r\n                    <div className=\"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                        <span className=\"text-3xl\"></span>\r\n                    </div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Student Profile Not Found</h2>\r\n                    <p className=\"text-gray-600 mb-6\">\r\n                        We couldn't find a student record linked to your account.\r\n                        Please contact the school administrator to set up your student profile.\r\n                    </p>\r\n                    <div className=\"flex flex-col gap-3 w-full\">\r\n                        <button\r\n                            onClick={onLogout}\r\n                            className=\"w-full py-3 px-4 bg-white text-gray-700 border border-gray-200 font-semibold rounded-xl hover:bg-gray-50 transition-colors\"\r\n                        >\r\n                            Back to Login\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"mt-4 pt-4 border-t border-gray-100\">\r\n                        <p className=\"text-xs text-gray-400\">User ID: {currentUser?.id || 'N/A'}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const currentNavigation = viewStack[viewStack.length - 1];\r\n    const ComponentToRender = viewComponents[currentNavigation.view as keyof typeof viewComponents];\r\n    const commonProps = {\r\n        navigateTo,\r\n        handleBack,\r\n        forceUpdate,\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"flex h-screen w-full overflow-hidden bg-gray-50\">\r\n            {/* Desktop Sidebar - Hidden on mobile, fixed on desktop */}\r\n            <div className=\"hidden md:flex w-64 flex-col fixed inset-y-0 left-0 z-50\">\r\n                <StudentSidebar\r\n                    activeScreen={activeBottomNav} // Using existing state for active screen\r\n                    setActiveScreen={handleBottomNavClick} // Reuse existing handler\r\n                    onLogout={onLogout}\r\n                />\r\n            </div>\r\n\r\n            {/* Main Content Area */}\r\n            <div className=\"flex-1 flex flex-col h-screen w-full md:ml-64 overflow-hidden\">\r\n                <Header\r\n                    title={currentNavigation.title}\r\n                    avatarUrl={student.avatarUrl}\r\n                    bgColor={THEME_CONFIG[DashboardType.Student].mainBg}\r\n                    onLogout={onLogout}\r\n                    onBack={viewStack.length > 1 ? handleBack : undefined}\r\n                    onNotificationClick={handleNotificationClick}\r\n                    notificationCount={notificationCount}\r\n                    onSearchClick={() => setIsSearchOpen(true)}\r\n                />\r\n\r\n                {/* Scrollable Content */}\r\n                <div className=\"flex-1 overflow-y-auto\" style={{ marginTop: '-4rem' }}>\r\n                    <div className=\"pt-16 min-h-full pb-20 md:pb-6\">\r\n                        {/* pb-20 only on mobile to clear bottom nav, md:pb-6 for desktop spacing */}\r\n                        <ErrorBoundary>\r\n                            <div key={`${viewStack.length}-${version}`} className=\"animate-slide-in-up\">\r\n                                <Suspense fallback={<DashboardSuspenseFallback />}>\r\n                                    {ComponentToRender ? (\r\n                                        <ComponentToRender {...currentNavigation.props} studentId={student.id} student={student} {...commonProps} />\r\n                                    ) : (\r\n                                        <div className=\"p-6\">View not found: {currentNavigation.view}</div>\r\n                                    )}\r\n                                </Suspense>\r\n                            </div>\r\n                        </ErrorBoundary>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Mobile Bottom Nav - Hidden on desktop */}\r\n                <div className=\"md:hidden\">\r\n                    <StudentBottomNav activeScreen={activeBottomNav} setActiveScreen={handleBottomNavClick} />\r\n                </div>\r\n\r\n                {/* Search Overlay */}\r\n                <Suspense fallback={<DashboardSuspenseFallback />}>\r\n                    {isSearchOpen && (\r\n                        <GlobalSearchScreen\r\n                            dashboardType={DashboardType.Student}\r\n                            navigateTo={navigateTo}\r\n                            onClose={() => setIsSearchOpen(false)}\r\n                        />\r\n                    )}\r\n                </Suspense>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n};\r\n\r\nexport default StudentDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}