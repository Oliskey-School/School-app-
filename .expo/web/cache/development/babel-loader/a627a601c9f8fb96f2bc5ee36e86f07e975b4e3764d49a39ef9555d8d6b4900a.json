{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\parent\\\\FeeStatusScreen.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport { fetchStudentFees } from '../../lib/payments';\nimport { FeeCard } from '../payments/FeeCard';\nimport { PaystackButton } from '../payments/PaystackWrapper';\nimport { FlutterwaveWrapper } from '../payments/FlutterwaveWrapper';\nimport { MobileMoneyWrapper } from '../payments/MobileMoneyWrapper';\nimport { InstallmentSchedule } from './InstallmentSchedule';\nimport { hasPaymentPlan } from '../../lib/payment-plans';\nimport { generateReceipt } from '../../lib/receipt-generator';\nimport { toast } from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FeeStatusScreen = ({\n  parentId,\n  navigateTo\n}) => {\n  const [students, setStudents] = useState([]);\n  const [selectedStudent, setSelectedStudent] = useState(null);\n  const [fees, setFees] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [paymentFee, setPaymentFee] = useState(null);\n  const [userEmail, setUserEmail] = useState('');\n  const [paymentGateway, setPaymentGateway] = useState('paystack');\n  const [parentName, setParentName] = useState('');\n  const [parentPhone, setParentPhone] = useState('');\n  const [feesWithPlans, setFeesWithPlans] = useState(new Set());\n  useEffect(() => {\n    const init = async () => {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      const authEmail = user?.email || '';\n      setUserEmail(authEmail);\n      if (parentId) {\n        const {\n          data: parentProfile,\n          error\n        } = await supabase.from('parents').select('name, email, phone').eq('id', parentId).single();\n        if (parentProfile) {\n          setParentName(parentProfile.name || 'Parent');\n          setParentPhone(parentProfile.phone || '0000000000');\n          if (parentProfile.email && !authEmail) {\n            setUserEmail(parentProfile.email);\n          }\n        }\n        const {\n          data: relations\n        } = await supabase.from('parent_children').select('student_id, students:student_id(id, name, grade, section, avatar_url)').eq('parent_id', parentId);\n        if (relations && relations.length > 0) {\n          const kids = relations.map(r => r.students);\n          setStudents(kids);\n          setSelectedStudent(kids[0]);\n        } else {\n          toast('No children found for this parent.');\n        }\n      } else {\n        toast.error('Parent ID not found. Please log in again.');\n      }\n      setLoading(false);\n    };\n    init();\n  }, [parentId]);\n  useEffect(() => {\n    if (selectedStudent) {\n      loadFees(selectedStudent.id);\n      const channel = supabase.channel(`fees_${selectedStudent.id}`).on('postgres_changes', {\n        event: '*',\n        schema: 'public',\n        table: 'student_fees',\n        filter: `student_id=eq.${selectedStudent.id}`\n      }, () => {\n        loadFees(selectedStudent.id);\n      }).subscribe();\n      return () => {\n        supabase.removeChannel(channel);\n      };\n    }\n  }, [selectedStudent]);\n  const loadFees = async studentId => {\n    setLoading(true);\n    const data = await fetchStudentFees(studentId);\n    setFees(data);\n    const plansSet = new Set();\n    await Promise.all(data.map(async fee => {\n      const hasPlan = await hasPaymentPlan(fee.id);\n      if (hasPlan) plansSet.add(fee.id);\n    }));\n    setFeesWithPlans(plansSet);\n    setLoading(false);\n  };\n  const handleDownloadReceipt = async fee => {\n    try {\n      const {\n        data: transactions,\n        error\n      } = await supabase.from('transactions').select('*').eq('fee_id', fee.id).eq('status', 'Success').order('created_at', {\n        ascending: false\n      }).limit(1);\n      if (error || !transactions || transactions.length === 0) {\n        toast.error('No completed transaction found for this fee.');\n        return;\n      }\n      const transaction = transactions[0];\n      const formattedTransaction = {\n        id: transaction.id,\n        feeId: transaction.fee_id,\n        studentId: transaction.student_id,\n        payerId: transaction.payer_id,\n        amount: transaction.amount,\n        reference: transaction.reference,\n        provider: transaction.provider,\n        status: transaction.status,\n        date: transaction.created_at\n      };\n      await generateReceipt(formattedTransaction, fee, selectedStudent?.name || 'Student', 'School Management System');\n    } catch (err) {\n      console.error('Error downloading receipt:', err);\n      toast.error('Error generating receipt. Please try again.');\n    }\n  };\n  const handlePayClick = fee => {\n    setPaymentFee(fee);\n    const btnId = paymentGateway === 'paystack' ? `paystack-btn-${fee.id}` : paymentGateway === 'flutterwave' ? `flutterwave-btn-${fee.id}` : `mobilemoney-btn-${fee.id}`;\n    const btn = document.getElementById(btnId);\n    if (btn) btn.click();\n  };\n  if (loading && !selectedStudent) {\n    return _jsxDEV(\"div\", {\n      className: \"flex items-center justify-center min-h-[400px]\",\n      children: _jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [_jsxDEV(\"div\", {\n          className: \"w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Loading fee information...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }, this);\n  }\n  if (!selectedStudent && students.length === 0) {\n    return _jsxDEV(\"div\", {\n      className: \"p-8 text-center bg-white rounded-2xl shadow-sm\",\n      children: _jsxDEV(\"p\", {\n        className: \"text-gray-500\",\n        children: \"No student data available.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 13\n    }, this);\n  }\n  const totalDue = fees.reduce((sum, fee) => sum + (fee.amount - (fee.paidAmount || 0)), 0);\n  const totalPaid = fees.reduce((sum, fee) => sum + (fee.paidAmount || 0), 0);\n  return _jsxDEV(\"div\", {\n    className: \"p-4 md:p-6 max-w-6xl mx-auto space-y-6\",\n    children: [students.length > 1 && _jsxDEV(\"div\", {\n      className: \"flex space-x-3 overflow-x-auto pb-2 scrollbar-hide\",\n      children: students.map(s => _jsxDEV(\"button\", {\n        onClick: () => setSelectedStudent(s),\n        className: `flex items-center space-x-2 px-4 py-2.5 rounded-xl border-2 transition-all flex-shrink-0\n                        ${selectedStudent?.id === s.id ? 'bg-indigo-600 text-white border-indigo-600 shadow-md' : 'bg-white text-gray-700 border-gray-200 hover:border-indigo-300 hover:bg-indigo-50'}`,\n        children: [_jsxDEV(\"img\", {\n          src: s.avatar_url || 'https://via.placeholder.com/32',\n          className: \"w-7 h-7 rounded-full ring-2 ring-white\",\n          alt: s.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 29\n        }, this), _jsxDEV(\"div\", {\n          className: \"text-left\",\n          children: [_jsxDEV(\"span\", {\n            className: \"font-semibold text-sm block\",\n            children: s.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 33\n          }, this), _jsxDEV(\"span\", {\n            className: \"text-xs opacity-80\",\n            children: [s.grade, \" \", s.section]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 29\n        }, this)]\n      }, s.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 17\n    }, this), _jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 sm:grid-cols-3 gap-4\",\n      children: [_jsxDEV(\"div\", {\n        className: \"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl shadow-lg p-5 text-white\",\n        children: [_jsxDEV(\"p\", {\n          className: \"text-sm opacity-90 mb-1\",\n          children: \"Total Fees\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-2xl font-bold\",\n          children: new Intl.NumberFormat('en-NG', {\n            style: 'currency',\n            currency: 'NGN',\n            minimumFractionDigits: 0\n          }).format(fees.reduce((sum, fee) => sum + fee.amount, 0))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-xs opacity-75 mt-1\",\n          children: [fees.length, \" fee(s)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl shadow-lg p-5 text-white\",\n        children: [_jsxDEV(\"p\", {\n          className: \"text-sm opacity-90 mb-1\",\n          children: \"Total Paid\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-2xl font-bold\",\n          children: new Intl.NumberFormat('en-NG', {\n            style: 'currency',\n            currency: 'NGN',\n            minimumFractionDigits: 0\n          }).format(totalPaid)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-xs opacity-75 mt-1\",\n          children: \"Completed payments\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"bg-gradient-to-br from-red-500 to-red-600 rounded-2xl shadow-lg p-5 text-white\",\n        children: [_jsxDEV(\"p\", {\n          className: \"text-sm opacity-90 mb-1\",\n          children: \"Outstanding\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-2xl font-bold\",\n          children: new Intl.NumberFormat('en-NG', {\n            style: 'currency',\n            currency: 'NGN',\n            minimumFractionDigits: 0\n          }).format(totalDue)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-xs opacity-75 mt-1\",\n          children: \"Pending payment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      className: \"bg-white rounded-2xl shadow-sm p-5 border border-gray-100\",\n      children: [_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-4\",\n        children: [_jsxDEV(\"h3\", {\n          className: \"text-base font-semibold text-gray-800\",\n          children: \"Payment Method\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }, this), _jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full\",\n          children: \"Select one\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 sm:grid-cols-3 gap-3\",\n        children: [_jsxDEV(\"button\", {\n          onClick: () => setPaymentGateway('paystack'),\n          className: `flex flex-col items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${paymentGateway === 'paystack' ? 'border-indigo-600 bg-indigo-50 shadow-md scale-105' : 'border-gray-200 bg-white hover:border-indigo-300 hover:shadow-sm'}`,\n          children: [_jsxDEV(\"div\", {\n            className: `w-12 h-12 rounded-full flex items-center justify-center ${paymentGateway === 'paystack' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600'}`,\n            children: _jsxDEV(\"svg\", {\n              className: \"w-6 h-6\",\n              viewBox: \"0 0 24 24\",\n              fill: \"currentColor\",\n              children: _jsxDEV(\"path\", {\n                d: \"M3 10h11v2H3v-2zm0-4h11v2H3V6zm0 8h7v2H3v-2zm13.01-2.5l2.5 1.5v2l-2.5-1.5v-2zm2.5-1.5v2l-2.5-1.5v-2l2.5 1.5zm-5 3v-2l2.5-1.5v2l-2.5 1.5z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 25\n          }, this), _jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [_jsxDEV(\"span\", {\n              className: `font-semibold text-sm block ${paymentGateway === 'paystack' ? 'text-indigo-700' : 'text-gray-700'}`,\n              children: \"Paystack\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 29\n            }, this), _jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500\",\n              children: \"Cards, Bank, USSD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 21\n        }, this), _jsxDEV(\"button\", {\n          onClick: () => setPaymentGateway('flutterwave'),\n          className: `flex flex-col items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${paymentGateway === 'flutterwave' ? 'border-orange-500 bg-orange-50 shadow-md scale-105' : 'border-gray-200 bg-white hover:border-orange-300 hover:shadow-sm'}`,\n          children: [_jsxDEV(\"div\", {\n            className: `w-12 h-12 rounded-full flex items-center justify-center ${paymentGateway === 'flutterwave' ? 'bg-orange-500 text-white' : 'bg-gray-100 text-gray-600'}`,\n            children: _jsxDEV(\"svg\", {\n              className: \"w-6 h-6\",\n              viewBox: \"0 0 24 24\",\n              fill: \"currentColor\",\n              children: _jsxDEV(\"path\", {\n                d: \"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 25\n          }, this), _jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [_jsxDEV(\"span\", {\n              className: `font-semibold text-sm block ${paymentGateway === 'flutterwave' ? 'text-orange-700' : 'text-gray-700'}`,\n              children: \"Flutterwave\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 29\n            }, this), _jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500\",\n              children: \"Cards, Mobile Money\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 21\n        }, this), _jsxDEV(\"button\", {\n          onClick: () => setPaymentGateway('mobilemoney'),\n          className: `flex flex-col items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${paymentGateway === 'mobilemoney' ? 'border-green-600 bg-green-50 shadow-md scale-105' : 'border-gray-200 bg-white hover:border-green-300 hover:shadow-sm'}`,\n          children: [_jsxDEV(\"div\", {\n            className: `w-12 h-12 rounded-full flex items-center justify-center ${paymentGateway === 'mobilemoney' ? 'bg-green-600 text-white' : 'bg-gray-100 text-gray-600'}`,\n            children: _jsxDEV(\"svg\", {\n              className: \"w-6 h-6\",\n              viewBox: \"0 0 24 24\",\n              fill: \"currentColor\",\n              children: _jsxDEV(\"path\", {\n                d: \"M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 25\n          }, this), _jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [_jsxDEV(\"span\", {\n              className: `font-semibold text-sm block ${paymentGateway === 'mobilemoney' ? 'text-green-700' : 'text-gray-700'}`,\n              children: \"Mobile Money\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 29\n            }, this), _jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500\",\n              children: \"M-Pesa, MTN, Airtel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      children: [_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold text-gray-800 mb-4\",\n        children: [\"Fees for \", selectedStudent?.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 17\n      }, this), fees.length === 0 ? _jsxDEV(\"div\", {\n        className: \"text-center py-12 bg-white rounded-2xl shadow-sm\",\n        children: _jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: \"No fees assigned currently. You're all good! \\uD83C\\uDF89\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 21\n      }, this) : _jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",\n        children: fees.map(fee => _jsxDEV(\"div\", {\n          className: \"relative\",\n          children: feesWithPlans.has(fee.id) ? _jsxDEV(\"div\", {\n            className: \"bg-white rounded-2xl shadow-sm border border-gray-200 p-4\",\n            children: [_jsxDEV(\"h3\", {\n              className: \"font-semibold text-gray-900 mb-3\",\n              children: fee.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 41\n            }, this), _jsxDEV(InstallmentSchedule, {\n              feeId: fee.id,\n              onPayInstallment: installment => {\n                handlePayClick(fee);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 37\n          }, this) : _jsxDEV(_Fragment, {\n            children: [_jsxDEV(FeeCard, {\n              fee: fee,\n              onPay: handlePayClick,\n              onDownloadReceipt: handleDownloadReceipt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 41\n            }, this), _jsxDEV(PaystackButton, {\n              fee: fee,\n              email: userEmail,\n              onSuccess: () => {\n                toast.success('Payment Successful!');\n                loadFees(selectedStudent.id);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 41\n            }, this), _jsxDEV(FlutterwaveWrapper, {\n              fee: fee,\n              email: userEmail,\n              phone: parentPhone,\n              name: parentName,\n              onSuccess: () => {\n                toast.success('Payment Successful!');\n                loadFees(selectedStudent.id);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 41\n            }, this), _jsxDEV(MobileMoneyWrapper, {\n              fee: fee,\n              email: userEmail,\n              name: parentName,\n              onSuccess: () => {\n                toast.success('Payment Successful!');\n                loadFees(selectedStudent.id);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true)\n        }, fee.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 9\n  }, this);\n};\nexport default FeeStatusScreen;","map":{"version":3,"names":["React","useState","useEffect","supabase","fetchStudentFees","FeeCard","PaystackButton","FlutterwaveWrapper","MobileMoneyWrapper","InstallmentSchedule","hasPaymentPlan","generateReceipt","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","FeeStatusScreen","parentId","navigateTo","students","setStudents","selectedStudent","setSelectedStudent","fees","setFees","loading","setLoading","paymentFee","setPaymentFee","userEmail","setUserEmail","paymentGateway","setPaymentGateway","parentName","setParentName","parentPhone","setParentPhone","feesWithPlans","setFeesWithPlans","Set","init","data","user","auth","getUser","authEmail","email","parentProfile","error","from","select","eq","single","name","phone","relations","length","kids","map","r","loadFees","id","channel","on","event","schema","table","filter","subscribe","removeChannel","studentId","plansSet","Promise","all","fee","hasPlan","add","handleDownloadReceipt","transactions","order","ascending","limit","transaction","formattedTransaction","feeId","fee_id","student_id","payerId","payer_id","amount","reference","provider","status","date","created_at","err","console","handlePayClick","btnId","btn","document","getElementById","click","className","children","fileName","_jsxFileName","lineNumber","columnNumber","totalDue","reduce","sum","paidAmount","totalPaid","s","onClick","src","avatar_url","alt","grade","section","Intl","NumberFormat","style","currency","minimumFractionDigits","format","viewBox","fill","d","has","title","onPayInstallment","installment","onPay","onDownloadReceipt","onSuccess","success"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/parent/FeeStatusScreen.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { Fee } from '../../types';\r\nimport { fetchStudentFees } from '../../lib/payments';\r\nimport { FeeCard } from '../payments/FeeCard';\r\nimport { PaystackButton } from '../payments/PaystackWrapper';\r\nimport { FlutterwaveWrapper } from '../payments/FlutterwaveWrapper';\r\nimport { MobileMoneyWrapper } from '../payments/MobileMoneyWrapper';\r\nimport { InstallmentSchedule } from './InstallmentSchedule';\r\nimport { hasPaymentPlan } from '../../lib/payment-plans';\r\nimport { useProfile } from '../../context/ProfileContext';\r\nimport { generateReceipt } from '../../lib/receipt-generator';\r\nimport { toast } from 'react-hot-toast';\r\n\r\ninterface FeeStatusScreenProps {\r\n    parentId?: number | null;\r\n    navigateTo: (view: string, title: string, props?: any) => void;\r\n}\r\n\r\nconst FeeStatusScreen: React.FC<FeeStatusScreenProps> = ({ parentId, navigateTo }) => {\r\n    const [students, setStudents] = useState<any[]>([]);\r\n    const [selectedStudent, setSelectedStudent] = useState<any>(null);\r\n    const [fees, setFees] = useState<Fee[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Payment State\r\n    const [paymentFee, setPaymentFee] = useState<Fee | null>(null);\r\n    const [userEmail, setUserEmail] = useState<string>('');\r\n    const [paymentGateway, setPaymentGateway] = useState<'paystack' | 'flutterwave' | 'mobilemoney'>('paystack');\r\n    const [parentName, setParentName] = useState<string>('');\r\n    const [parentPhone, setParentPhone] = useState<string>('');\r\n    const [feesWithPlans, setFeesWithPlans] = useState<Set<number>>(new Set());\r\n\r\n    useEffect(() => {\r\n        const init = async () => {\r\n            // 1. Get Parent Email for receipts\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            const authEmail = user?.email || '';\r\n            setUserEmail(authEmail);\r\n\r\n            // 2. Fetch parent profile details from parents table\r\n            if (parentId) {\r\n                const { data: parentProfile, error } = await supabase\r\n                    .from('parents')\r\n                    .select('name, email, phone')\r\n                    .eq('id', parentId)\r\n                    .single();\r\n\r\n                if (parentProfile) {\r\n                    // Use parent profile data with fallbacks\r\n                    setParentName(parentProfile.name || 'Parent');\r\n                    setParentPhone(parentProfile.phone || '0000000000');\r\n                    // Use parent email if available, otherwise use auth email\r\n                    if (parentProfile.email && !authEmail) {\r\n                        setUserEmail(parentProfile.email);\r\n                    }\r\n                }\r\n\r\n                // 3. Fetch Children\r\n                const { data: relations } = await supabase\r\n                    .from('parent_children')\r\n                    .select('student_id, students:student_id(id, name, grade, section, avatar_url)')\r\n                    .eq('parent_id', parentId);\r\n\r\n                if (relations && relations.length > 0) {\r\n                    // Flatten structure safely\r\n                    const kids = relations.map((r: any) => r.students);\r\n                    setStudents(kids);\r\n                    setSelectedStudent(kids[0]);\r\n                } else {\r\n                    toast('No children found for this parent.');\r\n                }\r\n            } else {\r\n                toast.error('Parent ID not found. Please log in again.');\r\n            }\r\n            setLoading(false);\r\n        };\r\n        init();\r\n    }, [parentId]);\r\n\r\n    useEffect(() => {\r\n        if (selectedStudent) {\r\n            loadFees(selectedStudent.id);\r\n\r\n            // Realtime subscription for fees\r\n            const channel = supabase.channel(`fees_${selectedStudent.id}`)\r\n                .on('postgres_changes', {\r\n                    event: '*',\r\n                    schema: 'public',\r\n                    table: 'student_fees',\r\n                    filter: `student_id=eq.${selectedStudent.id}`\r\n                }, () => {\r\n                    loadFees(selectedStudent.id);\r\n                    // Optional: toast.success('Fees updated'); \r\n                })\r\n                .subscribe();\r\n\r\n            return () => {\r\n                supabase.removeChannel(channel);\r\n            };\r\n        }\r\n    }, [selectedStudent]);\r\n\r\n    const loadFees = async (studentId: number) => {\r\n        setLoading(true);\r\n        const data = await fetchStudentFees(studentId);\r\n        setFees(data);\r\n\r\n        // Check which fees have payment plans\r\n        const plansSet = new Set<number>();\r\n        await Promise.all(\r\n            data.map(async (fee) => {\r\n                const hasPlan = await hasPaymentPlan(fee.id);\r\n                if (hasPlan) plansSet.add(fee.id);\r\n            })\r\n        );\r\n        setFeesWithPlans(plansSet);\r\n\r\n        setLoading(false);\r\n    };\r\n\r\n    const handleDownloadReceipt = async (fee: Fee) => {\r\n        try {\r\n            // Fetch the transaction for this fee\r\n            const { data: transactions, error } = await supabase\r\n                .from('transactions')\r\n                .select('*')\r\n                .eq('fee_id', fee.id)\r\n                .eq('status', 'Success')\r\n                .order('created_at', { ascending: false })\r\n                .limit(1);\r\n\r\n            if (error || !transactions || transactions.length === 0) {\r\n                toast.error('No completed transaction found for this fee.');\r\n                return;\r\n            }\r\n\r\n            const transaction = transactions[0];\r\n\r\n            // Convert from DB format to app format\r\n            const formattedTransaction = {\r\n                id: transaction.id,\r\n                feeId: transaction.fee_id,\r\n                studentId: transaction.student_id,\r\n                payerId: transaction.payer_id,\r\n                amount: transaction.amount,\r\n                reference: transaction.reference,\r\n                provider: transaction.provider,\r\n                status: transaction.status,\r\n                date: transaction.created_at\r\n            };\r\n\r\n            // Generate and download the receipt\r\n            await generateReceipt(\r\n                formattedTransaction,\r\n                fee,\r\n                selectedStudent?.name || 'Student',\r\n                'School Management System' // You can make this dynamic from settings\r\n            );\r\n        } catch (err) {\r\n            console.error('Error downloading receipt:', err);\r\n            toast.error('Error generating receipt. Please try again.');\r\n        }\r\n    };\r\n\r\n    const handlePayClick = (fee: Fee) => {\r\n        setPaymentFee(fee);\r\n        // Trigger the selected payment gateway\r\n        const btnId = paymentGateway === 'paystack'\r\n            ? `paystack-btn-${fee.id}`\r\n            : paymentGateway === 'flutterwave'\r\n                ? `flutterwave-btn-${fee.id}`\r\n                : `mobilemoney-btn-${fee.id}`;\r\n        const btn = document.getElementById(btnId);\r\n        if (btn) btn.click();\r\n    };\r\n\r\n    if (loading && !selectedStudent) {\r\n        return (\r\n            <div className=\"flex items-center justify-center min-h-[400px]\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mx-auto mb-4\"></div>\r\n                    <p className=\"text-gray-600\">Loading fee information...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!selectedStudent && students.length === 0) {\r\n        return (\r\n            <div className=\"p-8 text-center bg-white rounded-2xl shadow-sm\">\r\n                <p className=\"text-gray-500\">No student data available.</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const totalDue = fees.reduce((sum, fee) => sum + (fee.amount - (fee.paidAmount || 0)), 0);\r\n    const totalPaid = fees.reduce((sum, fee) => sum + (fee.paidAmount || 0), 0);\r\n\r\n    return (\r\n        <div className=\"p-4 md:p-6 max-w-6xl mx-auto space-y-6\">\r\n            {/* Child Selector */}\r\n            {students.length > 1 && (\r\n                <div className=\"flex space-x-3 overflow-x-auto pb-2 scrollbar-hide\">\r\n                    {students.map(s => (\r\n                        <button\r\n                            key={s.id}\r\n                            onClick={() => setSelectedStudent(s)}\r\n                            className={`flex items-center space-x-2 px-4 py-2.5 rounded-xl border-2 transition-all flex-shrink-0\r\n                        ${selectedStudent?.id === s.id ? 'bg-indigo-600 text-white border-indigo-600 shadow-md' : 'bg-white text-gray-700 border-gray-200 hover:border-indigo-300 hover:bg-indigo-50'}`}\r\n                        >\r\n                            <img src={s.avatar_url || 'https://via.placeholder.com/32'} className=\"w-7 h-7 rounded-full ring-2 ring-white\" alt={s.name} />\r\n                            <div className=\"text-left\">\r\n                                <span className=\"font-semibold text-sm block\">{s.name}</span>\r\n                                <span className=\"text-xs opacity-80\">{s.grade} {s.section}</span>\r\n                            </div>\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* Stats Summary */}\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n                <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl shadow-lg p-5 text-white\">\r\n                    <p className=\"text-sm opacity-90 mb-1\">Total Fees</p>\r\n                    <p className=\"text-2xl font-bold\">\r\n                        {new Intl.NumberFormat('en-NG', { style: 'currency', currency: 'NGN', minimumFractionDigits: 0 }).format(fees.reduce((sum, fee) => sum + fee.amount, 0))}\r\n                    </p>\r\n                    <p className=\"text-xs opacity-75 mt-1\">{fees.length} fee(s)</p>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl shadow-lg p-5 text-white\">\r\n                    <p className=\"text-sm opacity-90 mb-1\">Total Paid</p>\r\n                    <p className=\"text-2xl font-bold\">\r\n                        {new Intl.NumberFormat('en-NG', { style: 'currency', currency: 'NGN', minimumFractionDigits: 0 }).format(totalPaid)}\r\n                    </p>\r\n                    <p className=\"text-xs opacity-75 mt-1\">Completed payments</p>\r\n                </div>\r\n                <div className=\"bg-gradient-to-br from-red-500 to-red-600 rounded-2xl shadow-lg p-5 text-white\">\r\n                    <p className=\"text-sm opacity-90 mb-1\">Outstanding</p>\r\n                    <p className=\"text-2xl font-bold\">\r\n                        {new Intl.NumberFormat('en-NG', { style: 'currency', currency: 'NGN', minimumFractionDigits: 0 }).format(totalDue)}\r\n                    </p>\r\n                    <p className=\"text-xs opacity-75 mt-1\">Pending payment</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Payment Gateway Selector */}\r\n            <div className=\"bg-white rounded-2xl shadow-sm p-5 border border-gray-100\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <h3 className=\"text-base font-semibold text-gray-800\">Payment Method</h3>\r\n                    <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full\">Select one</span>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\r\n                    <button\r\n                        onClick={() => setPaymentGateway('paystack')}\r\n                        className={`flex flex-col items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${paymentGateway === 'paystack'\r\n                            ? 'border-indigo-600 bg-indigo-50 shadow-md scale-105'\r\n                            : 'border-gray-200 bg-white hover:border-indigo-300 hover:shadow-sm'\r\n                            }`}\r\n                    >\r\n                        <div className={`w-12 h-12 rounded-full flex items-center justify-center ${paymentGateway === 'paystack' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600'}`}>\r\n                            <svg className=\"w-6 h-6\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                <path d=\"M3 10h11v2H3v-2zm0-4h11v2H3V6zm0 8h7v2H3v-2zm13.01-2.5l2.5 1.5v2l-2.5-1.5v-2zm2.5-1.5v2l-2.5-1.5v-2l2.5 1.5zm-5 3v-2l2.5-1.5v2l-2.5 1.5z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <span className={`font-semibold text-sm block ${paymentGateway === 'paystack' ? 'text-indigo-700' : 'text-gray-700'}`}>Paystack</span>\r\n                            <span className=\"text-xs text-gray-500\">Cards, Bank, USSD</span>\r\n                        </div>\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setPaymentGateway('flutterwave')}\r\n                        className={`flex flex-col items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${paymentGateway === 'flutterwave'\r\n                            ? 'border-orange-500 bg-orange-50 shadow-md scale-105'\r\n                            : 'border-gray-200 bg-white hover:border-orange-300 hover:shadow-sm'\r\n                            }`}\r\n                    >\r\n                        <div className={`w-12 h-12 rounded-full flex items-center justify-center ${paymentGateway === 'flutterwave' ? 'bg-orange-500 text-white' : 'bg-gray-100 text-gray-600'}`}>\r\n                            <svg className=\"w-6 h-6\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                <path d=\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <span className={`font-semibold text-sm block ${paymentGateway === 'flutterwave' ? 'text-orange-700' : 'text-gray-700'}`}>Flutterwave</span>\r\n                            <span className=\"text-xs text-gray-500\">Cards, Mobile Money</span>\r\n                        </div>\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setPaymentGateway('mobilemoney')}\r\n                        className={`flex flex-col items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${paymentGateway === 'mobilemoney'\r\n                            ? 'border-green-600 bg-green-50 shadow-md scale-105'\r\n                            : 'border-gray-200 bg-white hover:border-green-300 hover:shadow-sm'\r\n                            }`}\r\n                    >\r\n                        <div className={`w-12 h-12 rounded-full flex items-center justify-center ${paymentGateway === 'mobilemoney' ? 'bg-green-600 text-white' : 'bg-gray-100 text-gray-600'}`}>\r\n                            <svg className=\"w-6 h-6\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                <path d=\"M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <div className=\"text-center\">\r\n                            <span className={`font-semibold text-sm block ${paymentGateway === 'mobilemoney' ? 'text-green-700' : 'text-gray-700'}`}>Mobile Money</span>\r\n                            <span className=\"text-xs text-gray-500\">M-Pesa, MTN, Airtel</span>\r\n                        </div>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Fee List */}\r\n            <div>\r\n                <h2 className=\"text-xl font-bold text-gray-800 mb-4\">\r\n                    Fees for {selectedStudent?.name}\r\n                </h2>\r\n\r\n                {fees.length === 0 ? (\r\n                    <div className=\"text-center py-12 bg-white rounded-2xl shadow-sm\">\r\n                        <p className=\"text-gray-500\">No fees assigned currently. You're all good! ðŸŽ‰</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                        {fees.map(fee => (\r\n                            <div key={fee.id} className=\"relative\">\r\n                                {/* Show installment schedule if fee has payment plan */}\r\n                                {feesWithPlans.has(fee.id) ? (\r\n                                    <div className=\"bg-white rounded-2xl shadow-sm border border-gray-200 p-4\">\r\n                                        <h3 className=\"font-semibold text-gray-900 mb-3\">{fee.title}</h3>\r\n                                        <InstallmentSchedule\r\n                                            feeId={fee.id}\r\n                                            onPayInstallment={(installment) => {\r\n                                                // For installment payments, use the same payment flow\r\n                                                handlePayClick(fee);\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        <FeeCard\r\n                                            fee={fee}\r\n                                            onPay={handlePayClick}\r\n                                            onDownloadReceipt={handleDownloadReceipt}\r\n                                        />\r\n                                        {/* Hidden Payment Triggers */}\r\n                                        <PaystackButton\r\n                                            fee={fee}\r\n                                            email={userEmail}\r\n                                            onSuccess={() => {\r\n                                                toast.success('Payment Successful!');\r\n                                                loadFees(selectedStudent.id); // Refresh\r\n                                            }}\r\n                                        />\r\n                                        <FlutterwaveWrapper\r\n                                            fee={fee}\r\n                                            email={userEmail}\r\n                                            phone={parentPhone}\r\n                                            name={parentName}\r\n                                            onSuccess={() => {\r\n                                                toast.success('Payment Successful!');\r\n                                                loadFees(selectedStudent.id); // Refresh\r\n                                            }}\r\n                                        />\r\n                                        <MobileMoneyWrapper\r\n                                            fee={fee}\r\n                                            email={userEmail}\r\n                                            name={parentName}\r\n                                            onSuccess={() => {\r\n                                                toast.success('Payment Successful!');\r\n                                                loadFees(selectedStudent.id); // Refresh\r\n                                            }}\r\n                                        />\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FeeStatusScreen;"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}