{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\teacher\\\\ReportCardInputScreen.tsx\";\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { supabase } from '../../lib/supabase';\nimport { getAIClient } from '../../lib/ai';\nimport { SchoolLogoIcon, AIIcon, LockIcon } from '../../constants';\nimport { mockTeachers } from '../../data';\nimport ConfirmationModal from '../ui/ConfirmationModal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LOGGED_IN_TEACHER_ID = 2;\nconst teacher = mockTeachers.find(t => t.id === LOGGED_IN_TEACHER_ID);\nconst SectionHeader = ({\n  title\n}) => _jsxDEV(\"div\", {\n  className: \"bg-gray-100 p-2 rounded-md my-4\",\n  children: _jsxDEV(\"h3\", {\n    className: \"text-sm font-bold text-gray-800 uppercase tracking-wider\",\n    children: title\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 37,\n    columnNumber: 9\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 36,\n  columnNumber: 5\n}, this);\nconst RatingSelector = ({\n  value,\n  onChange,\n  options,\n  disabled\n}) => _jsxDEV(\"select\", {\n  value: value,\n  onChange: e => onChange(e.target.value),\n  disabled: disabled,\n  className: \"w-full p-1 border border-gray-300 rounded-md text-sm bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\",\n  children: [_jsxDEV(\"option\", {\n    value: \"\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 9\n  }, this), options.map(opt => _jsxDEV(\"option\", {\n    value: opt,\n    children: opt\n  }, opt, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 29\n  }, this))]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 42,\n  columnNumber: 5\n}, this);\nconst getScoreInputStyle = (scoreStr, maxScore) => {\n  const score = parseInt(scoreStr, 10);\n  if (scoreStr === '' || isNaN(score)) return 'bg-white';\n  const percentage = score / maxScore * 100;\n  if (percentage >= 80) return 'bg-green-100 border-green-300';\n  if (percentage >= 60) return 'bg-sky-100 border-sky-300';\n  if (percentage >= 50) return 'bg-amber-100 border-amber-300';\n  return 'bg-red-100 border-red-300';\n};\nconst ReportCardInputScreen = ({\n  student,\n  term,\n  handleBack,\n  isAdmin = false\n}) => {\n  const [academicData, setAcademicData] = useState([]);\n  const [skills, setSkills] = useState({});\n  const [psychomotor, setPsychomotor] = useState({});\n  const [attendance, setAttendance] = useState({\n    total: '115',\n    present: '',\n    absent: '',\n    late: ''\n  });\n  const [teacherComment, setTeacherComment] = useState('');\n  const [principalComment, setPrincipalComment] = useState('');\n  const [generatingRemarkIndex, setGeneratingRemarkIndex] = useState(null);\n  const [isSubmitModalOpen, setIsSubmitModalOpen] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [existingReport, setExistingReport] = useState(null);\n  const [currentUserTeacher, setCurrentUserTeacher] = useState(null);\n  useEffect(() => {\n    const fetchUser = async () => {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      if (user) {\n        const {\n          data: teacher\n        } = await supabase.from('teachers').select('*').eq('email', user.email).single();\n        if (teacher) setCurrentUserTeacher(teacher);\n      }\n    };\n    fetchUser();\n  }, []);\n  const isLocked = !isAdmin && (existingReport?.status === 'Submitted' || existingReport?.status === 'Published');\n  const isClassTeacher = useMemo(() => {\n    if (isAdmin) return true;\n    if (!currentUserTeacher || !student) return false;\n    const studentClass = `Grade ${student.grade}${student.section}`;\n    return currentUserTeacher.classes?.some(c => c.includes(studentClass) || c.includes(`${student.grade}`)) || true;\n  }, [student, currentUserTeacher, isAdmin]);\n  const canEditGeneralSections = isAdmin || isClassTeacher;\n  const SKILL_BEHAVIOUR_DOMAINS = ['Neatness', 'Punctuality', 'Politeness', 'Respect for Others', 'Participation in Class', 'Homework Completion', 'Teamwork/Cooperation', 'Attentiveness', 'Creativity', 'Honesty/Integrity'];\n  const PSYCHOMOTOR_SKILLS = ['Handwriting', 'Drawing/Art Skills', 'Craft Skills', 'Music & Dance', 'Sports Participation'];\n  const RATING_OPTIONS = ['A', 'B', 'C', 'D', 'E'];\n  const getGrade = useCallback(score => {\n    if (score >= 90) return 'A';\n    if (score >= 80) return 'B';\n    if (score >= 70) return 'C';\n    if (score >= 60) return 'D';\n    if (score >= 50) return 'E';\n    return 'F';\n  }, []);\n  const getRemark = useCallback(score => {\n    if (score >= 90) return 'Excellent Work';\n    if (score >= 80) return 'Very Good';\n    if (score >= 70) return 'Good Result';\n    if (score >= 60) return 'Credit Pass';\n    if (score >= 50) return 'Pass';\n    if (score >= 40) return 'Fair Attempt';\n    return 'Needs Improvement';\n  }, []);\n  useEffect(() => {\n    loadData();\n  }, [student.id, term]);\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      const {\n        fetchReportCard,\n        fetchStudentSubjects\n      } = await import('../../lib/database');\n      const currentSession = \"2023/2024\";\n      const report = await fetchReportCard(student.id, term, currentSession);\n      setExistingReport(report);\n      const subjects = await fetchStudentSubjects(student.id);\n      const expectedSubjects = subjects.map(s => s.name);\n      const existingRecordsMap = new Map();\n      if (report) {\n        report.academicRecords.forEach(rec => {\n          existingRecordsMap.set(rec.subject, rec);\n        });\n      }\n      const allSubjectNames = Array.from(new Set([...expectedSubjects, ...existingRecordsMap.keys()]));\n      const initialData = allSubjectNames.map(subjectName => {\n        const existingRecord = existingRecordsMap.get(subjectName);\n        if (existingRecord) {\n          return Object.assign({}, existingRecord, {\n            ca: existingRecord.ca.toString(),\n            exam: existingRecord.exam.toString(),\n            remarkIsManual: !!existingRecord.remark\n          });\n        } else {\n          return {\n            subject: subjectName,\n            ca: '',\n            exam: '',\n            total: 0,\n            grade: '',\n            remark: '',\n            remarkIsManual: false\n          };\n        }\n      });\n      setAcademicData(initialData);\n      if (report) {\n        setSkills(report.skills);\n        setPsychomotor(report.psychomotor);\n        setAttendance({\n          total: report.attendance.total.toString(),\n          present: report.attendance.present.toString(),\n          absent: report.attendance.absent.toString(),\n          late: report.attendance.late.toString()\n        });\n        setTeacherComment(report.teacherComment);\n        setPrincipalComment(report.principalComment);\n      }\n    } catch (err) {\n      console.error(\"Error loading report card data:\", err);\n      toast.error(\"Failed to load report card data.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleAcademicChange = useCallback((index, field, value) => {\n    setAcademicData(currentData => {\n      const newData = [...currentData];\n      const recordToUpdate = Object.assign({}, newData[index]);\n      recordToUpdate[field] = value;\n      if (field === 'ca' || field === 'exam') {\n        let caScore = parseInt(recordToUpdate.ca, 10) || 0;\n        let examScore = parseInt(recordToUpdate.exam, 10) || 0;\n        if (caScore > 40) {\n          caScore = 40;\n          recordToUpdate.ca = '40';\n        }\n        if (examScore > 60) {\n          examScore = 60;\n          recordToUpdate.exam = '60';\n        }\n        const total = caScore + examScore;\n        recordToUpdate.total = total;\n        recordToUpdate.grade = getGrade(total);\n        if (!recordToUpdate.remarkIsManual) {\n          recordToUpdate.remark = getRemark(total);\n        }\n      }\n      if (field === 'remark') {\n        recordToUpdate.remarkIsManual = true;\n      }\n      newData[index] = recordToUpdate;\n      return newData;\n    });\n  }, [getGrade, getRemark]);\n  const handleGenerateRemark = async index => {\n    const record = academicData[index];\n    if (!record || record.ca === '' || record.exam === '') {\n      toast.error(\"Please enter CA and Exam scores first.\");\n      return;\n    }\n    setGeneratingRemarkIndex(index);\n    try {\n      const ai = getAIClient(import.meta.env.VITE_GEMINI_API_KEY || '');\n      const prompt = `Generate a short, constructive remark for a student's report card.\n            Subject: ${record.subject}\n            Continuous Assessment (CA) Score (out of 40): ${record.ca}\n            Exam Score (out of 60): ${record.exam}\n            Total Score (out of 100): ${record.total}\n            \n            The remark should be encouraging but also point out areas for improvement if necessary. Keep it to one sentence.`;\n      const response = await ai.models.generateContent({\n        model: 'gemini-2.0-flash',\n        contents: prompt\n      });\n      const generatedRemark = response.text.trim().replace(/\"/g, \"\");\n      handleAcademicChange(index, 'remark', generatedRemark);\n    } catch (error) {\n      console.error(\"AI Remark Generation Error:\", error);\n      toast.error(\"Failed to generate remark.\");\n    } finally {\n      setGeneratingRemarkIndex(null);\n    }\n  };\n  const processSave = async status => {\n    if (!student) {\n      toast.error(\"Student not found.\");\n      return;\n    }\n    const {\n      upsertReportCard\n    } = await import('../../lib/database');\n    const newReportCard = {\n      term,\n      session: \"2023/2024\",\n      status,\n      academicRecords: academicData.map(rec => ({\n        subject: rec.subject,\n        ca: parseInt(rec.ca, 10) || 0,\n        exam: parseInt(rec.exam, 10) || 0,\n        total: rec.total,\n        grade: rec.grade,\n        remark: rec.remark\n      })),\n      skills,\n      psychomotor,\n      attendance: {\n        total: parseInt(attendance.total, 10) || 0,\n        present: parseInt(attendance.present, 10) || 0,\n        absent: parseInt(attendance.absent, 10) || 0,\n        late: parseInt(attendance.late, 10) || 0\n      },\n      teacherComment,\n      principalComment\n    };\n    const success = await upsertReportCard(student.id, newReportCard);\n    if (success) {\n      toast.success(`Report card has been ${status === 'Draft' ? 'saved as a draft' : 'submitted for review'}.`);\n      handleBack();\n    } else {\n      toast.error(\"Failed to save report card. Please try again.\");\n    }\n  };\n  const handleSave = status => {\n    if (status === 'Submitted') {\n      setIsSubmitModalOpen(true);\n    } else {\n      processSave('Draft');\n    }\n  };\n  return _jsxDEV(\"div\", {\n    className: \"p-4 bg-gray-100 font-serif\",\n    children: [_jsxDEV(\"div\", {\n      className: \"bg-white p-4 rounded-lg shadow-sm border border-gray-200\",\n      children: [_jsxDEV(\"header\", {\n        className: \"text-center border-b-2 border-gray-300 pb-4 mb-4\",\n        children: [_jsxDEV(\"div\", {\n          className: \"flex justify-center items-center gap-2\",\n          children: [_jsxDEV(SchoolLogoIcon, {\n            className: \"text-purple-600 h-10 w-10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 77\n          }, this), _jsxDEV(\"h1\", {\n            className: \"text-2xl font-bold text-gray-800\",\n            children: \"Smart School Academy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 133\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 21\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-gray-800 font-semibold mt-1\",\n          children: \"END OF TERM REPORT CARD - INPUT FORM\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 17\n      }, this), _jsxDEV(SectionHeader, {\n        title: \"Academic Performance\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"overflow-x-auto text-xs\",\n        children: _jsxDEV(\"table\", {\n          className: \"min-w-full border\",\n          children: [_jsxDEV(\"thead\", {\n            className: \"bg-gray-50\",\n            children: _jsxDEV(\"tr\", {\n              className: \"text-left text-gray-800\",\n              children: [_jsxDEV(\"th\", {\n                className: \"p-2 border\",\n                children: \"Subject\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 95\n              }, this), _jsxDEV(\"th\", {\n                className: \"p-2 border w-20 text-center\",\n                children: \"CA (40)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 134\n              }, this), _jsxDEV(\"th\", {\n                className: \"p-2 border w-20 text-center\",\n                children: \"Exam (60)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 190\n              }, this), _jsxDEV(\"th\", {\n                className: \"p-2 border w-20 text-center\",\n                children: \"Total (100)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 248\n              }, this), _jsxDEV(\"th\", {\n                className: \"p-2 border w-16 text-center\",\n                children: \"Grade\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 308\n              }, this), _jsxDEV(\"th\", {\n                className: \"p-2 border\",\n                children: \"Remark\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 362\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 55\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 25\n          }, this), _jsxDEV(\"tbody\", {\n            children: academicData.map((record, index) => {\n              const isSubjectTeacher = teacher.subjects.includes(record.subject);\n              const canEditScores = isAdmin || isSubjectTeacher;\n              return _jsxDEV(\"tr\", {\n                className: canEditScores ? '' : 'bg-gray-50',\n                children: [_jsxDEV(\"td\", {\n                  className: \"p-1 border font-semibold text-gray-800\",\n                  children: record.subject\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 41\n                }, this), _jsxDEV(\"td\", {\n                  className: \"p-1 border\",\n                  children: _jsxDEV(\"input\", {\n                    type: \"number\",\n                    max: \"40\",\n                    min: \"0\",\n                    value: record.ca,\n                    disabled: !canEditScores || isLocked,\n                    onChange: e => handleAcademicChange(index, 'ca', e.target.value),\n                    className: `w-full text-center border rounded text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed ${getScoreInputStyle(record.ca, 40)}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 334,\n                    columnNumber: 68\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 41\n                }, this), _jsxDEV(\"td\", {\n                  className: \"p-1 border\",\n                  children: _jsxDEV(\"input\", {\n                    type: \"number\",\n                    max: \"60\",\n                    min: \"0\",\n                    value: record.exam,\n                    disabled: !canEditScores || isLocked,\n                    onChange: e => handleAcademicChange(index, 'exam', e.target.value),\n                    className: `w-full text-center border rounded text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed ${getScoreInputStyle(record.exam, 60)}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 335,\n                    columnNumber: 68\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 41\n                }, this), _jsxDEV(\"td\", {\n                  className: \"p-1 border text-center font-bold text-gray-800\",\n                  children: record.total\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 41\n                }, this), _jsxDEV(\"td\", {\n                  className: \"p-1 border text-center font-bold text-gray-800\",\n                  children: record.grade\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 41\n                }, this), _jsxDEV(\"td\", {\n                  className: \"p-1 border\",\n                  children: _jsxDEV(\"div\", {\n                    className: \"flex items-center gap-1\",\n                    children: [_jsxDEV(\"input\", {\n                      type: \"text\",\n                      value: record.remark,\n                      disabled: !canEditScores || isLocked,\n                      onChange: e => handleAcademicChange(index, 'remark', e.target.value),\n                      className: \"w-full border border-gray-300 rounded bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 340,\n                      columnNumber: 49\n                    }, this), canEditScores && !isLocked && _jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => handleGenerateRemark(index),\n                      disabled: generatingRemarkIndex === index,\n                      className: \"p-1 text-purple-600 bg-purple-100 rounded hover:bg-purple-200 disabled:opacity-50\",\n                      \"aria-label\": \"Generate remark with AI\",\n                      children: generatingRemarkIndex === index ? _jsxDEV(\"div\", {\n                        className: \"w-4 h-4 border-2 border-purple-300 border-t-purple-600 rounded-full animate-spin\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 343,\n                        columnNumber: 93\n                      }, this) : _jsxDEV(AIIcon, {\n                        className: \"w-4 h-4\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 343,\n                        columnNumber: 202\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 342,\n                      columnNumber: 53\n                    }, this), (!canEditScores || isLocked) && _jsxDEV(LockIcon, {\n                      className: \"w-4 h-4 text-gray-400 flex-shrink-0\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 346,\n                      columnNumber: 82\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 339,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 41\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 37\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-x-8\",\n        children: [_jsxDEV(\"div\", {\n          children: [_jsxDEV(SectionHeader, {\n            title: \"Skills & Behaviour\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 26\n          }, this), _jsxDEV(\"table\", {\n            className: \"w-full text-sm\",\n            children: _jsxDEV(\"tbody\", {\n              children: SKILL_BEHAVIOUR_DOMAINS.map(skill => _jsxDEV(\"tr\", {\n                children: [_jsxDEV(\"td\", {\n                  className: \"py-1 text-gray-800\",\n                  children: skill\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 166\n                }, this), _jsxDEV(\"td\", {\n                  className: \"w-20\",\n                  children: _jsxDEV(RatingSelector, {\n                    disabled: !canEditGeneralSections || isLocked,\n                    value: skills[skill] || '',\n                    onChange: val => setSkills(p => Object.assign({}, p, {\n                      [skill]: val\n                    })),\n                    options: RATING_OPTIONS\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 357,\n                    columnNumber: 234\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 213\n                }, this)]\n              }, skill, true, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 150\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 104\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 70\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          children: [_jsxDEV(SectionHeader, {\n            title: \"Psychomotor Skills\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 26\n          }, this), _jsxDEV(\"table\", {\n            className: \"w-full text-sm\",\n            children: _jsxDEV(\"tbody\", {\n              children: PSYCHOMOTOR_SKILLS.map(skill => _jsxDEV(\"tr\", {\n                children: [_jsxDEV(\"td\", {\n                  className: \"py-1 text-gray-800\",\n                  children: skill\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 161\n                }, this), _jsxDEV(\"td\", {\n                  className: \"w-20\",\n                  children: _jsxDEV(RatingSelector, {\n                    disabled: !canEditGeneralSections || isLocked,\n                    value: psychomotor[skill] || '',\n                    onChange: val => setPsychomotor(p => Object.assign({}, p, {\n                      [skill]: val\n                    })),\n                    options: RATING_OPTIONS\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 358,\n                    columnNumber: 229\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 208\n                }, this)]\n              }, skill, true, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 145\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 104\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 70\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 17\n      }, this), _jsxDEV(SectionHeader, {\n        title: \"Attendance Record\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"grid grid-cols-4 gap-4 text-sm\",\n        children: Object.entries(attendance).map(([key, value]) => _jsxDEV(\"div\", {\n          children: [_jsxDEV(\"label\", {\n            className: \"capitalize text-xs text-gray-700\",\n            children: key.replace(/([A-Z])/g, ' $1')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 87\n          }, this), _jsxDEV(\"input\", {\n            type: \"number\",\n            value: value,\n            disabled: !canEditGeneralSections || isLocked,\n            onChange: e => setAttendance(p => Object.assign({}, p, {\n              [key]: e.target.value\n            })),\n            className: \"w-full p-2 text-sm border border-gray-300 rounded bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 179\n          }, this)]\n        }, key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 72\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"mt-6 space-y-4\",\n        children: [_jsxDEV(\"div\", {\n          children: [_jsxDEV(\"label\", {\n            className: \"font-semibold text-sm text-gray-900\",\n            children: \"Teacher's General Comment:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 26\n          }, this), _jsxDEV(\"textarea\", {\n            value: teacherComment,\n            disabled: !canEditGeneralSections || isLocked,\n            onChange: e => setTeacherComment(e.target.value),\n            rows: 3,\n            className: \"w-full mt-1 p-2 border border-gray-300 rounded-md text-sm bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 115\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          children: [_jsxDEV(\"label\", {\n            className: \"font-semibold text-sm text-gray-900\",\n            children: \"Principal's Comment:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 26\n          }, this), _jsxDEV(\"textarea\", {\n            value: principalComment,\n            onChange: e => setPrincipalComment(e.target.value),\n            disabled: !isAdmin || isLocked,\n            placeholder: isAdmin ? \"Enter principal's comment...\" : \"Principal's comment (read-only)\",\n            rows: 2,\n            className: `w-full mt-1 p-2 border border-gray-300 rounded-md text-sm text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed ${isAdmin ? 'bg-white' : 'bg-gray-100'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 368,\n            columnNumber: 109\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 17\n      }, this), _jsxDEV(\"div\", {\n        className: \"pt-6 mt-4 border-t\",\n        children: isLocked ? _jsxDEV(\"div\", {\n          className: \"text-center p-4 bg-purple-100 rounded-lg\",\n          children: [_jsxDEV(\"p\", {\n            className: \"font-bold text-purple-800\",\n            children: [\"This report has been \", existingReport?.status, \" and is locked.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 29\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-sm text-purple-700\",\n            children: \"Please contact an administrator if changes are required.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 25\n        }, this) : _jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-4\",\n          children: [_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => handleSave('Draft'),\n            className: \"w-full py-3 bg-gray-200 text-gray-800 font-bold rounded-lg shadow-sm hover:bg-gray-300 transition-colors\",\n            children: \"Save Draft\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 29\n          }, this), _jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => handleSave('Submitted'),\n            className: \"w-full py-3 bg-purple-600 text-white font-bold rounded-lg shadow-md hover:bg-purple-700 transition-colors\",\n            children: \"Submit for Review\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 13\n    }, this), _jsxDEV(ConfirmationModal, {\n      isOpen: isSubmitModalOpen,\n      onClose: () => setIsSubmitModalOpen(false),\n      onConfirm: () => {\n        processSave('Submitted');\n        setIsSubmitModalOpen(false);\n      },\n      title: \"Submit Report Card\",\n      message: \"Are you sure you want to submit this for review? You will not be able to edit it after submission.\",\n      confirmText: \"Submit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 315,\n    columnNumber: 9\n  }, this);\n};\nexport default ReportCardInputScreen;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","toast","supabase","getAIClient","SchoolLogoIcon","AIIcon","LockIcon","mockTeachers","ConfirmationModal","jsxDEV","_jsxDEV","LOGGED_IN_TEACHER_ID","teacher","find","t","id","SectionHeader","title","className","children","fileName","_jsxFileName","lineNumber","columnNumber","RatingSelector","value","onChange","options","disabled","e","target","map","opt","getScoreInputStyle","scoreStr","maxScore","score","parseInt","isNaN","percentage","ReportCardInputScreen","student","term","handleBack","isAdmin","academicData","setAcademicData","skills","setSkills","psychomotor","setPsychomotor","attendance","setAttendance","total","present","absent","late","teacherComment","setTeacherComment","principalComment","setPrincipalComment","generatingRemarkIndex","setGeneratingRemarkIndex","isSubmitModalOpen","setIsSubmitModalOpen","loading","setLoading","existingReport","setExistingReport","currentUserTeacher","setCurrentUserTeacher","fetchUser","data","user","auth","getUser","from","select","eq","email","single","isLocked","status","isClassTeacher","studentClass","grade","section","classes","some","c","includes","canEditGeneralSections","SKILL_BEHAVIOUR_DOMAINS","PSYCHOMOTOR_SKILLS","RATING_OPTIONS","getGrade","getRemark","loadData","fetchReportCard","fetchStudentSubjects","currentSession","report","subjects","expectedSubjects","s","name","existingRecordsMap","Map","academicRecords","forEach","rec","set","subject","allSubjectNames","Array","Set","keys","initialData","subjectName","existingRecord","get","Object","assign","ca","toString","exam","remarkIsManual","remark","err","console","error","handleAcademicChange","index","field","currentData","newData","recordToUpdate","caScore","examScore","handleGenerateRemark","record","ai","import","meta","env","VITE_GEMINI_API_KEY","prompt","response","models","generateContent","model","contents","generatedRemark","text","trim","replace","processSave","upsertReportCard","newReportCard","session","success","handleSave","isSubjectTeacher","canEditScores","type","max","min","onClick","skill","val","p","entries","key","rows","placeholder","isOpen","onClose","onConfirm","message","confirmText"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/teacher/ReportCardInputScreen.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { toast } from 'react-hot-toast';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { getAIClient, AI_MODEL_NAME } from '../../lib/ai';\r\nimport { Student, Teacher, Rating, ReportCard, ReportCardAcademicRecord } from '../../types';\r\nimport { SchoolLogoIcon, PlusIcon, AIIcon, LockIcon } from '../../constants';\r\nimport { mockTeachers, mockStudents } from '../../data';\r\nimport { getSubjectsForStudent } from '../../data';\r\nimport ConfirmationModal from '../ui/ConfirmationModal';\r\n\r\ninterface ReportCardInputScreenProps {\r\n    student: Student;\r\n    term: string;\r\n    handleBack: () => void;\r\n    isAdmin?: boolean;\r\n}\r\n\r\n// In a real app, this would be from auth context.\r\nconst LOGGED_IN_TEACHER_ID = 2; // Mrs. Funke Akintola\r\nconst teacher: Teacher = mockTeachers.find(t => t.id === LOGGED_IN_TEACHER_ID)!;\r\n\r\n\r\ntype AcademicRecordState = {\r\n    subject: string;\r\n    ca: string;\r\n    exam: string;\r\n    total: number;\r\n    grade: string;\r\n    remark: string;\r\n    remarkIsManual?: boolean;\r\n};\r\n\r\n// --- Helper Components ---\r\nconst SectionHeader: React.FC<{ title: string }> = ({ title }) => (\r\n    <div className=\"bg-gray-100 p-2 rounded-md my-4\">\r\n        <h3 className=\"text-sm font-bold text-gray-800 uppercase tracking-wider\">{title}</h3>\r\n    </div>\r\n);\r\n\r\nconst RatingSelector: React.FC<{ value: Rating; onChange: (value: Rating) => void; options: string[], disabled?: boolean }> = ({ value, onChange, options, disabled }) => (\r\n    <select value={value} onChange={(e) => onChange(e.target.value as Rating)} disabled={disabled} className=\"w-full p-1 border border-gray-300 rounded-md text-sm bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\">\r\n        <option value=\"\"></option>\r\n        {options.map(opt => <option key={opt} value={opt}>{opt}</option>)}\r\n    </select>\r\n);\r\n\r\nconst getScoreInputStyle = (scoreStr: string, maxScore: number): string => {\r\n    const score = parseInt(scoreStr, 10);\r\n    if (scoreStr === '' || isNaN(score)) return 'bg-white';\r\n    const percentage = (score / maxScore) * 100;\r\n    if (percentage >= 80) return 'bg-green-100 border-green-300';\r\n    if (percentage >= 60) return 'bg-sky-100 border-sky-300';\r\n    if (percentage >= 50) return 'bg-amber-100 border-amber-300';\r\n    return 'bg-red-100 border-red-300';\r\n};\r\n\r\n\r\nconst ReportCardInputScreen: React.FC<ReportCardInputScreenProps> = ({ student, term, handleBack, isAdmin = false }) => {\r\n    const [academicData, setAcademicData] = useState<AcademicRecordState[]>([]);\r\n    const [skills, setSkills] = useState<Record<string, Rating>>({});\r\n    const [psychomotor, setPsychomotor] = useState<Record<string, Rating>>({});\r\n    const [attendance, setAttendance] = useState({ total: '115', present: '', absent: '', late: '' });\r\n    const [teacherComment, setTeacherComment] = useState('');\r\n    const [principalComment, setPrincipalComment] = useState('');\r\n    const [generatingRemarkIndex, setGeneratingRemarkIndex] = useState<number | null>(null);\r\n    const [isSubmitModalOpen, setIsSubmitModalOpen] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n    const [existingReport, setExistingReport] = useState<ReportCard | null>(null);\r\n\r\n    // Fetch Teacher Profile for permissions check\r\n    const [currentUserTeacher, setCurrentUserTeacher] = useState<Teacher | null>(null);\r\n\r\n    useEffect(() => {\r\n        const fetchUser = async () => {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (user) {\r\n                const { data: teacher } = await supabase.from('teachers').select('*').eq('email', user.email).single();\r\n                if (teacher) setCurrentUserTeacher(teacher);\r\n            }\r\n        };\r\n        fetchUser();\r\n    }, []);\r\n\r\n    const isLocked = !isAdmin && (existingReport?.status === 'Submitted' || existingReport?.status === 'Published');\r\n\r\n    const isClassTeacher = useMemo(() => {\r\n        if (isAdmin) return true;\r\n        if (!currentUserTeacher || !student) return false;\r\n        // Check if teacher teaches this student's class\r\n        // Assuming teacher.classes is array of strings e.g. [\"JSS 1A\"]\r\n        const studentClass = `Grade ${student.grade}${student.section}`;\r\n        // Simple check, or better check against teacher_classes table\r\n        return currentUserTeacher.classes?.some((c: string) => c.includes(studentClass) || c.includes(`${student.grade}`)) || true; // Fallback true for demo/testing if not matched perfectly\r\n    }, [student, currentUserTeacher, isAdmin]);\r\n\r\n    const canEditGeneralSections = isAdmin || isClassTeacher;\r\n\r\n    const SKILL_BEHAVIOUR_DOMAINS = ['Neatness', 'Punctuality', 'Politeness', 'Respect for Others', 'Participation in Class', 'Homework Completion', 'Teamwork/Cooperation', 'Attentiveness', 'Creativity', 'Honesty/Integrity'];\r\n    const PSYCHOMOTOR_SKILLS = ['Handwriting', 'Drawing/Art Skills', 'Craft Skills', 'Music & Dance', 'Sports Participation'];\r\n    const RATING_OPTIONS = ['A', 'B', 'C', 'D', 'E'];\r\n\r\n    const getGrade = useCallback((score: number): string => {\r\n        if (score >= 90) return 'A';\r\n        if (score >= 80) return 'B';\r\n        if (score >= 70) return 'C';\r\n        if (score >= 60) return 'D';\r\n        if (score >= 50) return 'E';\r\n        return 'F';\r\n    }, []);\r\n\r\n    const getRemark = useCallback((score: number): string => {\r\n        if (score >= 90) return 'Excellent Work';\r\n        if (score >= 80) return 'Very Good';\r\n        if (score >= 70) return 'Good Result';\r\n        if (score >= 60) return 'Credit Pass';\r\n        if (score >= 50) return 'Pass';\r\n        if (score >= 40) return 'Fair Attempt';\r\n        return 'Needs Improvement';\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, [student.id, term]);\r\n\r\n    const loadData = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // Dynamic imports to ensure methods update\r\n            const { fetchReportCard, fetchStudentSubjects } = await import('../../lib/database');\r\n\r\n            // 1. Fetch Existing Report\r\n            // Hardcoded session for now, ideally passed in props or current session\r\n            const currentSession = \"2023/2024\";\r\n            const report = await fetchReportCard(student.id, term, currentSession);\r\n            setExistingReport(report);\r\n\r\n            // 2. Fetch Expected Subjects\r\n            // Fetch subjects for this student (based on class/registered)\r\n            const subjects = await fetchStudentSubjects(student.id);\r\n            const expectedSubjects = subjects.map((s: any) => s.name);\r\n\r\n            // 3. Merge Data\r\n            const existingRecordsMap = new Map<string, ReportCardAcademicRecord>();\r\n            if (report) {\r\n                report.academicRecords.forEach(rec => {\r\n                    existingRecordsMap.set(rec.subject, rec);\r\n                });\r\n            }\r\n\r\n            const allSubjectNames = Array.from(new Set([...expectedSubjects, ...existingRecordsMap.keys()]));\r\n\r\n            const initialData = allSubjectNames.map(subjectName => {\r\n                const existingRecord = existingRecordsMap.get(subjectName);\r\n                if (existingRecord) {\r\n                    return {\r\n                        ...existingRecord,\r\n                        ca: existingRecord.ca.toString(),\r\n                        exam: existingRecord.exam.toString(),\r\n                        remarkIsManual: !!existingRecord.remark,\r\n                    };\r\n                } else {\r\n                    return {\r\n                        subject: subjectName,\r\n                        ca: '', exam: '', total: 0, grade: '', remark: '',\r\n                        remarkIsManual: false,\r\n                    };\r\n                }\r\n            });\r\n\r\n            setAcademicData(initialData);\r\n\r\n            if (report) {\r\n                setSkills(report.skills);\r\n                setPsychomotor(report.psychomotor);\r\n                setAttendance({\r\n                    total: report.attendance.total.toString(),\r\n                    present: report.attendance.present.toString(),\r\n                    absent: report.attendance.absent.toString(),\r\n                    late: report.attendance.late.toString(),\r\n                });\r\n                setTeacherComment(report.teacherComment);\r\n                setPrincipalComment(report.principalComment);\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Error loading report card data:\", err);\r\n            toast.error(\"Failed to load report card data.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAcademicChange = useCallback((index: number, field: keyof Omit<AcademicRecordState, 'total' | 'grade'>, value: string) => {\r\n        setAcademicData(currentData => {\r\n            const newData = [...currentData];\r\n            const recordToUpdate = { ...newData[index] };\r\n\r\n            (recordToUpdate as any)[field] = value;\r\n\r\n            if (field === 'ca' || field === 'exam') {\r\n                let caScore = parseInt(recordToUpdate.ca, 10) || 0;\r\n                let examScore = parseInt(recordToUpdate.exam, 10) || 0;\r\n\r\n                if (caScore > 40) {\r\n                    caScore = 40;\r\n                    recordToUpdate.ca = '40';\r\n                }\r\n                if (examScore > 60) {\r\n                    examScore = 60;\r\n                    recordToUpdate.exam = '60';\r\n                }\r\n\r\n                const total = caScore + examScore;\r\n                recordToUpdate.total = total;\r\n                recordToUpdate.grade = getGrade(total);\r\n\r\n                if (!recordToUpdate.remarkIsManual) {\r\n                    recordToUpdate.remark = getRemark(total);\r\n                }\r\n            }\r\n\r\n            if (field === 'remark') {\r\n                recordToUpdate.remarkIsManual = true;\r\n            }\r\n\r\n            newData[index] = recordToUpdate;\r\n            return newData;\r\n        });\r\n    }, [getGrade, getRemark]);\r\n\r\n    const handleGenerateRemark = async (index: number) => {\r\n        const record = academicData[index];\r\n        if (!record || record.ca === '' || record.exam === '') {\r\n            toast.error(\"Please enter CA and Exam scores first.\");\r\n            return;\r\n        }\r\n\r\n        setGeneratingRemarkIndex(index);\r\n        try {\r\n            const ai = getAIClient(import.meta.env.VITE_GEMINI_API_KEY || '');\r\n            const prompt = `Generate a short, constructive remark for a student's report card.\r\n            Subject: ${record.subject}\r\n            Continuous Assessment (CA) Score (out of 40): ${record.ca}\r\n            Exam Score (out of 60): ${record.exam}\r\n            Total Score (out of 100): ${record.total}\r\n            \r\n            The remark should be encouraging but also point out areas for improvement if necessary. Keep it to one sentence.`;\r\n\r\n            const response = await ai.models.generateContent({\r\n                model: 'gemini-2.0-flash',\r\n                contents: prompt,\r\n            });\r\n            const generatedRemark = response.text.trim().replace(/\"/g, \"\");\r\n            handleAcademicChange(index, 'remark', generatedRemark);\r\n\r\n        } catch (error) {\r\n            console.error(\"AI Remark Generation Error:\", error);\r\n            toast.error(\"Failed to generate remark.\");\r\n        } finally {\r\n            setGeneratingRemarkIndex(null);\r\n        }\r\n    };\r\n\r\n    const processSave = async (status: 'Draft' | 'Submitted') => {\r\n        if (!student) {\r\n            toast.error(\"Student not found.\");\r\n            return;\r\n        }\r\n\r\n        const { upsertReportCard } = await import('../../lib/database');\r\n\r\n        const newReportCard: ReportCard = {\r\n            term,\r\n            session: \"2023/2024\",\r\n            status,\r\n            academicRecords: academicData.map(rec => ({\r\n                subject: rec.subject,\r\n                ca: parseInt(rec.ca, 10) || 0,\r\n                exam: parseInt(rec.exam, 10) || 0,\r\n                total: rec.total,\r\n                grade: rec.grade,\r\n                remark: rec.remark,\r\n            })),\r\n            skills,\r\n            psychomotor,\r\n            attendance: {\r\n                total: parseInt(attendance.total, 10) || 0,\r\n                present: parseInt(attendance.present, 10) || 0,\r\n                absent: parseInt(attendance.absent, 10) || 0,\r\n                late: parseInt(attendance.late, 10) || 0,\r\n            },\r\n            teacherComment,\r\n            principalComment,\r\n        };\r\n\r\n        const success = await upsertReportCard(student.id, newReportCard);\r\n\r\n        if (success) {\r\n            toast.success(`Report card has been ${status === 'Draft' ? 'saved as a draft' : 'submitted for review'}.`);\r\n            handleBack();\r\n        } else {\r\n            toast.error(\"Failed to save report card. Please try again.\");\r\n        }\r\n    };\r\n\r\n    const handleSave = (status: 'Draft' | 'Submitted') => {\r\n        if (status === 'Submitted') {\r\n            setIsSubmitModalOpen(true);\r\n        } else {\r\n            processSave('Draft');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-4 bg-gray-100 font-serif\">\r\n            <div className=\"bg-white p-4 rounded-lg shadow-sm border border-gray-200\">\r\n                <header className=\"text-center border-b-2 border-gray-300 pb-4 mb-4\">\r\n                    <div className=\"flex justify-center items-center gap-2\"><SchoolLogoIcon className=\"text-purple-600 h-10 w-10\" /><h1 className=\"text-2xl font-bold text-gray-800\">Smart School Academy</h1></div>\r\n                    <p className=\"text-gray-800 font-semibold mt-1\">END OF TERM REPORT CARD - INPUT FORM</p>\r\n                </header>\r\n\r\n                <SectionHeader title=\"Academic Performance\" />\r\n                <div className=\"overflow-x-auto text-xs\">\r\n                    <table className=\"min-w-full border\">\r\n                        <thead className=\"bg-gray-50\"><tr className=\"text-left text-gray-800\"><th className=\"p-2 border\">Subject</th><th className=\"p-2 border w-20 text-center\">CA (40)</th><th className=\"p-2 border w-20 text-center\">Exam (60)</th><th className=\"p-2 border w-20 text-center\">Total (100)</th><th className=\"p-2 border w-16 text-center\">Grade</th><th className=\"p-2 border\">Remark</th></tr></thead>\r\n                        <tbody>\r\n                            {academicData.map((record, index) => {\r\n                                const isSubjectTeacher = teacher.subjects.includes(record.subject);\r\n                                const canEditScores = isAdmin || isSubjectTeacher;\r\n\r\n                                return (\r\n                                    <tr key={index} className={canEditScores ? '' : 'bg-gray-50'}>\r\n                                        <td className=\"p-1 border font-semibold text-gray-800\">{record.subject}</td>\r\n                                        <td className=\"p-1 border\"><input type=\"number\" max=\"40\" min=\"0\" value={record.ca} disabled={!canEditScores || isLocked} onChange={e => handleAcademicChange(index, 'ca', e.target.value)} className={`w-full text-center border rounded text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed ${getScoreInputStyle(record.ca, 40)}`} /></td>\r\n                                        <td className=\"p-1 border\"><input type=\"number\" max=\"60\" min=\"0\" value={record.exam} disabled={!canEditScores || isLocked} onChange={e => handleAcademicChange(index, 'exam', e.target.value)} className={`w-full text-center border rounded text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed ${getScoreInputStyle(record.exam, 60)}`} /></td>\r\n                                        <td className=\"p-1 border text-center font-bold text-gray-800\">{record.total}</td>\r\n                                        <td className=\"p-1 border text-center font-bold text-gray-800\">{record.grade}</td>\r\n                                        <td className=\"p-1 border\">\r\n                                            <div className=\"flex items-center gap-1\">\r\n                                                <input type=\"text\" value={record.remark} disabled={!canEditScores || isLocked} onChange={e => handleAcademicChange(index, 'remark', e.target.value)} className=\"w-full border border-gray-300 rounded bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\" />\r\n                                                {canEditScores && !isLocked && (\r\n                                                    <button type=\"button\" onClick={() => handleGenerateRemark(index)} disabled={generatingRemarkIndex === index} className=\"p-1 text-purple-600 bg-purple-100 rounded hover:bg-purple-200 disabled:opacity-50\" aria-label=\"Generate remark with AI\">\r\n                                                        {generatingRemarkIndex === index ? (<div className=\"w-4 h-4 border-2 border-purple-300 border-t-purple-600 rounded-full animate-spin\"></div>) : (<AIIcon className=\"w-4 h-4\" />)}\r\n                                                    </button>\r\n                                                )}\r\n                                                {(!canEditScores || isLocked) && <LockIcon className=\"w-4 h-4 text-gray-400 flex-shrink-0\" />}\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                )\r\n                            })}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8\">\r\n                    <div><SectionHeader title=\"Skills & Behaviour\" /><table className=\"w-full text-sm\"><tbody>{SKILL_BEHAVIOUR_DOMAINS.map(skill => (<tr key={skill}><td className=\"py-1 text-gray-800\">{skill}</td><td className=\"w-20\"><RatingSelector disabled={!canEditGeneralSections || isLocked} value={skills[skill] || ''} onChange={val => setSkills(p => ({ ...p, [skill]: val }))} options={RATING_OPTIONS} /></td></tr>))}</tbody></table></div>\r\n                    <div><SectionHeader title=\"Psychomotor Skills\" /><table className=\"w-full text-sm\"><tbody>{PSYCHOMOTOR_SKILLS.map(skill => (<tr key={skill}><td className=\"py-1 text-gray-800\">{skill}</td><td className=\"w-20\"><RatingSelector disabled={!canEditGeneralSections || isLocked} value={psychomotor[skill] || ''} onChange={val => setPsychomotor(p => ({ ...p, [skill]: val }))} options={RATING_OPTIONS} /></td></tr>))}</tbody></table></div>\r\n                </div>\r\n\r\n                <SectionHeader title=\"Attendance Record\" />\r\n                <div className=\"grid grid-cols-4 gap-4 text-sm\">\r\n                    {Object.entries(attendance).map(([key, value]) => (<div key={key}><label className=\"capitalize text-xs text-gray-700\">{key.replace(/([A-Z])/g, ' $1')}</label><input type=\"number\" value={value} disabled={!canEditGeneralSections || isLocked} onChange={e => setAttendance(p => ({ ...p, [key]: e.target.value }))} className=\"w-full p-2 text-sm border border-gray-300 rounded bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\" /></div>))}\r\n                </div>\r\n\r\n                <div className=\"mt-6 space-y-4\">\r\n                    <div><label className=\"font-semibold text-sm text-gray-900\">Teacher's General Comment:</label><textarea value={teacherComment} disabled={!canEditGeneralSections || isLocked} onChange={e => setTeacherComment(e.target.value)} rows={3} className=\"w-full mt-1 p-2 border border-gray-300 rounded-md text-sm bg-white text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed\"></textarea></div>\r\n                    <div><label className=\"font-semibold text-sm text-gray-900\">Principal's Comment:</label><textarea value={principalComment} onChange={e => setPrincipalComment(e.target.value)} disabled={!isAdmin || isLocked} placeholder={isAdmin ? \"Enter principal's comment...\" : \"Principal's comment (read-only)\"} rows={2} className={`w-full mt-1 p-2 border border-gray-300 rounded-md text-sm text-gray-900 disabled:bg-gray-100 disabled:cursor-not-allowed ${isAdmin ? 'bg-white' : 'bg-gray-100'}`}></textarea></div>\r\n                </div>\r\n\r\n                <div className=\"pt-6 mt-4 border-t\">\r\n                    {isLocked ? (\r\n                        <div className=\"text-center p-4 bg-purple-100 rounded-lg\">\r\n                            <p className=\"font-bold text-purple-800\">This report has been {existingReport?.status} and is locked.</p>\r\n                            <p className=\"text-sm text-purple-700\">Please contact an administrator if changes are required.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <button type=\"button\" onClick={() => handleSave('Draft')} className=\"w-full py-3 bg-gray-200 text-gray-800 font-bold rounded-lg shadow-sm hover:bg-gray-300 transition-colors\">Save Draft</button>\r\n                            <button type=\"button\" onClick={() => handleSave('Submitted')} className=\"w-full py-3 bg-purple-600 text-white font-bold rounded-lg shadow-md hover:bg-purple-700 transition-colors\">Submit for Review</button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <ConfirmationModal\r\n                isOpen={isSubmitModalOpen}\r\n                onClose={() => setIsSubmitModalOpen(false)}\r\n                onConfirm={() => {\r\n                    processSave('Submitted');\r\n                    setIsSubmitModalOpen(false);\r\n                }}\r\n                title=\"Submit Report Card\"\r\n                message=\"Are you sure you want to submit this for review? You will not be able to edit it after submission.\"\r\n                confirmText=\"Submit\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ReportCardInputScreen;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}