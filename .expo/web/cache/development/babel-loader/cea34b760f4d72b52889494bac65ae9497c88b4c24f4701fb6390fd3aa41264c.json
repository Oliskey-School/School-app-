{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\shared\\\\NotificationsScreen.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { supabase } from '../../lib/supabase';\nimport { useProfile } from '../../context/ProfileContext';\nimport { mockStudents, mockFees } from '../../data';\nimport { NOTIFICATION_CATEGORY_CONFIG } from '../../constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst formatDistanceToNow = isoDate => {\n  const date = new Date(isoDate);\n  const now = new Date();\n  const seconds = Math.round((now.getTime() - date.getTime()) / 1000);\n  const minutes = Math.round(seconds / 60);\n  const hours = Math.round(minutes / 60);\n  const days = Math.round(hours / 24);\n  if (seconds < 60) return `${seconds}s ago`;\n  if (minutes < 60) return `${minutes}m ago`;\n  if (hours < 24) return `${hours}h ago`;\n  if (days === 1) return 'Yesterday';\n  return date.toLocaleDateString('en-GB', {\n    day: '2-digit',\n    month: 'short'\n  });\n};\nconst NotificationsScreen = ({\n  userType,\n  navigateTo\n}) => {\n  const {\n    profile\n  } = useProfile();\n  const [notifications, setNotifications] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const fetchNotifications = async () => {\n    try {\n      if (!profile?.id) return;\n      let query = supabase.from('notifications').select('*').order('created_at', {\n        ascending: false\n      });\n      const {\n        data,\n        error\n      } = await query;\n      if (error) throw error;\n      const filtered = (data || []).filter(n => {\n        const aud = n.audience || [];\n        const isForRole = aud.includes('all') || aud.includes(userType);\n        const isForUser = n.recipient_id === profile.id || !n.recipient_id;\n        return isForRole && isForUser;\n      }).map(n => ({\n        id: n.id,\n        title: n.title,\n        summary: n.message,\n        category: n.type,\n        audience: n.audience,\n        is_read: n.is_read || false,\n        timestamp: n.created_at,\n        student_id: n.related_entity_id,\n        link: n.link\n      }));\n      setNotifications(filtered);\n    } catch (err) {\n      console.error('Error fetching notifications:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchNotifications();\n    const channel = supabase.channel('public:notifications').on('postgres_changes', {\n      event: '*',\n      schema: 'public',\n      table: 'notifications'\n    }, payload => {\n      fetchNotifications();\n    }).subscribe();\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [profile, userType]);\n  const markAsRead = async notificationId => {\n    setNotifications(prev => prev.map(n => n.id === notificationId ? Object.assign({}, n, {\n      is_read: true\n    }) : n));\n    try {\n      const {\n        error\n      } = await supabase.from('notifications').update({\n        is_read: true\n      }).eq('id', notificationId);\n      if (error) throw error;\n    } catch (err) {\n      console.error('Error marking as read:', err);\n    }\n  };\n  const handleNotificationClick = async notification => {\n    if (!notification.is_read) {\n      await markAsRead(notification.id);\n    }\n    if (userType === 'parent') {\n      switch (notification.category) {\n        case 'Fees':\n          const feeStudentInfo = mockFees.find(f => f.id === notification.student_id);\n          if (feeStudentInfo) {\n            navigateTo('feeStatus', 'Fee Status', {\n              student: feeStudentInfo\n            });\n          } else navigateTo('feeStatus', 'Fee Status', {});\n          break;\n        case 'Attendance':\n          const student = mockStudents.find(s => s.id === notification.student_id);\n          if (student) {\n            navigateTo('childDetail', student.name, {\n              student,\n              initialTab: 'attendance'\n            });\n          }\n          break;\n        case 'Event':\n          navigateTo('calendar', 'School Calendar', {});\n          break;\n        case 'Message':\n          toast(\"Navigating to messages...\", {\n            icon: '✉️'\n          });\n          break;\n        default:\n          break;\n      }\n    } else if (userType === 'admin') {\n      switch (notification.category) {\n        case 'Fees':\n          navigateTo('feeManagement', 'Fee Management', {});\n          break;\n        case 'System':\n          navigateTo('systemSettings', 'System Settings', {});\n          break;\n        case 'Message':\n          navigateTo('messages', 'Messages', {});\n          break;\n        default:\n          break;\n      }\n    }\n  };\n  return _jsxDEV(\"div\", {\n    className: \"flex flex-col h-full bg-gray-100\",\n    children: _jsxDEV(\"main\", {\n      className: \"flex-grow p-4 space-y-3 overflow-y-auto\",\n      children: loading ? _jsxDEV(\"div\", {\n        className: \"flex justify-center pt-10\",\n        children: _jsxDEV(\"div\", {\n          className: \"animate-spin h-8 w-8 border-4 border-indigo-500 rounded-full border-t-transparent\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 54\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 11\n      }, this) : notifications.length > 0 ? notifications.map(notification => {\n        const config = NOTIFICATION_CATEGORY_CONFIG[notification.category] || NOTIFICATION_CATEGORY_CONFIG['System'];\n        const Icon = config.icon;\n        return _jsxDEV(\"button\", {\n          onClick: () => handleNotificationClick(notification),\n          className: `w-full text-left bg-white rounded-xl shadow-sm p-4 flex items-start space-x-4 relative transition-all hover:shadow-md hover:ring-2 hover:ring-gray-200 ${notification.is_read ? 'opacity-70' : ''}`,\n          children: [!notification.is_read && _jsxDEV(\"div\", {\n            className: \"absolute top-3 right-3 h-2.5 w-2.5 rounded-full bg-green-500 animate-pulse\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 19\n          }, this), _jsxDEV(\"div\", {\n            className: `flex-shrink-0 w-12 h-12 rounded-lg flex items-center justify-center ${config.bg}`,\n            children: _jsxDEV(Icon, {\n              className: `w-6 h-6 ${config.color}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 17\n          }, this), _jsxDEV(\"div\", {\n            className: \"flex-grow\",\n            children: [_jsxDEV(\"div\", {\n              className: \"flex justify-between items-center\",\n              children: [_jsxDEV(\"p\", {\n                className: `font-bold ${notification.is_read ? 'text-gray-700' : 'text-gray-900'}`,\n                children: notification.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 21\n              }, this), _jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500 flex-shrink-0 ml-2\",\n                children: formatDistanceToNow(notification.timestamp)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 19\n            }, this), _jsxDEV(\"p\", {\n              className: `text-sm mt-1 ${notification.is_read ? 'text-gray-600' : 'text-gray-800'}`,\n              children: notification.summary\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 17\n          }, this)]\n        }, notification.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 15\n        }, this);\n      }) : _jsxDEV(\"div\", {\n        className: \"text-center py-16\",\n        children: _jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: \"No new notifications.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 5\n  }, this);\n};\nexport default NotificationsScreen;","map":{"version":3,"names":["React","useState","useEffect","toast","supabase","useProfile","mockStudents","mockFees","NOTIFICATION_CATEGORY_CONFIG","jsxDEV","_jsxDEV","formatDistanceToNow","isoDate","date","Date","now","seconds","Math","round","getTime","minutes","hours","days","toLocaleDateString","day","month","NotificationsScreen","userType","navigateTo","profile","notifications","setNotifications","loading","setLoading","fetchNotifications","id","query","from","select","order","ascending","data","error","filtered","filter","n","aud","audience","isForRole","includes","isForUser","recipient_id","map","title","summary","message","category","type","is_read","timestamp","created_at","student_id","related_entity_id","link","err","console","channel","on","event","schema","table","payload","subscribe","removeChannel","markAsRead","notificationId","prev","Object","assign","update","eq","handleNotificationClick","notification","feeStudentInfo","find","f","student","s","name","initialTab","icon","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","config","Icon","onClick","bg","color"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/shared/NotificationsScreen.tsx"],"sourcesContent":["import React, { useMemo, useState, useEffect } from 'react';\r\nimport { toast } from 'react-hot-toast';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { useProfile } from '../../context/ProfileContext';\r\n// import { mockNotifications } from '../../data'; // Mock removed\r\nimport { mockStudents, mockFees } from '../../data'; // Keeping these for navigation mapping for now\r\nimport { NOTIFICATION_CATEGORY_CONFIG } from '../../constants';\r\n// import { Notification } from '../../types';\r\n\r\n// Defining local interface to match DB schema if needed, or use types\r\ninterface Notification {\r\n  id: number;\r\n  title: string;\r\n  summary: string;\r\n  category: 'System' | 'Message' | 'Alert' | 'Event' | 'Assignment' | 'Grades' | 'Attendance' | 'Fees';\r\n  audience: string[];\r\n  is_read: boolean;\r\n  timestamp: string;\r\n  student_id?: number;\r\n  link?: string;\r\n}\r\n\r\nconst formatDistanceToNow = (isoDate: string): string => {\r\n  const date = new Date(isoDate);\r\n  const now = new Date();\r\n  const seconds = Math.round((now.getTime() - date.getTime()) / 1000);\r\n  const minutes = Math.round(seconds / 60);\r\n  const hours = Math.round(minutes / 60);\r\n  const days = Math.round(hours / 24);\r\n\r\n  if (seconds < 60) return `${seconds}s ago`;\r\n  if (minutes < 60) return `${minutes}m ago`;\r\n  if (hours < 24) return `${hours}h ago`;\r\n  if (days === 1) return 'Yesterday';\r\n  return date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short' });\r\n};\r\n\r\ninterface NotificationsScreenProps {\r\n  userType: 'admin' | 'parent' | 'student' | 'teacher';\r\n  navigateTo: (view: string, title: string, props?: any) => void;\r\n}\r\n\r\nconst NotificationsScreen: React.FC<NotificationsScreenProps> = ({ userType, navigateTo }) => {\r\n  const { profile } = useProfile();\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchNotifications = async () => {\r\n    try {\r\n      if (!profile?.id) return; // Wait for profile\r\n\r\n      // Fetch notifications where audience contains userType OR specific user_id match\r\n      // Note: Logic for 'audience' array check in Supabase might need specific filter or RLS\r\n      // For now, simpler query: fetch all for user_id match (if we have a user_notifications join) \r\n      // OR fallback to simple \"audience includes userType\" checks if stored as JSON/Array.\r\n\r\n      let query = supabase\r\n        .from('notifications')\r\n        .select('*')\r\n        .order('created_at', { ascending: false });\r\n\r\n      // Ideally, backend should handle \"For Me\" logic via RLS. \r\n      // We will fetch widely and filter locally if complex, or ideally rely on 'recipient_id' if it exists.\r\n      // Assuming 'audience' is a text array or JSONB in DB.\r\n\r\n      // For this implementation, we'll assume valid RLS or simple fetching.\r\n      const { data, error } = await query;\r\n\r\n      if (error) throw error;\r\n\r\n      // Filter locally for now to match strict permissions if DB RLS isn't perfect\r\n      const filtered = (data || []).filter((n: any) => {\r\n        const aud = n.audience || []; // Assuming audience is array string in DB\r\n        const isForRole = aud.includes('all') || aud.includes(userType);\r\n        const isForUser = n.recipient_id === profile.id || !n.recipient_id; // If recipient_id exists, it must match\r\n        return isForRole && isForUser;\r\n      }).map((n: any) => ({\r\n        id: n.id,\r\n        title: n.title,\r\n        summary: n.message, // Mapping 'message' col to 'summary' prop\r\n        category: n.type,   // Mapping 'type' col to 'category' prop\r\n        audience: n.audience,\r\n        is_read: n.is_read || false,\r\n        timestamp: n.created_at,\r\n        student_id: n.related_entity_id, // flexible mapping\r\n        link: n.link\r\n      }));\r\n\r\n      setNotifications(filtered);\r\n\r\n    } catch (err) {\r\n      console.error('Error fetching notifications:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchNotifications();\r\n\r\n    const channel = supabase.channel('public:notifications')\r\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'notifications' }, (payload) => {\r\n        fetchNotifications();\r\n      })\r\n      .subscribe();\r\n\r\n    return () => { supabase.removeChannel(channel); }\r\n  }, [profile, userType]);\r\n\r\n\r\n  const markAsRead = async (notificationId: number) => {\r\n    // Optimistic update\r\n    setNotifications(prev => prev.map(n => n.id === notificationId ? { ...n, is_read: true } : n));\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('notifications')\r\n        .update({ is_read: true })\r\n        .eq('id', notificationId);\r\n\r\n      if (error) throw error;\r\n    } catch (err) {\r\n      console.error('Error marking as read:', err);\r\n    }\r\n  };\r\n\r\n  const handleNotificationClick = async (notification: Notification) => {\r\n    if (!notification.is_read) {\r\n      await markAsRead(notification.id);\r\n    }\r\n\r\n    // Parent-specific navigation logic\r\n    if (userType === 'parent') {\r\n      switch (notification.category) {\r\n        case 'Fees':\r\n          const feeStudentInfo = mockFees.find(f => f.id === notification.student_id);\r\n          if (feeStudentInfo) {\r\n            navigateTo('feeStatus', 'Fee Status', { student: feeStudentInfo });\r\n          }\r\n          // Fallback if no mock data match\r\n          else navigateTo('feeStatus', 'Fee Status', {});\r\n          break;\r\n        case 'Attendance':\r\n          const student = mockStudents.find(s => s.id === notification.student_id);\r\n          if (student) {\r\n            navigateTo('childDetail', student.name, { student, initialTab: 'attendance' });\r\n          }\r\n          break;\r\n        case 'Event':\r\n          navigateTo('calendar', 'School Calendar', {});\r\n          break;\r\n        case 'Message':\r\n          toast(\"Navigating to messages...\", { icon: '✉️' });\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    } else if (userType === 'admin') {\r\n      // Admin navigation logic\r\n      switch (notification.category) {\r\n        case 'Fees': navigateTo('feeManagement', 'Fee Management', {}); break;\r\n        case 'System': navigateTo('systemSettings', 'System Settings', {}); break;\r\n        case 'Message': navigateTo('messages', 'Messages', {}); break;\r\n        default: break;\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-gray-100\">\r\n      <main className=\"flex-grow p-4 space-y-3 overflow-y-auto\">\r\n        {loading ? (\r\n          <div className=\"flex justify-center pt-10\"><div className=\"animate-spin h-8 w-8 border-4 border-indigo-500 rounded-full border-t-transparent\"></div></div>\r\n        ) : notifications.length > 0 ? (\r\n          notifications.map(notification => {\r\n            const config = NOTIFICATION_CATEGORY_CONFIG[notification.category] || NOTIFICATION_CATEGORY_CONFIG['System'];\r\n            const Icon = config.icon;\r\n            return (\r\n              <button\r\n                key={notification.id}\r\n                onClick={() => handleNotificationClick(notification)}\r\n                className={`w-full text-left bg-white rounded-xl shadow-sm p-4 flex items-start space-x-4 relative transition-all hover:shadow-md hover:ring-2 hover:ring-gray-200 ${notification.is_read ? 'opacity-70' : ''}`}\r\n              >\r\n                {!notification.is_read && (\r\n                  <div className=\"absolute top-3 right-3 h-2.5 w-2.5 rounded-full bg-green-500 animate-pulse\"></div>\r\n                )}\r\n                <div className={`flex-shrink-0 w-12 h-12 rounded-lg flex items-center justify-center ${config.bg}`}>\r\n                  <Icon className={`w-6 h-6 ${config.color}`} />\r\n                </div>\r\n                <div className=\"flex-grow\">\r\n                  <div className=\"flex justify-between items-center\">\r\n                    <p className={`font-bold ${notification.is_read ? 'text-gray-700' : 'text-gray-900'}`}>{notification.title}</p>\r\n                    <p className=\"text-xs text-gray-500 flex-shrink-0 ml-2\">\r\n                      {formatDistanceToNow(notification.timestamp)}\r\n                    </p>\r\n                  </div>\r\n                  <p className={`text-sm mt-1 ${notification.is_read ? 'text-gray-600' : 'text-gray-800'}`}>{notification.summary}</p>\r\n                </div>\r\n              </button>\r\n            )\r\n          })\r\n        ) : (\r\n          <div className=\"text-center py-16\">\r\n            <p className=\"text-gray-500\">No new notifications.</p>\r\n          </div>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\nexport default NotificationsScreen;"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}