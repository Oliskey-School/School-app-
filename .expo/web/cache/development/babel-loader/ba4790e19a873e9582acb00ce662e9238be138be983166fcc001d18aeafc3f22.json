{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\teacher\\\\AttendanceTrackSelector.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '../ui/card';\nimport { Button } from '../ui/button';\nimport { Badge } from '../ui/badge';\nimport { useToast } from '../../hooks/use-toast';\nimport { supabase } from '../../lib/supabase';\nimport { BookOpen, AlertCircle, Save, CheckCircle } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AttendanceTrackSelector({\n  teacherId,\n  classId,\n  onCurriculumChange\n}) {\n  const [selectedCurriculum, setSelectedCurriculum] = useState('Nigerian');\n  const [students, setStudents] = useState([]);\n  const [attendance, setAttendance] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const {\n    toast\n  } = useToast();\n  useEffect(() => {\n    fetchStudents();\n  }, [classId, selectedCurriculum]);\n  const fetchStudents = async () => {\n    setLoading(true);\n    try {\n      const {\n        data: curriculum\n      } = await supabase.from('curricula').select('id').ilike('name', `%${selectedCurriculum}%`).single();\n      if (!curriculum) {\n        console.warn('Curriculum not found:', selectedCurriculum);\n        setStudents([]);\n        setLoading(false);\n        return;\n      }\n      const {\n        data: tracks,\n        error: tracksError\n      } = await supabase.from('academic_tracks').select('student_id').eq('curriculum_id', curriculum.id).eq('status', 'Active');\n      if (tracksError) {\n        console.error('Error fetching tracks:', tracksError);\n        setStudents([]);\n        setLoading(false);\n        return;\n      }\n      if (!tracks || tracks.length === 0) {\n        console.log('No students enrolled in this curriculum');\n        setStudents([]);\n        setLoading(false);\n        return;\n      }\n      const studentIds = tracks.map(t => t.student_id);\n      let {\n        data: students,\n        error: studentsError\n      } = await supabase.from('students').select('*').in('id', studentIds);\n      if (studentsError) {\n        console.error('Error fetching students:', studentsError);\n        toast({\n          title: 'Error Loading Students',\n          description: studentsError.message,\n          variant: 'destructive'\n        });\n        setStudents([]);\n        setLoading(false);\n        return;\n      }\n      if (classId && students) {\n        const classFiltered = students.filter(s => s.class_id === classId);\n        if (classFiltered.length === 0) {\n          const {\n            data: classInfo\n          } = await supabase.from('classes').select('grade, section').eq('id', classId).single();\n          if (classInfo) {\n            students = students.filter(s => s.grade === classInfo.grade && s.section === classInfo.section);\n          }\n        } else {\n          students = classFiltered;\n        }\n      }\n      setStudents(students || []);\n      console.log(`Loaded ${students?.length || 0} students for ${selectedCurriculum} curriculum`);\n      const initialAttendance = {};\n      students?.forEach(student => {\n        initialAttendance[student.id] = 'Present';\n      });\n      setAttendance(initialAttendance);\n    } catch (error) {\n      console.error('Error fetching students:', error);\n      toast({\n        title: 'Error Loading Students',\n        description: error.message || 'Failed to load students',\n        variant: 'destructive'\n      });\n      setStudents([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleCurriculumSwitch = curriculum => {\n    if (Object.keys(attendance).some(key => attendance[parseInt(key)] !== 'Present')) {\n      if (!confirm('You have unsaved changes. Switching curriculum will discard them. Continue?')) {\n        return;\n      }\n    }\n    setSelectedCurriculum(curriculum);\n    onCurriculumChange?.(curriculum);\n  };\n  const handleAttendanceChange = (studentId, status) => {\n    setAttendance(prev => Object.assign({}, prev, {\n      [studentId]: status\n    }));\n  };\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      const {\n        data: classInfo\n      } = await supabase.from('classes').select('grade, section, subject').eq('id', classId).single();\n      const className = classInfo ? `${classInfo.grade}${classInfo.section ? ` ${classInfo.section}` : ''}${classInfo.subject ? ` - ${classInfo.subject}` : ''}` : `Class ${classId}`;\n      const attendanceRecords = Object.entries(attendance).map(([studentId, status]) => ({\n        student_id: parseInt(studentId),\n        date: new Date().toISOString().split('T')[0],\n        status,\n        class_name: className\n      }));\n      const {\n        error\n      } = await supabase.from('student_attendance').upsert(attendanceRecords, {\n        onConflict: 'student_id,date'\n      });\n      if (error) throw error;\n      toast({\n        title: 'Attendance Saved',\n        description: `${selectedCurriculum} curriculum attendance has been recorded for ${className}.`\n      });\n    } catch (error) {\n      console.error('Attendance save error:', error);\n      toast({\n        title: 'Save Failed',\n        description: error.message || 'Failed to save attendance',\n        variant: 'destructive'\n      });\n    } finally {\n      setSaving(false);\n    }\n  };\n  const presentCount = Object.values(attendance).filter(s => s === 'Present').length;\n  const absentCount = Object.values(attendance).filter(s => s === 'Absent').length;\n  const lateCount = Object.values(attendance).filter(s => s === 'Late').length;\n  return _jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [_jsxDEV(Card, {\n      children: [_jsxDEV(CardHeader, {\n        children: _jsxDEV(CardTitle, {\n          className: \"flex items-center gap-2\",\n          children: [_jsxDEV(BookOpen, {\n            className: \"h-5 w-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 25\n          }, this), \"Select Curriculum Track\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }, this), _jsxDEV(CardContent, {\n        className: \"space-y-4\",\n        children: [_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded\",\n          children: [_jsxDEV(AlertCircle, {\n            className: \"h-5 w-5 text-amber-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 25\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-sm text-amber-900\",\n            children: [_jsxDEV(\"strong\", {\n              children: \"Important:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 29\n            }, this), \" Attendance is recorded separately for Nigerian and British curriculum students. Make sure to select the correct track before marking.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-4\",\n          children: [_jsxDEV(Card, {\n            className: `cursor-pointer transition-all ${selectedCurriculum === 'Nigerian' ? 'border-green-500 border-2 bg-green-50' : 'hover:border-gray-400'}`,\n            onClick: () => handleCurriculumSwitch('Nigerian'),\n            children: _jsxDEV(CardContent, {\n              className: \"p-6 text-center\",\n              children: [_jsxDEV(\"h3\", {\n                className: \"text-xl font-bold mb-2\",\n                children: \"\\uD83C\\uDDF3\\uD83C\\uDDEC Nigerian Track\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 33\n              }, this), _jsxDEV(\"p\", {\n                className: \"text-sm text-gray-600\",\n                children: \"WAEC/NECO Students\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 33\n              }, this), _jsxDEV(Badge, {\n                className: \"mt-3 bg-green-600 text-white\",\n                children: [students.length, \" Student\", students.length !== 1 ? 's' : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 25\n          }, this), _jsxDEV(Card, {\n            className: `cursor-pointer transition-all ${selectedCurriculum === 'British' ? 'border-blue-500 border-2 bg-blue-50' : 'hover:border-gray-400'}`,\n            onClick: () => handleCurriculumSwitch('British'),\n            children: _jsxDEV(CardContent, {\n              className: \"p-6 text-center\",\n              children: [_jsxDEV(\"h3\", {\n                className: \"text-xl font-bold mb-2\",\n                children: \"\\uD83C\\uDDEC\\uD83C\\uDDE7 British Track\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 33\n              }, this), _jsxDEV(\"p\", {\n                className: \"text-sm text-gray-600\",\n                children: \"Cambridge/IGCSE Students\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 33\n              }, this), _jsxDEV(Badge, {\n                className: \"mt-3 bg-blue-600 text-white\",\n                children: [students.length, \" Student\", students.length !== 1 ? 's' : '']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      className: \"grid grid-cols-3 gap-4\",\n      children: [_jsxDEV(Card, {\n        children: _jsxDEV(CardContent, {\n          className: \"p-4 text-center\",\n          children: [_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600\",\n            children: \"Present\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 25\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-green-600\",\n            children: presentCount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 17\n      }, this), _jsxDEV(Card, {\n        children: _jsxDEV(CardContent, {\n          className: \"p-4 text-center\",\n          children: [_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600\",\n            children: \"Absent\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 25\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-red-600\",\n            children: absentCount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }, this), _jsxDEV(Card, {\n        children: _jsxDEV(CardContent, {\n          className: \"p-4 text-center\",\n          children: [_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600\",\n            children: \"Late\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 25\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-amber-600\",\n            children: lateCount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 13\n    }, this), _jsxDEV(Card, {\n      children: [_jsxDEV(CardHeader, {\n        children: _jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [_jsxDEV(CardTitle, {\n            children: [\"Mark Attendance - \", selectedCurriculum, \" Track\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 25\n          }, this), _jsxDEV(Badge, {\n            variant: \"outline\",\n            className: selectedCurriculum === 'Nigerian' ? 'border-green-500 text-green-700' : 'border-blue-500 text-blue-700',\n            children: selectedCurriculum === 'Nigerian' ? 'ðŸ‡³ðŸ‡¬ Nigerian' : 'ðŸ‡¬ðŸ‡§ British'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 17\n      }, this), _jsxDEV(CardContent, {\n        children: [loading ? _jsxDEV(\"p\", {\n          className: \"text-center py-8 text-gray-500\",\n          children: \"Loading students...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 25\n        }, this) : students.length === 0 ? _jsxDEV(\"div\", {\n          className: \"text-center py-8\",\n          children: [_jsxDEV(AlertCircle, {\n            className: \"h-12 w-12 text-gray-400 mx-auto mb-3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 29\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-gray-600\",\n            children: [\"No students enrolled in \", selectedCurriculum, \" curriculum for this class.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 25\n        }, this) : _jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: students.map(student => _jsxDEV(\"div\", {\n            className: \"flex items-center justify-between p-3 border rounded hover:bg-gray-50\",\n            children: [_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3\",\n              children: [_jsxDEV(\"div\", {\n                className: \"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\",\n                children: _jsxDEV(\"span\", {\n                  className: \"text-sm font-semibold\",\n                  children: [student.first_name?.[0], student.last_name?.[0]]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 299,\n                columnNumber: 41\n              }, this), _jsxDEV(\"div\", {\n                children: [_jsxDEV(\"p\", {\n                  className: \"font-semibold\",\n                  children: [student.first_name, \" \", student.last_name]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 45\n                }, this), _jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-600\",\n                  children: student.admission_number || `S-${student.id}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 37\n            }, this), _jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [_jsxDEV(Button, {\n                size: \"sm\",\n                variant: attendance[student.id] === 'Present' ? 'default' : 'outline',\n                onClick: () => handleAttendanceChange(student.id, 'Present'),\n                className: attendance[student.id] === 'Present' ? 'bg-green-600 hover:bg-green-700' : '',\n                children: [_jsxDEV(CheckCircle, {\n                  className: \"h-4 w-4 mr-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 45\n                }, this), \"Present\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 311,\n                columnNumber: 41\n              }, this), _jsxDEV(Button, {\n                size: \"sm\",\n                variant: attendance[student.id] === 'Absent' ? 'default' : 'outline',\n                onClick: () => handleAttendanceChange(student.id, 'Absent'),\n                className: attendance[student.id] === 'Absent' ? 'bg-red-600 hover:bg-red-700' : '',\n                children: \"Absent\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 41\n              }, this), _jsxDEV(Button, {\n                size: \"sm\",\n                variant: attendance[student.id] === 'Late' ? 'default' : 'outline',\n                onClick: () => handleAttendanceChange(student.id, 'Late'),\n                className: attendance[student.id] === 'Late' ? 'bg-amber-600 hover:bg-amber-700' : '',\n                children: \"Late\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 37\n            }, this)]\n          }, student.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 25\n        }, this), students.length > 0 && _jsxDEV(\"div\", {\n          className: \"mt-6 flex justify-end\",\n          children: _jsxDEV(Button, {\n            onClick: handleSave,\n            disabled: saving,\n            size: \"lg\",\n            children: [_jsxDEV(Save, {\n              className: \"h-4 w-4 mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 33\n            }, this), saving ? 'Saving...' : 'Save Attendance']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 9\n  }, this);\n}","map":{"version":3,"names":["React","useState","useEffect","Card","CardContent","CardHeader","CardTitle","Button","Badge","useToast","supabase","BookOpen","AlertCircle","Save","CheckCircle","jsxDEV","_jsxDEV","AttendanceTrackSelector","teacherId","classId","onCurriculumChange","selectedCurriculum","setSelectedCurriculum","students","setStudents","attendance","setAttendance","loading","setLoading","saving","setSaving","toast","fetchStudents","data","curriculum","from","select","ilike","single","console","warn","tracks","error","tracksError","eq","id","length","log","studentIds","map","t","student_id","studentsError","in","title","description","message","variant","classFiltered","filter","s","class_id","classInfo","grade","section","initialAttendance","forEach","student","handleCurriculumSwitch","Object","keys","some","key","parseInt","confirm","handleAttendanceChange","studentId","status","prev","assign","handleSave","className","subject","attendanceRecords","entries","date","Date","toISOString","split","class_name","upsert","onConflict","presentCount","values","absentCount","lateCount","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","first_name","last_name","admission_number","size","disabled"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/teacher/AttendanceTrackSelector.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '../ui/card';\r\nimport { Button } from '../ui/button';\r\nimport { Badge } from '../ui/badge';\r\nimport { useToast } from '../../hooks/use-toast';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { BookOpen, AlertCircle, Save, CheckCircle } from 'lucide-react';\r\n\r\ninterface AttendanceTrackSelectorProps {\r\n    teacherId: number;\r\n    classId: number;\r\n    onCurriculumChange?: (curriculum: 'Nigerian' | 'British') => void;\r\n}\r\n\r\nexport default function AttendanceTrackSelector({\r\n    teacherId,\r\n    classId,\r\n    onCurriculumChange\r\n}: AttendanceTrackSelectorProps) {\r\n    const [selectedCurriculum, setSelectedCurriculum] = useState<'Nigerian' | 'British'>('Nigerian');\r\n    const [students, setStudents] = useState<any[]>([]);\r\n    const [attendance, setAttendance] = useState<{ [key: number]: 'Present' | 'Absent' | 'Late' }>({});\r\n    const [loading, setLoading] = useState(false);\r\n    const [saving, setSaving] = useState(false);\r\n    const { toast } = useToast();\r\n\r\n    useEffect(() => {\r\n        fetchStudents();\r\n    }, [classId, selectedCurriculum]);\r\n\r\n    const fetchStudents = async () => {\r\n        setLoading(true);\r\n        try {\r\n            // Get curriculum ID for the selected curriculum\r\n            const { data: curriculum } = await supabase\r\n                .from('curricula')\r\n                .select('id')\r\n                .ilike('name', `%${selectedCurriculum}%`)\r\n                .single();\r\n\r\n            if (!curriculum) {\r\n                console.warn('Curriculum not found:', selectedCurriculum);\r\n                setStudents([]);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Fetch students enrolled in this curriculum\r\n            const { data: tracks, error: tracksError } = await supabase\r\n                .from('academic_tracks')\r\n                .select('student_id')\r\n                .eq('curriculum_id', curriculum.id)\r\n                .eq('status', 'Active');\r\n\r\n            if (tracksError) {\r\n                console.error('Error fetching tracks:', tracksError);\r\n                setStudents([]);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            if (!tracks || tracks.length === 0) {\r\n                console.log('No students enrolled in this curriculum');\r\n                setStudents([]);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            const studentIds = tracks.map(t => t.student_id);\r\n\r\n            // Fetch student details\r\n            let { data: students, error: studentsError } = await supabase\r\n                .from('students')\r\n                .select('*')\r\n                .in('id', studentIds);\r\n\r\n            if (studentsError) {\r\n                console.error('Error fetching students:', studentsError);\r\n                toast({\r\n                    title: 'Error Loading Students',\r\n                    description: studentsError.message,\r\n                    variant: 'destructive'\r\n                });\r\n                setStudents([]);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            // Filter by class if classId is provided\r\n            if (classId && students) {\r\n                // First try filtering by class_id if it exists\r\n                const classFiltered = students.filter(s => s.class_id === classId);\r\n\r\n                // If no results with class_id, try getting class info and filtering by grade/section\r\n                if (classFiltered.length === 0) {\r\n                    const { data: classInfo } = await supabase\r\n                        .from('classes')\r\n                        .select('grade, section')\r\n                        .eq('id', classId)\r\n                        .single();\r\n\r\n                    if (classInfo) {\r\n                        students = students.filter(s =>\r\n                            s.grade === classInfo.grade && s.section === classInfo.section\r\n                        );\r\n                    }\r\n                } else {\r\n                    students = classFiltered;\r\n                }\r\n            }\r\n\r\n            setStudents(students || []);\r\n            console.log(`Loaded ${students?.length || 0} students for ${selectedCurriculum} curriculum`);\r\n\r\n            // Initialize attendance state\r\n            const initialAttendance: { [key: number]: 'Present' | 'Absent' | 'Late' } = {};\r\n            students?.forEach(student => {\r\n                initialAttendance[student.id] = 'Present';\r\n            });\r\n            setAttendance(initialAttendance);\r\n        } catch (error: any) {\r\n            console.error('Error fetching students:', error);\r\n            toast({\r\n                title: 'Error Loading Students',\r\n                description: error.message || 'Failed to load students',\r\n                variant: 'destructive'\r\n            });\r\n            setStudents([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleCurriculumSwitch = (curriculum: 'Nigerian' | 'British') => {\r\n        if (Object.keys(attendance).some(key => attendance[parseInt(key)] !== 'Present')) {\r\n            if (!confirm('You have unsaved changes. Switching curriculum will discard them. Continue?')) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        setSelectedCurriculum(curriculum);\r\n        onCurriculumChange?.(curriculum);\r\n    };\r\n\r\n    const handleAttendanceChange = (studentId: number, status: 'Present' | 'Absent' | 'Late') => {\r\n        setAttendance(prev => ({\r\n            ...prev,\r\n            [studentId]: status\r\n        }));\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        setSaving(true);\r\n        try {\r\n            // Get class name for the attendance record\r\n            const { data: classInfo } = await supabase\r\n                .from('classes')\r\n                .select('grade, section, subject')\r\n                .eq('id', classId)\r\n                .single();\r\n\r\n            const className = classInfo\r\n                ? `${classInfo.grade}${classInfo.section ? ` ${classInfo.section}` : ''}${classInfo.subject ? ` - ${classInfo.subject}` : ''}`\r\n                : `Class ${classId}`;\r\n\r\n            const attendanceRecords = Object.entries(attendance).map(([studentId, status]) => ({\r\n                student_id: parseInt(studentId),\r\n                date: new Date().toISOString().split('T')[0],\r\n                status,\r\n                class_name: className,\r\n            }));\r\n\r\n            const { error } = await supabase\r\n                .from('student_attendance')\r\n                .upsert(attendanceRecords, {\r\n                    onConflict: 'student_id,date'\r\n                });\r\n\r\n            if (error) throw error;\r\n\r\n            toast({\r\n                title: 'Attendance Saved',\r\n                description: `${selectedCurriculum} curriculum attendance has been recorded for ${className}.`,\r\n            });\r\n        } catch (error: any) {\r\n            console.error('Attendance save error:', error);\r\n            toast({\r\n                title: 'Save Failed',\r\n                description: error.message || 'Failed to save attendance',\r\n                variant: 'destructive',\r\n            });\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    const presentCount = Object.values(attendance).filter(s => s === 'Present').length;\r\n    const absentCount = Object.values(attendance).filter(s => s === 'Absent').length;\r\n    const lateCount = Object.values(attendance).filter(s => s === 'Late').length;\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Curriculum Selector */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                        <BookOpen className=\"h-5 w-5\" />\r\n                        Select Curriculum Track\r\n                    </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                    <div className=\"flex items-center gap-2 p-3 bg-amber-50 border border-amber-200 rounded\">\r\n                        <AlertCircle className=\"h-5 w-5 text-amber-600\" />\r\n                        <p className=\"text-sm text-amber-900\">\r\n                            <strong>Important:</strong> Attendance is recorded separately for Nigerian and British curriculum students.\r\n                            Make sure to select the correct track before marking.\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <Card\r\n                            className={`cursor-pointer transition-all ${selectedCurriculum === 'Nigerian' ? 'border-green-500 border-2 bg-green-50' : 'hover:border-gray-400'\r\n                                }`}\r\n                            onClick={() => handleCurriculumSwitch('Nigerian')}\r\n                        >\r\n                            <CardContent className=\"p-6 text-center\">\r\n                                <h3 className=\"text-xl font-bold mb-2\">ðŸ‡³ðŸ‡¬ Nigerian Track</h3>\r\n                                <p className=\"text-sm text-gray-600\">WAEC/NECO Students</p>\r\n                                <Badge className=\"mt-3 bg-green-600 text-white\">\r\n                                    {students.length} Student{students.length !== 1 ? 's' : ''}\r\n                                </Badge>\r\n                            </CardContent>\r\n                        </Card>\r\n\r\n                        <Card\r\n                            className={`cursor-pointer transition-all ${selectedCurriculum === 'British' ? 'border-blue-500 border-2 bg-blue-50' : 'hover:border-gray-400'\r\n                                }`}\r\n                            onClick={() => handleCurriculumSwitch('British')}\r\n                        >\r\n                            <CardContent className=\"p-6 text-center\">\r\n                                <h3 className=\"text-xl font-bold mb-2\">ðŸ‡¬ðŸ‡§ British Track</h3>\r\n                                <p className=\"text-sm text-gray-600\">Cambridge/IGCSE Students</p>\r\n                                <Badge className=\"mt-3 bg-blue-600 text-white\">\r\n                                    {students.length} Student{students.length !== 1 ? 's' : ''}\r\n                                </Badge>\r\n                            </CardContent>\r\n                        </Card>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Attendance Summary */}\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n                <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                        <p className=\"text-sm text-gray-600\">Present</p>\r\n                        <p className=\"text-3xl font-bold text-green-600\">{presentCount}</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                        <p className=\"text-sm text-gray-600\">Absent</p>\r\n                        <p className=\"text-3xl font-bold text-red-600\">{absentCount}</p>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card>\r\n                    <CardContent className=\"p-4 text-center\">\r\n                        <p className=\"text-sm text-gray-600\">Late</p>\r\n                        <p className=\"text-3xl font-bold text-amber-600\">{lateCount}</p>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Student List */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <CardTitle>\r\n                            Mark Attendance - {selectedCurriculum} Track\r\n                        </CardTitle>\r\n                        <Badge variant=\"outline\" className={selectedCurriculum === 'Nigerian' ? 'border-green-500 text-green-700' : 'border-blue-500 text-blue-700'}>\r\n                            {selectedCurriculum === 'Nigerian' ? 'ðŸ‡³ðŸ‡¬ Nigerian' : 'ðŸ‡¬ðŸ‡§ British'}\r\n                        </Badge>\r\n                    </div>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    {loading ? (\r\n                        <p className=\"text-center py-8 text-gray-500\">Loading students...</p>\r\n                    ) : students.length === 0 ? (\r\n                        <div className=\"text-center py-8\">\r\n                            <AlertCircle className=\"h-12 w-12 text-gray-400 mx-auto mb-3\" />\r\n                            <p className=\"text-gray-600\">No students enrolled in {selectedCurriculum} curriculum for this class.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-2\">\r\n                            {students.map((student) => (\r\n                                <div key={student.id} className=\"flex items-center justify-between p-3 border rounded hover:bg-gray-50\">\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                                            <span className=\"text-sm font-semibold\">\r\n                                                {student.first_name?.[0]}{student.last_name?.[0]}\r\n                                            </span>\r\n                                        </div>\r\n                                        <div>\r\n                                            <p className=\"font-semibold\">{student.first_name} {student.last_name}</p>\r\n                                            <p className=\"text-xs text-gray-600\">{student.admission_number || `S-${student.id}`}</p>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex gap-2\">\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant={attendance[student.id] === 'Present' ? 'default' : 'outline'}\r\n                                            onClick={() => handleAttendanceChange(student.id, 'Present')}\r\n                                            className={attendance[student.id] === 'Present' ? 'bg-green-600 hover:bg-green-700' : ''}\r\n                                        >\r\n                                            <CheckCircle className=\"h-4 w-4 mr-1\" />\r\n                                            Present\r\n                                        </Button>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant={attendance[student.id] === 'Absent' ? 'default' : 'outline'}\r\n                                            onClick={() => handleAttendanceChange(student.id, 'Absent')}\r\n                                            className={attendance[student.id] === 'Absent' ? 'bg-red-600 hover:bg-red-700' : ''}\r\n                                        >\r\n                                            Absent\r\n                                        </Button>\r\n                                        <Button\r\n                                            size=\"sm\"\r\n                                            variant={attendance[student.id] === 'Late' ? 'default' : 'outline'}\r\n                                            onClick={() => handleAttendanceChange(student.id, 'Late')}\r\n                                            className={attendance[student.id] === 'Late' ? 'bg-amber-600 hover:bg-amber-700' : ''}\r\n                                        >\r\n                                            Late\r\n                                        </Button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    {students.length > 0 && (\r\n                        <div className=\"mt-6 flex justify-end\">\r\n                            <Button onClick={handleSave} disabled={saving} size=\"lg\">\r\n                                <Save className=\"h-4 w-4 mr-2\" />\r\n                                {saving ? 'Saving...' : 'Save Attendance'}\r\n                            </Button>\r\n                        </div>\r\n                    )}\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}