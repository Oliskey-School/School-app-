{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\shared\\\\SurveysAndPolls.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useProfile } from '../../context/ProfileContext';\nimport { supabase } from '../../lib/supabase';\nimport { toast } from 'react-hot-toast';\nimport { CheckCircle, BarChart2, MessageSquare, Star, ThumbsUp } from 'lucide-react';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SurveysAndPolls = () => {\n  const {\n    profile\n  } = useProfile();\n  const [surveys, setSurveys] = useState([]);\n  const [selectedSurvey, setSelectedSurvey] = useState(null);\n  const [questions, setQuestions] = useState([]);\n  const [responses, setResponses] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [hasResponded, setHasResponded] = useState(false);\n  const [showSurveyModal, setShowSurveyModal] = useState(false);\n  useEffect(() => {\n    fetchSurveys();\n  }, []);\n  const fetchSurveys = async () => {\n    try {\n      const today = new Date().toISOString().split('T')[0];\n      const {\n        data,\n        error\n      } = await supabase.from('surveys').select('*').eq('is_active', true).lte('start_date', today).gte('end_date', today).in('target_audience', ['Parents', 'All']).order('created_at', {\n        ascending: false\n      });\n      if (error) throw error;\n      setSurveys(data || []);\n    } catch (error) {\n      console.error('Error fetching surveys:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchQuestions = async surveyId => {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('survey_questions').select('*').eq('survey_id', surveyId).order('question_order', {\n        ascending: true\n      });\n      if (error) throw error;\n      setQuestions(data || []);\n      const {\n        data: existingResponse\n      } = await supabase.from('survey_responses').select('id').eq('survey_id', surveyId).eq('user_id', profile.id).limit(1);\n      setHasResponded(!!existingResponse && existingResponse.length > 0);\n    } catch (error) {\n      console.error('Error fetching questions:', error);\n    }\n  };\n  const handleSelectSurvey = async survey => {\n    setSelectedSurvey(survey);\n    await fetchQuestions(survey.id);\n    setShowSurveyModal(true);\n  };\n  const handleResponseChange = (questionId, value) => {\n    setResponses(prev => Object.assign({}, prev, {\n      [questionId]: value\n    }));\n  };\n  const handleSubmitSurvey = async () => {\n    if (!selectedSurvey) return;\n    const unanswered = questions.filter(q => q.is_required && !responses[q.id]);\n    if (unanswered.length > 0) {\n      toast.error(`Please answer all required questions (${unanswered.length} remaining)`);\n      return;\n    }\n    try {\n      const responseData = questions.map(q => ({\n        survey_id: selectedSurvey.id,\n        question_id: q.id,\n        user_id: selectedSurvey.is_anonymous ? null : profile.id,\n        user_type: 'Parent',\n        response_text: q.question_type === 'Text' ? responses[q.id] : null,\n        response_option: q.question_type === 'Multiple Choice' || q.question_type === 'Yes/No' ? responses[q.id] : null,\n        rating: q.question_type === 'Rating' ? responses[q.id] : null\n      }));\n      const {\n        error\n      } = await supabase.from('survey_responses').insert(responseData);\n      if (error) throw error;\n      await supabase.from('surveys').update({\n        response_count: selectedSurvey.response_count + 1\n      }).eq('id', selectedSurvey.id);\n      toast.success('Thank you for your feedback! ðŸŽ‰');\n      setShowSurveyModal(false);\n      setResponses({});\n      fetchSurveys();\n    } catch (error) {\n      toast.error('Failed to submit survey');\n      console.error(error);\n    }\n  };\n  const renderQuestion = question => {\n    switch (question.question_type) {\n      case 'Multiple Choice':\n        return _jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: question.options.map((option, index) => _jsxDEV(\"label\", {\n            className: \"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors\",\n            children: [_jsxDEV(\"input\", {\n              type: \"radio\",\n              name: `question-${question.id}`,\n              value: option,\n              checked: responses[question.id] === option,\n              onChange: e => handleResponseChange(question.id, e.target.value),\n              className: \"w-4 h-4 text-indigo-600\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 33\n            }, this), _jsxDEV(\"span\", {\n              className: \"text-gray-800\",\n              children: option\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 165,\n              columnNumber: 33\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this);\n      case 'Checkbox':\n        return _jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: question.options.map((option, index) => _jsxDEV(\"label\", {\n            className: \"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors\",\n            children: [_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: (responses[question.id] || []).includes(option),\n              onChange: e => {\n                const current = responses[question.id] || [];\n                const updated = e.target.checked ? [...current, option] : current.filter(o => o !== option);\n                handleResponseChange(question.id, updated);\n              },\n              className: \"w-4 h-4 text-indigo-600 rounded\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 33\n            }, this), _jsxDEV(\"span\", {\n              className: \"text-gray-800\",\n              children: option\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 33\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 21\n        }, this);\n      case 'Text':\n        return _jsxDEV(\"textarea\", {\n          value: responses[question.id] || '',\n          onChange: e => handleResponseChange(question.id, e.target.value),\n          placeholder: \"Your answer...\",\n          rows: 4,\n          className: \"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this);\n      case 'Rating':\n        return _jsxDEV(\"div\", {\n          className: \"flex space-x-2\",\n          children: [[1, 2, 3, 4, 5].map(rating => _jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => handleResponseChange(question.id, rating),\n            className: `p-3 rounded-lg transition-all ${responses[question.id] >= rating ? 'bg-yellow-400 text-white scale-110' : 'bg-gray-200 text-gray-400 hover:bg-gray-300'}`,\n            children: _jsxDEV(Star, {\n              className: \"h-6 w-6 fill-current\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 33\n            }, this)\n          }, rating, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 29\n          }, this)), _jsxDEV(\"span\", {\n            className: \"ml-2 text-gray-600 self-center\",\n            children: responses[question.id] ? `${responses[question.id]}/5` : 'Not rated'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 21\n        }, this);\n      case 'Yes/No':\n        return _jsxDEV(\"div\", {\n          className: \"flex space-x-4\",\n          children: [_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => handleResponseChange(question.id, 'Yes'),\n            className: `flex-1 px-6 py-3 rounded-lg font-semibold transition-all ${responses[question.id] === 'Yes' ? 'bg-green-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`,\n            children: [_jsxDEV(ThumbsUp, {\n              className: \"h-5 w-5 inline mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 29\n            }, this), \"Yes\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 25\n          }, this), _jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => handleResponseChange(question.id, 'No'),\n            className: `flex-1 px-6 py-3 rounded-lg font-semibold transition-all ${responses[question.id] === 'No' ? 'bg-red-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`,\n            children: \"No\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 21\n        }, this);\n      default:\n        return null;\n    }\n  };\n  if (loading) {\n    return _jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-64\",\n      children: _jsxDEV(\"div\", {\n        className: \"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 71\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 16\n    }, this);\n  }\n  return _jsxDEV(\"div\", {\n    className: \"p-6 max-w-4xl mx-auto\",\n    children: [_jsxDEV(\"div\", {\n      className: \"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl p-6 text-white mb-6\",\n      children: [_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold mb-2\",\n        children: \"Surveys & Polls\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 17\n      }, this), _jsxDEV(\"p\", {\n        className: \"text-purple-100\",\n        children: \"Your voice matters - share your feedback\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: surveys.length === 0 ? _jsxDEV(\"div\", {\n        className: \"bg-white rounded-xl shadow-sm p-12 text-center text-gray-500\",\n        children: [_jsxDEV(BarChart2, {\n          className: \"h-12 w-12 mx-auto mb-4 text-gray-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 25\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-lg\",\n          children: \"No active surveys at the moment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 25\n        }, this), _jsxDEV(\"p\", {\n          className: \"text-sm\",\n          children: \"Check back later for new surveys\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 21\n      }, this) : surveys.map(survey => _jsxDEV(\"div\", {\n        className: \"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-6\",\n        children: _jsxDEV(\"div\", {\n          className: \"flex items-start justify-between mb-4\",\n          children: [_jsxDEV(\"div\", {\n            className: \"flex-1\",\n            children: [_jsxDEV(\"h3\", {\n              className: \"text-xl font-bold text-gray-900 mb-2\",\n              children: survey.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 37\n            }, this), _jsxDEV(\"p\", {\n              className: \"text-gray-600 mb-3\",\n              children: survey.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 37\n            }, this), _jsxDEV(\"div\", {\n              className: \"flex items-center space-x-4 text-sm text-gray-600\",\n              children: [_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-1\",\n                children: [_jsxDEV(MessageSquare, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 45\n                }, this), _jsxDEV(\"span\", {\n                  children: [survey.response_count, \" responses\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 41\n              }, this), survey.is_anonymous && _jsxDEV(\"span\", {\n                className: \"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-semibold\",\n                children: \"Anonymous\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 45\n              }, this), _jsxDEV(\"span\", {\n                className: \"text-xs\",\n                children: [\"Ends: \", new Date(survey.end_date).toLocaleDateString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 33\n          }, this), _jsxDEV(\"button\", {\n            onClick: () => handleSelectSurvey(survey),\n            className: \"ml-4 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors\",\n            children: \"Take Survey\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 29\n        }, this)\n      }, survey.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }, this), showSurveyModal && selectedSurvey && _jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\",\n      children: _jsxDEV(\"div\", {\n        className: \"bg-white rounded-xl max-w-2xl w-full my-8\",\n        children: _jsxDEV(\"div\", {\n          className: \"p-6\",\n          children: [_jsxDEV(\"h2\", {\n            className: \"text-2xl font-bold text-gray-900 mb-2\",\n            children: selectedSurvey.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 29\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-gray-600 mb-6\",\n            children: selectedSurvey.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 29\n          }, this), hasResponded ? _jsxDEV(\"div\", {\n            className: \"text-center py-12\",\n            children: [_jsxDEV(CheckCircle, {\n              className: \"h-16 w-16 text-green-600 mx-auto mb-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 37\n            }, this), _jsxDEV(\"h3\", {\n              className: \"text-xl font-bold text-gray-900 mb-2\",\n              children: \"Already Submitted\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 37\n            }, this), _jsxDEV(\"p\", {\n              className: \"text-gray-600\",\n              children: \"Thank you for your previous response!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 37\n            }, this), _jsxDEV(\"button\", {\n              onClick: () => setShowSurveyModal(false),\n              className: \"mt-6 px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold\",\n              children: \"Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 33\n          }, this) : _jsxDEV(_Fragment, {\n            children: [_jsxDEV(\"div\", {\n              className: \"space-y-6 mb-6 max-h-[60vh] overflow-y-auto\",\n              children: questions.map((question, index) => _jsxDEV(\"div\", {\n                className: \"pb-6 border-b border-gray-200 last:border-0\",\n                children: [_jsxDEV(\"label\", {\n                  className: \"block text-lg font-semibold text-gray-900 mb-3\",\n                  children: [index + 1, \". \", question.question_text, question.is_required && _jsxDEV(\"span\", {\n                    className: \"text-red-500 ml-1\",\n                    children: \"*\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 341,\n                    columnNumber: 78\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 49\n                }, this), renderQuestion(question)]\n              }, question.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 45\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 37\n            }, this), _jsxDEV(\"div\", {\n              className: \"flex space-x-3 pt-4 border-t border-gray-200\",\n              children: [_jsxDEV(\"button\", {\n                onClick: () => {\n                  setShowSurveyModal(false);\n                  setResponses({});\n                },\n                className: \"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold\",\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 41\n              }, this), _jsxDEV(\"button\", {\n                onClick: handleSubmitSurvey,\n                className: \"flex-1 px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold\",\n                children: \"Submit Survey\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 264,\n    columnNumber: 9\n  }, this);\n};\nexport default SurveysAndPolls;","map":{"version":3,"names":["React","useState","useEffect","useProfile","supabase","toast","CheckCircle","BarChart2","MessageSquare","Star","ThumbsUp","jsxDEV","_jsxDEV","Fragment","_Fragment","SurveysAndPolls","profile","surveys","setSurveys","selectedSurvey","setSelectedSurvey","questions","setQuestions","responses","setResponses","loading","setLoading","hasResponded","setHasResponded","showSurveyModal","setShowSurveyModal","fetchSurveys","today","Date","toISOString","split","data","error","from","select","eq","lte","gte","in","order","ascending","console","fetchQuestions","surveyId","existingResponse","id","limit","length","handleSelectSurvey","survey","handleResponseChange","questionId","value","prev","Object","assign","handleSubmitSurvey","unanswered","filter","q","is_required","responseData","map","survey_id","question_id","user_id","is_anonymous","user_type","response_text","question_type","response_option","rating","insert","update","response_count","success","renderQuestion","question","className","children","options","option","index","type","name","checked","onChange","e","target","fileName","_jsxFileName","lineNumber","columnNumber","includes","current","updated","o","placeholder","rows","onClick","title","description","end_date","toLocaleDateString","question_text"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/shared/SurveysAndPolls.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useProfile } from '../../context/ProfileContext';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { toast } from 'react-hot-toast';\r\nimport { CheckCircle, BarChart2, MessageSquare, Star, ThumbsUp } from 'lucide-react';\r\n\r\ninterface Survey {\r\n    id: number;\r\n    title: string;\r\n    description: string;\r\n    start_date: string;\r\n    end_date: string;\r\n    target_audience: string;\r\n    is_anonymous: boolean;\r\n    is_active: boolean;\r\n    response_count: number;\r\n}\r\n\r\ninterface Question {\r\n    id: number;\r\n    survey_id: number;\r\n    question_text: string;\r\n    question_type: string;\r\n    question_order: number;\r\n    options: string[];\r\n    is_required: boolean;\r\n}\r\n\r\nconst SurveysAndPolls: React.FC = () => {\r\n    const { profile } = useProfile();\r\n    const [surveys, setSurveys] = useState<Survey[]>([]);\r\n    const [selectedSurvey, setSelectedSurvey] = useState<Survey | null>(null);\r\n    const [questions, setQuestions] = useState<Question[]>([]);\r\n    const [responses, setResponses] = useState<{ [key: number]: any }>({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [hasResponded, setHasResponded] = useState(false);\r\n    const [showSurveyModal, setShowSurveyModal] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchSurveys();\r\n    }, []);\r\n\r\n    const fetchSurveys = async () => {\r\n        try {\r\n            const today = new Date().toISOString().split('T')[0];\r\n\r\n            const { data, error } = await supabase\r\n                .from('surveys')\r\n                .select('*')\r\n                .eq('is_active', true)\r\n                .lte('start_date', today)\r\n                .gte('end_date', today)\r\n                .in('target_audience', ['Parents', 'All'])\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (error) throw error;\r\n            setSurveys(data || []);\r\n        } catch (error: any) {\r\n            console.error('Error fetching surveys:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const fetchQuestions = async (surveyId: number) => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('survey_questions')\r\n                .select('*')\r\n                .eq('survey_id', surveyId)\r\n                .order('question_order', { ascending: true });\r\n\r\n            if (error) throw error;\r\n            setQuestions(data || []);\r\n\r\n            // Check if user has already responded\r\n            const { data: existingResponse } = await supabase\r\n                .from('survey_responses')\r\n                .select('id')\r\n                .eq('survey_id', surveyId)\r\n                .eq('user_id', profile.id)\r\n                .limit(1);\r\n\r\n            setHasResponded(!!existingResponse && existingResponse.length > 0);\r\n        } catch (error: any) {\r\n            console.error('Error fetching questions:', error);\r\n        }\r\n    };\r\n\r\n    const handleSelectSurvey = async (survey: Survey) => {\r\n        setSelectedSurvey(survey);\r\n        await fetchQuestions(survey.id);\r\n        setShowSurveyModal(true);\r\n    };\r\n\r\n    const handleResponseChange = (questionId: number, value: any) => {\r\n        setResponses(prev => ({\r\n            ...prev,\r\n            [questionId]: value\r\n        }));\r\n    };\r\n\r\n    const handleSubmitSurvey = async () => {\r\n        if (!selectedSurvey) return;\r\n\r\n        // Validate required questions\r\n        const unanswered = questions.filter(q =>\r\n            q.is_required && !responses[q.id]\r\n        );\r\n\r\n        if (unanswered.length > 0) {\r\n            toast.error(`Please answer all required questions (${unanswered.length} remaining)`);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Insert all responses\r\n            const responseData = questions.map(q => ({\r\n                survey_id: selectedSurvey.id,\r\n                question_id: q.id,\r\n                user_id: selectedSurvey.is_anonymous ? null : profile.id,\r\n                user_type: 'Parent',\r\n                response_text: q.question_type === 'Text' ? responses[q.id] : null,\r\n                response_option: q.question_type === 'Multiple Choice' || q.question_type === 'Yes/No' ? responses[q.id] : null,\r\n                rating: q.question_type === 'Rating' ? responses[q.id] : null\r\n            }));\r\n\r\n            const { error } = await supabase\r\n                .from('survey_responses')\r\n                .insert(responseData);\r\n\r\n            if (error) throw error;\r\n\r\n            // Update survey response count\r\n            await supabase\r\n                .from('surveys')\r\n                .update({ response_count: selectedSurvey.response_count + 1 })\r\n                .eq('id', selectedSurvey.id);\r\n\r\n            toast.success('Thank you for your feedback! ðŸŽ‰');\r\n            setShowSurveyModal(false);\r\n            setResponses({});\r\n            fetchSurveys();\r\n        } catch (error: any) {\r\n            toast.error('Failed to submit survey');\r\n            console.error(error);\r\n        }\r\n    };\r\n\r\n    const renderQuestion = (question: Question) => {\r\n        switch (question.question_type) {\r\n            case 'Multiple Choice':\r\n                return (\r\n                    <div className=\"space-y-2\">\r\n                        {question.options.map((option, index) => (\r\n                            <label key={index} className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors\">\r\n                                <input\r\n                                    type=\"radio\"\r\n                                    name={`question-${question.id}`}\r\n                                    value={option}\r\n                                    checked={responses[question.id] === option}\r\n                                    onChange={(e) => handleResponseChange(question.id, e.target.value)}\r\n                                    className=\"w-4 h-4 text-indigo-600\"\r\n                                />\r\n                                <span className=\"text-gray-800\">{option}</span>\r\n                            </label>\r\n                        ))}\r\n                    </div>\r\n                );\r\n\r\n            case 'Checkbox':\r\n                return (\r\n                    <div className=\"space-y-2\">\r\n                        {question.options.map((option, index) => (\r\n                            <label key={index} className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={(responses[question.id] || []).includes(option)}\r\n                                    onChange={(e) => {\r\n                                        const current = responses[question.id] || [];\r\n                                        const updated = e.target.checked\r\n                                            ? [...current, option]\r\n                                            : current.filter((o: string) => o !== option);\r\n                                        handleResponseChange(question.id, updated);\r\n                                    }}\r\n                                    className=\"w-4 h-4 text-indigo-600 rounded\"\r\n                                />\r\n                                <span className=\"text-gray-800\">{option}</span>\r\n                            </label>\r\n                        ))}\r\n                    </div>\r\n                );\r\n\r\n            case 'Text':\r\n                return (\r\n                    <textarea\r\n                        value={responses[question.id] || ''}\r\n                        onChange={(e) => handleResponseChange(question.id, e.target.value)}\r\n                        placeholder=\"Your answer...\"\r\n                        rows={4}\r\n                        className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500\"\r\n                    ></textarea>\r\n                );\r\n\r\n            case 'Rating':\r\n                return (\r\n                    <div className=\"flex space-x-2\">\r\n                        {[1, 2, 3, 4, 5].map(rating => (\r\n                            <button\r\n                                key={rating}\r\n                                type=\"button\"\r\n                                onClick={() => handleResponseChange(question.id, rating)}\r\n                                className={`p-3 rounded-lg transition-all ${responses[question.id] >= rating\r\n                                        ? 'bg-yellow-400 text-white scale-110'\r\n                                        : 'bg-gray-200 text-gray-400 hover:bg-gray-300'\r\n                                    }`}\r\n                            >\r\n                                <Star className=\"h-6 w-6 fill-current\" />\r\n                            </button>\r\n                        ))}\r\n                        <span className=\"ml-2 text-gray-600 self-center\">\r\n                            {responses[question.id] ? `${responses[question.id]}/5` : 'Not rated'}\r\n                        </span>\r\n                    </div>\r\n                );\r\n\r\n            case 'Yes/No':\r\n                return (\r\n                    <div className=\"flex space-x-4\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={() => handleResponseChange(question.id, 'Yes')}\r\n                            className={`flex-1 px-6 py-3 rounded-lg font-semibold transition-all ${responses[question.id] === 'Yes'\r\n                                    ? 'bg-green-600 text-white'\r\n                                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'\r\n                                }`}\r\n                        >\r\n                            <ThumbsUp className=\"h-5 w-5 inline mr-2\" />\r\n                            Yes\r\n                        </button>\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={() => handleResponseChange(question.id, 'No')}\r\n                            className={`flex-1 px-6 py-3 rounded-lg font-semibold transition-all ${responses[question.id] === 'No'\r\n                                    ? 'bg-red-600 text-white'\r\n                                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'\r\n                                }`}\r\n                        >\r\n                            No\r\n                        </button>\r\n                    </div>\r\n                );\r\n\r\n            default:\r\n                return null;\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return <div className=\"flex justify-center items-center h-64\"><div className=\"w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin\"></div></div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-6 max-w-4xl mx-auto\">\r\n            {/* Header */}\r\n            <div className=\"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl p-6 text-white mb-6\">\r\n                <h1 className=\"text-3xl font-bold mb-2\">Surveys & Polls</h1>\r\n                <p className=\"text-purple-100\">Your voice matters - share your feedback</p>\r\n            </div>\r\n\r\n            {/* Active Surveys */}\r\n            <div className=\"space-y-4\">\r\n                {surveys.length === 0 ? (\r\n                    <div className=\"bg-white rounded-xl shadow-sm p-12 text-center text-gray-500\">\r\n                        <BarChart2 className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n                        <p className=\"text-lg\">No active surveys at the moment</p>\r\n                        <p className=\"text-sm\">Check back later for new surveys</p>\r\n                    </div>\r\n                ) : (\r\n                    surveys.map(survey => (\r\n                        <div key={survey.id} className=\"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-6\">\r\n                            <div className=\"flex items-start justify-between mb-4\">\r\n                                <div className=\"flex-1\">\r\n                                    <h3 className=\"text-xl font-bold text-gray-900 mb-2\">{survey.title}</h3>\r\n                                    <p className=\"text-gray-600 mb-3\">{survey.description}</p>\r\n                                    <div className=\"flex items-center space-x-4 text-sm text-gray-600\">\r\n                                        <div className=\"flex items-center space-x-1\">\r\n                                            <MessageSquare className=\"h-4 w-4\" />\r\n                                            <span>{survey.response_count} responses</span>\r\n                                        </div>\r\n                                        {survey.is_anonymous && (\r\n                                            <span className=\"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-semibold\">\r\n                                                Anonymous\r\n                                            </span>\r\n                                        )}\r\n                                        <span className=\"text-xs\">\r\n                                            Ends: {new Date(survey.end_date).toLocaleDateString()}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => handleSelectSurvey(survey)}\r\n                                    className=\"ml-4 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors\"\r\n                                >\r\n                                    Take Survey\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            {/* Survey Modal */}\r\n            {showSurveyModal && selectedSurvey && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\r\n                    <div className=\"bg-white rounded-xl max-w-2xl w-full my-8\">\r\n                        <div className=\"p-6\">\r\n                            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">{selectedSurvey.title}</h2>\r\n                            <p className=\"text-gray-600 mb-6\">{selectedSurvey.description}</p>\r\n\r\n                            {hasResponded ? (\r\n                                <div className=\"text-center py-12\">\r\n                                    <CheckCircle className=\"h-16 w-16 text-green-600 mx-auto mb-4\" />\r\n                                    <h3 className=\"text-xl font-bold text-gray-900 mb-2\">Already Submitted</h3>\r\n                                    <p className=\"text-gray-600\">Thank you for your previous response!</p>\r\n                                    <button\r\n                                        onClick={() => setShowSurveyModal(false)}\r\n                                        className=\"mt-6 px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold\"\r\n                                    >\r\n                                        Close\r\n                                    </button>\r\n                                </div>\r\n                            ) : (\r\n                                <>\r\n                                    {/* Questions */}\r\n                                    <div className=\"space-y-6 mb-6 max-h-[60vh] overflow-y-auto\">\r\n                                        {questions.map((question, index) => (\r\n                                            <div key={question.id} className=\"pb-6 border-b border-gray-200 last:border-0\">\r\n                                                <label className=\"block text-lg font-semibold text-gray-900 mb-3\">\r\n                                                    {index + 1}. {question.question_text}\r\n                                                    {question.is_required && <span className=\"text-red-500 ml-1\">*</span>}\r\n                                                </label>\r\n                                                {renderQuestion(question)}\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    {/* Actions */}\r\n                                    <div className=\"flex space-x-3 pt-4 border-t border-gray-200\">\r\n                                        <button\r\n                                            onClick={() => {\r\n                                                setShowSurveyModal(false);\r\n                                                setResponses({});\r\n                                            }}\r\n                                            className=\"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold\"\r\n                                        >\r\n                                            Cancel\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={handleSubmitSurvey}\r\n                                            className=\"flex-1 px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold\"\r\n                                        >\r\n                                            Submit Survey\r\n                                        </button>\r\n                                    </div>\r\n                                </>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SurveysAndPolls;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}