{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\admin\\\\BusDutyRosterScreen.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { mockBusRoutes, mockDrivers, mockBusRoster } from '../../data';\nimport { BusVehicleIcon } from '../../constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RosterRow = ({\n  route,\n  roster,\n  drivers,\n  onAssign\n}) => {\n  const today = new Date().toISOString().split('T')[0];\n  const todaysAssignment = roster.find(r => r.routeId === route.id && r.date === today);\n  const currentDriver = drivers.find(d => d.id === todaysAssignment?.driverId);\n  const [selectedDriverId, setSelectedDriverId] = useState(currentDriver?.id.toString() || '');\n  const handleSave = () => {\n    const driverId = selectedDriverId ? parseInt(selectedDriverId, 10) : null;\n    onAssign(route.id, driverId);\n  };\n  return _jsxDEV(\"div\", {\n    className: \"bg-white p-4 rounded-xl shadow-sm space-y-3\",\n    children: [_jsxDEV(\"div\", {\n      children: [_jsxDEV(\"h4\", {\n        className: \"font-bold text-lg text-gray-800\",\n        children: route.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 17\n      }, this), _jsxDEV(\"p\", {\n        className: \"text-sm text-gray-500\",\n        children: route.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 13\n    }, this), _jsxDEV(\"div\", {\n      className: \"flex items-center space-x-3\",\n      children: [_jsxDEV(\"select\", {\n        value: selectedDriverId,\n        onChange: e => setSelectedDriverId(e.target.value),\n        className: \"flex-grow p-2 bg-gray-50 border border-gray-300 rounded-lg\",\n        children: [_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"-- Unassigned --\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 21\n        }, this), drivers.map(driver => _jsxDEV(\"option\", {\n          value: driver.id,\n          children: driver.name\n        }, driver.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 25\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 17\n      }, this), _jsxDEV(\"button\", {\n        onClick: handleSave,\n        className: \"px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300\",\n        disabled: selectedDriverId === (currentDriver?.id.toString() || ''),\n        children: \"Save\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 9\n  }, this);\n};\nconst BusDutyRosterScreen = () => {\n  const [roster, setRoster] = useState(mockBusRoster);\n  useEffect(() => {\n    const saved = localStorage.getItem('schoolApp_busRoster');\n    if (saved) {\n      try {\n        setRoster(JSON.parse(saved));\n      } catch (e) {\n        console.error(\"Failed to parse roster from storage\");\n      }\n    }\n  }, []);\n  const handleAssignDriver = (routeId, driverId) => {\n    const today = new Date().toISOString().split('T')[0];\n    const newRoster = [...roster];\n    const existingEntryIndex = newRoster.findIndex(r => r.routeId === routeId && r.date === today);\n    if (existingEntryIndex > -1) {\n      newRoster[existingEntryIndex] = Object.assign({}, newRoster[existingEntryIndex], {\n        driverId\n      });\n    } else {\n      newRoster.push({\n        routeId,\n        driverId,\n        date: today\n      });\n    }\n    setRoster(newRoster);\n    localStorage.setItem('schoolApp_busRoster', JSON.stringify(newRoster));\n    window.dispatchEvent(new Event('storage'));\n    toast.success(`Driver assigned successfully for ${routeId}.`);\n  };\n  return _jsxDEV(\"div\", {\n    className: \"p-4 space-y-4 bg-gray-100 h-full overflow-y-auto\",\n    children: [_jsxDEV(\"div\", {\n      className: \"bg-indigo-50 p-4 rounded-xl text-center border border-indigo-200\",\n      children: [_jsxDEV(BusVehicleIcon, {\n        className: \"h-10 w-10 mx-auto text-indigo-400 mb-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), _jsxDEV(\"h3\", {\n        className: \"font-bold text-lg text-indigo-800\",\n        children: \"Bus Duty Roster for Today\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this), _jsxDEV(\"p\", {\n        className: \"text-sm text-indigo-700\",\n        children: \"Assign drivers to routes for the current day.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), mockBusRoutes.map(route => _jsxDEV(RosterRow, {\n      route: route,\n      roster: roster,\n      drivers: mockDrivers,\n      onAssign: handleAssignDriver\n    }, route.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n};\nexport default BusDutyRosterScreen;","map":{"version":3,"names":["React","useState","useEffect","toast","mockBusRoutes","mockDrivers","mockBusRoster","BusVehicleIcon","jsxDEV","_jsxDEV","RosterRow","route","roster","drivers","onAssign","today","Date","toISOString","split","todaysAssignment","find","r","routeId","id","date","currentDriver","d","driverId","selectedDriverId","setSelectedDriverId","toString","handleSave","parseInt","className","children","name","fileName","_jsxFileName","lineNumber","columnNumber","description","value","onChange","e","target","map","driver","onClick","disabled","BusDutyRosterScreen","setRoster","saved","localStorage","getItem","JSON","parse","console","error","handleAssignDriver","newRoster","existingEntryIndex","findIndex","Object","assign","push","setItem","stringify","window","dispatchEvent","Event","success"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/admin/BusDutyRosterScreen.tsx"],"sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\r\nimport { toast } from 'react-hot-toast';\r\nimport { BusRoute, Driver, BusRosterEntry } from '../../types';\r\nimport { mockBusRoutes, mockDrivers, mockBusRoster } from '../../data';\r\nimport { BusVehicleIcon } from '../../constants';\r\n\r\nconst RosterRow: React.FC<{\r\n    route: BusRoute;\r\n    roster: BusRosterEntry[];\r\n    drivers: Driver[];\r\n    onAssign: (routeId: string, driverId: number | null) => void;\r\n}> = ({ route, roster, drivers, onAssign }) => {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const todaysAssignment = roster.find(r => r.routeId === route.id && r.date === today);\r\n    const currentDriver = drivers.find(d => d.id === todaysAssignment?.driverId);\r\n\r\n    const [selectedDriverId, setSelectedDriverId] = useState<string>(currentDriver?.id.toString() || '');\r\n\r\n    const handleSave = () => {\r\n        const driverId = selectedDriverId ? parseInt(selectedDriverId, 10) : null;\r\n        onAssign(route.id, driverId);\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white p-4 rounded-xl shadow-sm space-y-3\">\r\n            <div>\r\n                <h4 className=\"font-bold text-lg text-gray-800\">{route.name}</h4>\r\n                <p className=\"text-sm text-gray-500\">{route.description}</p>\r\n            </div>\r\n            <div className=\"flex items-center space-x-3\">\r\n                <select\r\n                    value={selectedDriverId}\r\n                    onChange={e => setSelectedDriverId(e.target.value)}\r\n                    className=\"flex-grow p-2 bg-gray-50 border border-gray-300 rounded-lg\"\r\n                >\r\n                    <option value=\"\">-- Unassigned --</option>\r\n                    {drivers.map(driver => (\r\n                        <option key={driver.id} value={driver.id}>{driver.name}</option>\r\n                    ))}\r\n                </select>\r\n                <button\r\n                    onClick={handleSave}\r\n                    className=\"px-4 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300\"\r\n                    disabled={selectedDriverId === (currentDriver?.id.toString() || '')}\r\n                >\r\n                    Save\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst BusDutyRosterScreen: React.FC = () => {\r\n    const [roster, setRoster] = useState<BusRosterEntry[]>(mockBusRoster);\r\n\r\n    // Load from localStorage on mount\r\n    useEffect(() => {\r\n        const saved = localStorage.getItem('schoolApp_busRoster');\r\n        if (saved) {\r\n            try {\r\n                setRoster(JSON.parse(saved));\r\n            } catch (e) {\r\n                console.error(\"Failed to parse roster from storage\");\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    const handleAssignDriver = (routeId: string, driverId: number | null) => {\r\n        const today = new Date().toISOString().split('T')[0];\r\n        const newRoster = [...roster];\r\n\r\n        const existingEntryIndex = newRoster.findIndex(r => r.routeId === routeId && r.date === today);\r\n\r\n        if (existingEntryIndex > -1) {\r\n            newRoster[existingEntryIndex] = { ...newRoster[existingEntryIndex], driverId };\r\n        } else {\r\n            newRoster.push({ routeId, driverId, date: today });\r\n        }\r\n\r\n        setRoster(newRoster);\r\n        localStorage.setItem('schoolApp_busRoster', JSON.stringify(newRoster));\r\n\r\n        // Trigger a storage event for other tabs immediately (optional, but good practice)\r\n        window.dispatchEvent(new Event('storage'));\r\n\r\n        toast.success(`Driver assigned successfully for ${routeId}.`);\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-4 space-y-4 bg-gray-100 h-full overflow-y-auto\">\r\n            <div className=\"bg-indigo-50 p-4 rounded-xl text-center border border-indigo-200\">\r\n                <BusVehicleIcon className=\"h-10 w-10 mx-auto text-indigo-400 mb-2\" />\r\n                <h3 className=\"font-bold text-lg text-indigo-800\">Bus Duty Roster for Today</h3>\r\n                <p className=\"text-sm text-indigo-700\">Assign drivers to routes for the current day.</p>\r\n            </div>\r\n            {mockBusRoutes.map(route => (\r\n                <RosterRow\r\n                    key={route.id}\r\n                    route={route}\r\n                    roster={roster}\r\n                    drivers={mockDrivers}\r\n                    onAssign={handleAssignDriver}\r\n                />\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BusDutyRosterScreen;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}