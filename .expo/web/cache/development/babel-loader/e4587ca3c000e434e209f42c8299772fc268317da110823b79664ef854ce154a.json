{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\shared\\\\TimetableScreen.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { SUBJECT_COLORS, CalendarIcon, RefreshIcon } from '../../constants';\nimport { supabase } from '../../lib/supabase';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst formatTime12Hour = timeStr => {\n  if (!timeStr) return '';\n  const [hours, minutes] = timeStr.split(':');\n  let h = parseInt(hours, 10);\n  const ampm = h >= 12 ? 'PM' : 'AM';\n  h = h % 12;\n  h = h ? h : 12;\n  return `${h}:${minutes} ${ampm}`;\n};\nconst PERIODS = [{\n  name: 'Period 1',\n  start: '09:00',\n  end: '09:45'\n}, {\n  name: 'Period 2',\n  start: '09:45',\n  end: '10:30'\n}, {\n  name: 'Period 3',\n  start: '10:30',\n  end: '11:15'\n}, {\n  name: 'Short Break',\n  start: '11:15',\n  end: '11:30',\n  isBreak: true\n}, {\n  name: 'Period 4',\n  start: '11:30',\n  end: '12:15'\n}, {\n  name: 'Period 5',\n  start: '12:15',\n  end: '13:00'\n}, {\n  name: 'Long Break',\n  start: '13:00',\n  end: '13:45',\n  isBreak: true\n}, {\n  name: 'Period 6',\n  start: '13:45',\n  end: '14:30'\n}, {\n  name: 'Period 7',\n  start: '14:30',\n  end: '15:15'\n}, {\n  name: 'Period 8',\n  start: '15:15',\n  end: '16:00'\n}];\nconst DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];\nconst TimetableCell = ({\n  subject,\n  teacher,\n  isBreak\n}) => {\n  if (isBreak) {\n    return _jsxDEV(\"div\", {\n      className: \"h-full min-h-[5rem] bg-gray-100/50 flex items-center justify-center relative overflow-hidden group\",\n      children: [_jsxDEV(\"div\", {\n        className: \"absolute inset-0 pattern-diagonal-lines opacity-10\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 17\n      }, this), _jsxDEV(\"span\", {\n        className: \"text-[10px] font-bold text-gray-400 uppercase tracking-widest -rotate-90 md:rotate-0 whitespace-nowrap z-10\",\n        children: subject\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 13\n    }, this);\n  }\n  const colorClass = subject ? SUBJECT_COLORS[subject] : 'bg-white';\n  return _jsxDEV(\"div\", {\n    className: `\n            h-full min-h-[5rem] border border-gray-100 md:border-transparent flex flex-col items-center justify-center p-1 relative transition-all duration-200\n            ${subject ? `${colorClass} shadow-sm` : 'bg-white'}\n        `,\n    children: subject ? _jsxDEV(_Fragment, {\n      children: [_jsxDEV(\"span\", {\n        className: \"font-bold text-xs md:text-sm text-center leading-tight px-1\",\n        children: subject\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 21\n      }, this), teacher && _jsxDEV(\"span\", {\n        className: \"text-[10px] md:text-xs mt-1 opacity-75 font-medium truncate max-w-full px-1\",\n        children: teacher\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 33\n      }, this)]\n    }, void 0, true) : _jsxDEV(\"div\", {\n      className: \"w-full h-full flex items-center justify-center\",\n      children: _jsxDEV(\"span\", {\n        className: \"text-gray-200 text-xs font-medium\",\n        children: \"-\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 9\n  }, this);\n};\nconst MobileDayView = ({\n  day,\n  timetable,\n  teacherAssignments\n}) => {\n  return _jsxDEV(\"div\", {\n    className: \"space-y-4 pb-24\",\n    children: PERIODS.map((period, idx) => {\n      if (period.isBreak) return _jsxDEV(\"div\", {\n        className: \"flex items-center justify-center py-4 bg-gray-50/50 rounded-2xl border border-gray-100 border-dashed\",\n        children: _jsxDEV(\"span\", {\n          className: \"text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em]\",\n          children: period.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 25\n        }, this)\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 21\n      }, this);\n      const key = `${day}-${period.name}`;\n      const subject = timetable[key];\n      const teacher = teacherAssignments[key];\n      const colorClass = subject ? SUBJECT_COLORS[subject] : 'bg-white border border-gray-200';\n      return _jsxDEV(\"div\", {\n        className: `w-full text-left p-0 rounded-2xl shadow-sm overflow-hidden flex ${!subject ? 'bg-white border border-gray-200' : 'shadow-md'}`,\n        children: [_jsxDEV(\"div\", {\n          className: \"w-20 bg-gray-50 border-r border-gray-100 p-4 flex flex-col justify-center items-center text-center\",\n          children: [_jsxDEV(\"span\", {\n            className: \"font-bold text-gray-700 text-sm leading-none\",\n            children: period.name.split(' ')[1] || period.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 29\n          }, this), _jsxDEV(\"span\", {\n            className: \"text-[10px] font-medium text-gray-400 mt-1 leading-tight\",\n            children: [formatTime12Hour(period.start), _jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 136\n            }, this), formatTime12Hour(period.end)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: `flex-1 p-4 flex items-center justify-between ${subject ? colorClass : ''}`,\n          children: _jsxDEV(\"div\", {\n            children: [_jsxDEV(\"h4\", {\n              className: `font-bold text-base ${!subject ? 'text-gray-400 italic' : ''}`,\n              children: subject || 'Free Period'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 33\n            }, this), teacher && _jsxDEV(\"span\", {\n              className: \"text-xs opacity-75 mt-0.5 block font-medium\",\n              children: teacher\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 45\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 25\n        }, this)]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 21\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n};\nconst TimetableScreen = ({\n  context\n}) => {\n  const [timetable, setTimetable] = useState({});\n  const [teacherAssignments, setTeacherAssignments] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [className, setClassName] = useState('');\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 1024);\n  const [selectedDay, setSelectedDay] = useState(DAYS[new Date().getDay() - 1] || 'Monday');\n  useEffect(() => {\n    const handleResize = () => setIsMobile(window.innerWidth < 1024);\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n  useEffect(() => {\n    const fetchData = async () => {\n      setLoading(true);\n      try {\n        let targetClassName = '';\n        if (context.userType === 'student' || context.userType === 'parent') {\n          const {\n            data: student\n          } = await supabase.from('students').select('grade, section').eq('id', context.userId).single();\n          if (student) {\n            targetClassName = `${student.grade}${student.section}`;\n          }\n        }\n        let query = supabase.from('timetable').select('day, start_time, end_time, subject, class_name, teacher_id').eq('status', 'Published');\n        if (context.userType === 'teacher') {\n          query = query.eq('teacher_id', context.userId);\n        } else if (targetClassName) {\n          query = query.ilike('class_name', `%${targetClassName}%`);\n        }\n        const {\n          data,\n          error\n        } = await query;\n        if (error) throw error;\n        if (data && data.length > 0) {\n          const newTimetable = {};\n          const newTeachers = {};\n          const teacherIds = [...new Set(data.map(d => d.teacher_id).filter(Boolean))];\n          const {\n            data: teachersData\n          } = await supabase.from('teachers').select('id, name').in('id', teacherIds);\n          const teacherMap = new Map((teachersData || []).map(t => [t.id, t.name]));\n          const getPeriodName = start => {\n            const timeShort = start.substring(0, 5);\n            const p = PERIODS.find(p => p.start === timeShort);\n            return p ? p.name : null;\n          };\n          data.forEach(entry => {\n            const pName = getPeriodName(entry.start_time);\n            if (pName) {\n              const key = `${entry.day}-${pName}`;\n              newTimetable[key] = entry.subject;\n              if (entry.teacher_id) {\n                newTeachers[key] = teacherMap.get(entry.teacher_id) || null;\n              }\n              if (!className) setClassName(entry.class_name);\n            }\n          });\n          setTimetable(newTimetable);\n          setTeacherAssignments(newTeachers);\n          if (!className && data.length > 0) setClassName(data[0].class_name);\n        } else {\n          setTimetable({});\n          setTeacherAssignments({});\n        }\n      } catch (err) {\n        console.error('Error fetching timetable:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, [context]);\n  if (loading) {\n    return _jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-full bg-white/50\",\n      children: _jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-10 w-10 border-4 border-gray-200 border-t-indigo-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 13\n    }, this);\n  }\n  return _jsxDEV(\"div\", {\n    className: \"flex flex-col h-full bg-gray-50 relative animate-fade-in\",\n    children: [_jsxDEV(\"div\", {\n      className: \"bg-white border-b border-gray-200 p-4 sticky top-0 z-30 shadow-sm flex justify-between items-center\",\n      children: [_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [_jsxDEV(\"div\", {\n          className: \"bg-indigo-100 p-2 rounded-lg\",\n          children: _jsxDEV(CalendarIcon, {\n            className: \"w-6 h-6 text-indigo-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 21\n        }, this), _jsxDEV(\"div\", {\n          children: [_jsxDEV(\"h2\", {\n            className: \"text-xl font-bold text-gray-900\",\n            children: className || 'My Timetable'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 25\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 font-medium\",\n            children: \"Weekly Schedule\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 17\n      }, this), _jsxDEV(\"button\", {\n        onClick: () => window.location.reload(),\n        className: \"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-400 hover:text-gray-600\",\n        children: _jsxDEV(RefreshIcon, {\n          className: \"w-5 h-5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 13\n    }, this), _jsxDEV(\"main\", {\n      className: \"flex-1 overflow-auto bg-gray-50/50 relative p-0 md:p-6\",\n      children: [_jsxDEV(\"div\", {\n        className: \"absolute inset-0 pattern-grid-lg opacity-[0.03] pointer-events-none hidden md:block\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 17\n      }, this), isMobile ? _jsxDEV(\"div\", {\n        className: \"flex flex-col h-full bg-gray-50\",\n        children: [_jsxDEV(\"div\", {\n          className: \"flex overflow-x-auto p-4 space-x-3 bg-white border-b border-gray-200 snap-x sticky top-0 z-20 shadow-sm no-scrollbar\",\n          children: DAYS.map(day => _jsxDEV(\"button\", {\n            onClick: () => setSelectedDay(day),\n            className: `flex-shrink-0 snap-start px-5 py-2.5 rounded-full font-bold text-sm transition-all border ${selectedDay === day ? 'bg-indigo-600 border-indigo-600 text-white shadow-md' : 'bg-white border-gray-200 text-gray-500'}`,\n            children: day.slice(0, 3)\n          }, day, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: \"flex-1 overflow-y-auto p-4\",\n          children: _jsxDEV(MobileDayView, {\n            day: selectedDay,\n            timetable: timetable,\n            teacherAssignments: teacherAssignments\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 21\n      }, this) : _jsxDEV(\"div\", {\n        className: \"bg-white rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-gray-100 overflow-hidden min-w-[1000px]\",\n        children: _jsxDEV(\"div\", {\n          className: \"grid gap-[1px] bg-gray-100\",\n          style: {\n            gridTemplateColumns: `80px repeat(${PERIODS.length}, 1fr)`\n          },\n          children: [_jsxDEV(\"div\", {\n            className: \"bg-gray-50/80 backdrop-blur p-4 z-10 sticky top-0 left-0 border-b border-gray-200\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 29\n          }, this), PERIODS.map(period => _jsxDEV(\"div\", {\n            className: \"text-center py-4 px-2 bg-gray-50/80 backdrop-blur z-10 sticky top-0 border-b border-gray-200\",\n            children: [_jsxDEV(\"div\", {\n              className: \"font-bold text-gray-700 text-xs uppercase tracking-wider mb-1\",\n              children: period.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 37\n            }, this), _jsxDEV(\"div\", {\n              className: \"text-[10px] font-medium text-gray-400 bg-white inline-block px-2 py-0.5 rounded-full border border-gray-100 shadow-sm\",\n              children: [formatTime12Hour(period.start), \" - \", formatTime12Hour(period.end)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 37\n            }, this)]\n          }, period.name, true, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 33\n          }, this)), DAYS.map(day => _jsxDEV(React.Fragment, {\n            children: [_jsxDEV(\"div\", {\n              className: \"bg-white font-bold text-gray-800 text-xs uppercase tracking-widest flex items-center justify-center p-4 border-r border-gray-100 sticky left-0 z-10 shadow-[4px_0_10px_rgba(0,0,0,0.02)]\",\n              children: day.slice(0, 3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 37\n            }, this), PERIODS.map(period => _jsxDEV(\"div\", {\n              className: \"bg-white min-h-[6rem]\",\n              children: _jsxDEV(TimetableCell, {\n                isBreak: period.isBreak,\n                subject: period.isBreak ? period.name : timetable[`${day}-${period.name}`] || null,\n                teacher: teacherAssignments[`${day}-${period.name}`] || null\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 45\n              }, this)\n            }, `${day}-${period.name}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 41\n            }, this))]\n          }, day, true, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 33\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 219,\n    columnNumber: 9\n  }, this);\n};\nexport default TimetableScreen;","map":{"version":3,"names":["React","useState","useEffect","SUBJECT_COLORS","CalendarIcon","RefreshIcon","supabase","jsxDEV","_jsxDEV","Fragment","_Fragment","formatTime12Hour","timeStr","hours","minutes","split","h","parseInt","ampm","PERIODS","name","start","end","isBreak","DAYS","TimetableCell","subject","teacher","className","children","fileName","_jsxFileName","lineNumber","columnNumber","colorClass","MobileDayView","day","timetable","teacherAssignments","map","period","idx","key","TimetableScreen","context","setTimetable","setTeacherAssignments","loading","setLoading","setClassName","isMobile","setIsMobile","window","innerWidth","selectedDay","setSelectedDay","Date","getDay","handleResize","addEventListener","removeEventListener","fetchData","targetClassName","userType","data","student","from","select","eq","userId","single","grade","section","query","ilike","error","length","newTimetable","newTeachers","teacherIds","Set","d","teacher_id","filter","Boolean","teachersData","in","teacherMap","Map","t","id","getPeriodName","timeShort","substring","p","find","forEach","entry","pName","start_time","get","class_name","err","console","onClick","location","reload","slice","style","gridTemplateColumns"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/shared/TimetableScreen.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport { SUBJECT_COLORS, CalendarIcon, ChevronLeftIcon, RefreshIcon } from '../../constants';\r\nimport { TimetableEntry } from '../../types';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\n// --- CONSTANTS & HELPERS (Matched with Admin UI) ---\r\nconst formatTime12Hour = (timeStr: string) => {\r\n    if (!timeStr) return '';\r\n    const [hours, minutes] = timeStr.split(':');\r\n    let h = parseInt(hours, 10);\r\n    const ampm = h >= 12 ? 'PM' : 'AM';\r\n    h = h % 12;\r\n    h = h ? h : 12;\r\n    return `${h}:${minutes} ${ampm}`;\r\n};\r\n\r\nconst PERIODS = [\r\n    { name: 'Period 1', start: '09:00', end: '09:45' },\r\n    { name: 'Period 2', start: '09:45', end: '10:30' },\r\n    { name: 'Period 3', start: '10:30', end: '11:15' },\r\n    { name: 'Short Break', start: '11:15', end: '11:30', isBreak: true },\r\n    { name: 'Period 4', start: '11:30', end: '12:15' },\r\n    { name: 'Period 5', start: '12:15', end: '13:00' },\r\n    { name: 'Long Break', start: '13:00', end: '13:45', isBreak: true },\r\n    { name: 'Period 6', start: '13:45', end: '14:30' },\r\n    { name: 'Period 7', start: '14:30', end: '15:15' },\r\n    { name: 'Period 8', start: '15:15', end: '16:00' },\r\n];\r\n\r\nconst DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];\r\n\r\n// --- SUB-COMPONENTS (Read-Only) ---\r\n\r\nconst TimetableCell: React.FC<{ subject: string | null; teacher: string | null; isBreak?: boolean }> = ({ subject, teacher, isBreak }) => {\r\n    if (isBreak) {\r\n        return (\r\n            <div className=\"h-full min-h-[5rem] bg-gray-100/50 flex items-center justify-center relative overflow-hidden group\">\r\n                <div className=\"absolute inset-0 pattern-diagonal-lines opacity-10\"></div>\r\n                <span className=\"text-[10px] font-bold text-gray-400 uppercase tracking-widest -rotate-90 md:rotate-0 whitespace-nowrap z-10\">{subject}</span>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const colorClass = subject ? SUBJECT_COLORS[subject] : 'bg-white';\r\n\r\n    return (\r\n        <div className={`\r\n            h-full min-h-[5rem] border border-gray-100 md:border-transparent flex flex-col items-center justify-center p-1 relative transition-all duration-200\r\n            ${subject ? `${colorClass} shadow-sm` : 'bg-white'}\r\n        `}>\r\n            {subject ? (\r\n                <>\r\n                    <span className=\"font-bold text-xs md:text-sm text-center leading-tight px-1\">{subject}</span>\r\n                    {teacher && <span className=\"text-[10px] md:text-xs mt-1 opacity-75 font-medium truncate max-w-full px-1\">{teacher}</span>}\r\n                </>\r\n            ) : (\r\n                <div className=\"w-full h-full flex items-center justify-center\">\r\n                    <span className=\"text-gray-200 text-xs font-medium\">-</span>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst MobileDayView: React.FC<{ day: string; timetable: { [key: string]: string | null }; teacherAssignments: { [key: string]: string | null } }> = ({ day, timetable, teacherAssignments }) => {\r\n    return (\r\n        <div className=\"space-y-4 pb-24\">\r\n            {PERIODS.map((period, idx) => {\r\n                if (period.isBreak) return (\r\n                    <div key={idx} className=\"flex items-center justify-center py-4 bg-gray-50/50 rounded-2xl border border-gray-100 border-dashed\">\r\n                        <span className=\"text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em]\">{period.name}</span>\r\n                    </div>\r\n                );\r\n\r\n                const key = `${day}-${period.name}`;\r\n                const subject = timetable[key];\r\n                const teacher = teacherAssignments[key];\r\n                const colorClass = subject ? SUBJECT_COLORS[subject] : 'bg-white border border-gray-200';\r\n\r\n                return (\r\n                    <div key={idx} className={`w-full text-left p-0 rounded-2xl shadow-sm overflow-hidden flex ${!subject ? 'bg-white border border-gray-200' : 'shadow-md'}`}>\r\n                        {/* Time Column */}\r\n                        <div className=\"w-20 bg-gray-50 border-r border-gray-100 p-4 flex flex-col justify-center items-center text-center\">\r\n                            <span className=\"font-bold text-gray-700 text-sm leading-none\">{period.name.split(' ')[1] || period.name}</span>\r\n                            <span className=\"text-[10px] font-medium text-gray-400 mt-1 leading-tight\">{formatTime12Hour(period.start)}<br />{formatTime12Hour(period.end)}</span>\r\n                        </div>\r\n\r\n                        {/* Content Column */}\r\n                        <div className={`flex-1 p-4 flex items-center justify-between ${subject ? colorClass : ''}`}>\r\n                            <div>\r\n                                <h4 className={`font-bold text-base ${!subject ? 'text-gray-400 italic' : ''}`}>{subject || 'Free Period'}</h4>\r\n                                {teacher && <span className=\"text-xs opacity-75 mt-0.5 block font-medium\">{teacher}</span>}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n};\r\n\r\ninterface TimetableScreenProps {\r\n    context: {\r\n        userType: 'teacher' | 'student';\r\n        userId: number;\r\n    },\r\n    title?: string; // Optional title override\r\n}\r\n\r\nconst TimetableScreen: React.FC<TimetableScreenProps> = ({ context }) => {\r\n    const [timetable, setTimetable] = useState<{ [key: string]: string | null }>({});\r\n    const [teacherAssignments, setTeacherAssignments] = useState<{ [key: string]: string | null }>({});\r\n    const [loading, setLoading] = useState(true);\r\n    const [className, setClassName] = useState('');\r\n\r\n    // UI State\r\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 1024);\r\n    const [selectedDay, setSelectedDay] = useState(DAYS[(new Date().getDay() - 1)] || 'Monday');\r\n\r\n    useEffect(() => {\r\n        const handleResize = () => setIsMobile(window.innerWidth < 1024);\r\n        window.addEventListener('resize', handleResize);\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            setLoading(true);\r\n            try {\r\n                let targetClassName = '';\r\n\r\n                // 1. Identify Target Class/Teacher\r\n                if (context.userType === 'student' || context.userType === 'parent') { // Handle parent context too if shared\r\n                    const { data: student } = await supabase\r\n                        .from('students')\r\n                        .select('grade, section')\r\n                        .eq('id', context.userId)\r\n                        .single();\r\n\r\n                    if (student) {\r\n                        targetClassName = `${student.grade}${student.section}`; // Matches partial search usually\r\n                    }\r\n                }\r\n\r\n                // 2. Fetch Timetable Data\r\n                let query = supabase.from('timetable').select('day, start_time, end_time, subject, class_name, teacher_id').eq('status', 'Published');\r\n\r\n                if (context.userType === 'teacher') {\r\n                    query = query.eq('teacher_id', context.userId);\r\n                } else if (targetClassName) {\r\n                    // We use ILIKE pattern matching for class name (e.g. \"JSS1A\" matches \"JSS 1 A\")\r\n                    // But simpler is to filter client side or improve query if exact name known.\r\n                    // The logic in original file used ilike %pattern%.\r\n                    query = query.ilike('class_name', `%${targetClassName}%`);\r\n                }\r\n\r\n                const { data, error } = await query;\r\n                if (error) throw error;\r\n\r\n                if (data && data.length > 0) {\r\n                    // 3. Transform Data to Map\r\n                    const newTimetable: { [key: string]: string | null } = {};\r\n                    const newTeachers: { [key: string]: string | null } = {};\r\n\r\n                    // We need to fetch teacher names optionally if we have teacher_ids\r\n                    const teacherIds = [...new Set(data.map(d => d.teacher_id).filter(Boolean))];\r\n                    const { data: teachersData } = await supabase.from('teachers').select('id, name').in('id', teacherIds);\r\n                    const teacherMap = new Map((teachersData || []).map(t => [t.id, t.name]));\r\n\r\n                    // Helper to map DB time string \"09:00:00\" -> Period Name\r\n                    const getPeriodName = (start: string) => {\r\n                        // DB might return \"09:00:00\", PERIODS has \"09:00\"\r\n                        const timeShort = start.substring(0, 5);\r\n                        const p = PERIODS.find(p => p.start === timeShort);\r\n                        return p ? p.name : null;\r\n                    };\r\n\r\n                    data.forEach((entry: any) => {\r\n                        const pName = getPeriodName(entry.start_time);\r\n                        if (pName) {\r\n                            const key = `${entry.day}-${pName}`;\r\n                            newTimetable[key] = entry.subject;\r\n                            if (entry.teacher_id) {\r\n                                newTeachers[key] = teacherMap.get(entry.teacher_id) || null;\r\n                            }\r\n                            if (!className) setClassName(entry.class_name);\r\n                        }\r\n                    });\r\n\r\n                    setTimetable(newTimetable);\r\n                    setTeacherAssignments(newTeachers);\r\n                    if (!className && data.length > 0) setClassName(data[0].class_name);\r\n                } else {\r\n                    // No data found\r\n                    setTimetable({});\r\n                    setTeacherAssignments({});\r\n                }\r\n\r\n            } catch (err) {\r\n                console.error('Error fetching timetable:', err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, [context]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-full bg-white/50\">\r\n                <div className=\"animate-spin rounded-full h-10 w-10 border-4 border-gray-200 border-t-indigo-600\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-gray-50 relative animate-fade-in\">\r\n            {/* Header */}\r\n            <div className=\"bg-white border-b border-gray-200 p-4 sticky top-0 z-30 shadow-sm flex justify-between items-center\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"bg-indigo-100 p-2 rounded-lg\">\r\n                        <CalendarIcon className=\"w-6 h-6 text-indigo-600\" />\r\n                    </div>\r\n                    <div>\r\n                        <h2 className=\"text-xl font-bold text-gray-900\">{className || 'My Timetable'}</h2>\r\n                        <p className=\"text-xs text-gray-500 font-medium\">Weekly Schedule</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <button onClick={() => window.location.reload()} className=\"p-2 hover:bg-gray-100 rounded-full transition-colors text-gray-400 hover:text-gray-600\">\r\n                    <RefreshIcon className=\"w-5 h-5\" />\r\n                </button>\r\n            </div>\r\n\r\n            <main className=\"flex-1 overflow-auto bg-gray-50/50 relative p-0 md:p-6\">\r\n                {/* Background Pattern */}\r\n                <div className=\"absolute inset-0 pattern-grid-lg opacity-[0.03] pointer-events-none hidden md:block\"></div>\r\n\r\n                {isMobile ? (\r\n                    <div className=\"flex flex-col h-full bg-gray-50\">\r\n                        {/* Day Tabs */}\r\n                        <div className=\"flex overflow-x-auto p-4 space-x-3 bg-white border-b border-gray-200 snap-x sticky top-0 z-20 shadow-sm no-scrollbar\">\r\n                            {DAYS.map(day => (\r\n                                <button\r\n                                    key={day}\r\n                                    onClick={() => setSelectedDay(day)}\r\n                                    className={`flex-shrink-0 snap-start px-5 py-2.5 rounded-full font-bold text-sm transition-all border ${selectedDay === day ? 'bg-indigo-600 border-indigo-600 text-white shadow-md' : 'bg-white border-gray-200 text-gray-500'}`}\r\n                                >\r\n                                    {day.slice(0, 3)}\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                        <div className=\"flex-1 overflow-y-auto p-4\">\r\n                            <MobileDayView day={selectedDay} timetable={timetable} teacherAssignments={teacherAssignments} />\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"bg-white rounded-3xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-gray-100 overflow-hidden min-w-[1000px]\">\r\n                        <div className=\"grid gap-[1px] bg-gray-100\" style={{ gridTemplateColumns: `80px repeat(${PERIODS.length}, 1fr)` }}>\r\n                            {/* Header Row */}\r\n                            <div className=\"bg-gray-50/80 backdrop-blur p-4 z-10 sticky top-0 left-0 border-b border-gray-200\"></div>\r\n                            {PERIODS.map(period => (\r\n                                <div key={period.name} className=\"text-center py-4 px-2 bg-gray-50/80 backdrop-blur z-10 sticky top-0 border-b border-gray-200\">\r\n                                    <div className=\"font-bold text-gray-700 text-xs uppercase tracking-wider mb-1\">{period.name}</div>\r\n                                    <div className=\"text-[10px] font-medium text-gray-400 bg-white inline-block px-2 py-0.5 rounded-full border border-gray-100 shadow-sm\">\r\n                                        {formatTime12Hour(period.start)} - {formatTime12Hour(period.end)}\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n\r\n                            {/* Data Rows */}\r\n                            {DAYS.map(day => (\r\n                                <React.Fragment key={day}>\r\n                                    <div className=\"bg-white font-bold text-gray-800 text-xs uppercase tracking-widest flex items-center justify-center p-4 border-r border-gray-100 sticky left-0 z-10 shadow-[4px_0_10px_rgba(0,0,0,0.02)]\">\r\n                                        {day.slice(0, 3)}\r\n                                    </div>\r\n                                    {PERIODS.map(period => (\r\n                                        <div key={`${day}-${period.name}`} className=\"bg-white min-h-[6rem]\">\r\n                                            <TimetableCell\r\n                                                isBreak={period.isBreak}\r\n                                                subject={period.isBreak ? period.name : timetable[`${day}-${period.name}`] || null}\r\n                                                teacher={teacherAssignments[`${day}-${period.name}`] || null}\r\n                                            />\r\n                                        </div>\r\n                                    ))}\r\n                                </React.Fragment>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default TimetableScreen;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}