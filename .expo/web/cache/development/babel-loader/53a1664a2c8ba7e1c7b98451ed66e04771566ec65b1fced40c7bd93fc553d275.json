{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\OneDrive\\\\Desktop\\\\Project\\\\school-app-\\\\components\\\\payments\\\\MobileMoneyWrapper.tsx\";\nimport React, { useState } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { initializeTransaction, verifyTransaction } from '../../lib/payments';\nimport { supabase } from '../../lib/supabase';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const MobileMoneyWrapper = ({\n  fee,\n  email,\n  name,\n  onSuccess,\n  onClose\n}) => {\n  const [provider, setProvider] = useState('mpesa');\n  const [phoneNumber, setPhoneNumber] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [showModal, setShowModal] = useState(false);\n  const publicKey = import.meta.env.VITE_PAYSTACK_PUBLIC_KEY || 'pk_test_placeholder';\n  const getProviderCode = provider => {\n    switch (provider) {\n      case 'mpesa':\n        return 'mpesa';\n      case 'mtn':\n        return 'mtn';\n      case 'airtel':\n        return 'ATM';\n      default:\n        return 'mpesa';\n    }\n  };\n  const handlePayment = async () => {\n    if (!phoneNumber) {\n      toast.error('Please enter your mobile money number');\n      return;\n    }\n    setLoading(true);\n    try {\n      const reference = `MM-${Date.now()}-${fee.id}`;\n      await initializeTransaction(fee.id, fee.studentId, fee.amount, reference, 'Mobile Money');\n      const response = await fetch('https://api.paystack.co/transaction/initialize', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${publicKey.replace('pk_', 'sk_')}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: email,\n          amount: fee.amount * 100,\n          currency: 'NGN',\n          reference: reference,\n          mobile_money: {\n            phone: phoneNumber,\n            provider: getProviderCode(provider)\n          },\n          metadata: {\n            fee_id: fee.id,\n            student_id: fee.studentId,\n            fee_title: fee.title,\n            custom_fields: [{\n              display_name: 'Fee Title',\n              variable_name: 'fee_title',\n              value: fee.title\n            }, {\n              display_name: 'Student ID',\n              variable_name: 'student_id',\n              value: fee.studentId.toString()\n            }]\n          }\n        })\n      });\n      const data = await response.json();\n      if (data.status && data.data) {\n        toast.success(`Payment initiated! Check your phone for a prompt from ${provider.toUpperCase()}.`, {\n          duration: 6000\n        });\n        pollPaymentStatus(reference);\n      } else {\n        throw new Error(data.message || 'Failed to initialize payment');\n      }\n    } catch (error) {\n      console.error('Mobile money payment error:', error);\n      toast.error('Failed to initialize mobile money payment. Please try again.');\n      setLoading(false);\n    }\n  };\n  const pollPaymentStatus = async reference => {\n    let attempts = 0;\n    const maxAttempts = 60;\n    const interval = setInterval(async () => {\n      attempts++;\n      try {\n        const result = await verifyTransaction(reference);\n        if (result.success) {\n          clearInterval(interval);\n          setLoading(false);\n          try {\n            const {\n              data: transaction\n            } = await supabase.from('transactions').select('id').eq('reference', reference).single();\n            if (transaction?.id) {\n              const {\n                sendPaymentConfirmation\n              } = await import('../../lib/payment-notifications');\n              await sendPaymentConfirmation({\n                transactionId: transaction.id\n              });\n            }\n          } catch (notifError) {\n            console.error('Error sending payment notification:', notifError);\n          }\n          if (onSuccess) onSuccess();\n        }\n      } catch (error) {\n        console.error('Polling error:', error);\n      }\n      if (attempts >= maxAttempts) {\n        clearInterval(interval);\n        setLoading(false);\n        toast.error('Payment verification timed out. Please check your transaction history.');\n      }\n    }, 5000);\n  };\n  const getProviderInfo = provider => {\n    switch (provider) {\n      case 'mpesa':\n        return {\n          name: 'M-Pesa',\n          color: 'green',\n          countries: 'Kenya, Tanzania'\n        };\n      case 'mtn':\n        return {\n          name: 'MTN Mobile Money',\n          color: 'yellow',\n          countries: 'Ghana, Uganda, Nigeria'\n        };\n      case 'airtel':\n        return {\n          name: 'Airtel Money',\n          color: 'red',\n          countries: 'Kenya, Uganda, Nigeria'\n        };\n    }\n  };\n  return _jsxDEV(_Fragment, {\n    children: [_jsxDEV(\"button\", {\n      onClick: () => setShowModal(true),\n      className: \"hidden\",\n      id: `mobilemoney-btn-${fee.id}`,\n      children: \"Pay with Mobile Money\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }, this), showModal && _jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\",\n      children: _jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl w-full max-w-md p-6\",\n        children: [_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-900 mb-4\",\n          children: \"Mobile Money Payment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: \"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6\",\n          children: [_jsxDEV(\"p\", {\n            className: \"text-sm text-indigo-700 mb-1\",\n            children: \"Payment Amount\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 29\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-3xl font-bold text-indigo-900\",\n            children: new Intl.NumberFormat('en-NG', {\n              style: 'currency',\n              currency: 'NGN'\n            }).format(fee.amount)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Select Provider\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 29\n          }, this), _jsxDEV(\"div\", {\n            className: \"grid grid-cols-3 gap-2\",\n            children: ['mpesa', 'mtn', 'airtel'].map(p => {\n              const info = getProviderInfo(p);\n              return _jsxDEV(\"button\", {\n                onClick: () => setProvider(p),\n                className: `px-3 py-3 rounded-lg border-2 font-medium transition ${provider === p ? 'border-indigo-600 bg-indigo-50 text-indigo-700' : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'}`,\n                children: _jsxDEV(\"div\", {\n                  className: \"text-xs\",\n                  children: info.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 214,\n                  columnNumber: 45\n                }, this)\n              }, p, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 41\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 29\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 mt-2\",\n            children: [\"Available in: \", getProviderInfo(provider).countries]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: \"mb-6\",\n          children: [_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Mobile Money Number\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 29\n          }, this), _jsxDEV(\"input\", {\n            type: \"tel\",\n            value: phoneNumber,\n            onChange: e => setPhoneNumber(e.target.value),\n            placeholder: \"e.g., 0712345678\",\n            className: \"w-full border border-gray-300 rounded-lg px-4 py-3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 29\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500 mt-1\",\n            children: [\"Enter the number registered with \", getProviderInfo(provider).name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: \"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-6\",\n          children: _jsxDEV(\"p\", {\n            className: \"text-sm text-blue-800\",\n            children: \"You'll receive a payment prompt on your phone. Complete the transaction to proceed.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 25\n        }, this), _jsxDEV(\"div\", {\n          className: \"flex gap-3\",\n          children: [_jsxDEV(\"button\", {\n            onClick: () => {\n              setShowModal(false);\n              if (onClose) onClose();\n            },\n            disabled: loading,\n            className: \"flex-1 px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 29\n          }, this), _jsxDEV(\"button\", {\n            onClick: handlePayment,\n            disabled: loading || !phoneNumber,\n            className: \"flex-1 px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 disabled:opacity-50 transition\",\n            children: loading ? 'Processing...' : 'Pay Now'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 25\n        }, this), loading && _jsxDEV(\"div\", {\n          className: \"mt-4 text-center\",\n          children: [_jsxDEV(\"div\", {\n            className: \"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 33\n          }, this), _jsxDEV(\"p\", {\n            className: \"text-sm text-gray-600 mt-2\",\n            children: \"Waiting for payment confirmation...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true);\n};","map":{"version":3,"names":["React","useState","toast","initializeTransaction","verifyTransaction","supabase","jsxDEV","_jsxDEV","Fragment","_Fragment","MobileMoneyWrapper","fee","email","name","onSuccess","onClose","provider","setProvider","phoneNumber","setPhoneNumber","loading","setLoading","showModal","setShowModal","publicKey","import","meta","env","VITE_PAYSTACK_PUBLIC_KEY","getProviderCode","handlePayment","error","reference","Date","now","id","studentId","amount","response","fetch","method","headers","replace","body","JSON","stringify","currency","mobile_money","phone","metadata","fee_id","student_id","fee_title","title","custom_fields","display_name","variable_name","value","toString","data","json","status","success","toUpperCase","duration","pollPaymentStatus","Error","message","console","attempts","maxAttempts","interval","setInterval","result","clearInterval","transaction","from","select","eq","single","sendPaymentConfirmation","transactionId","notifError","getProviderInfo","color","countries","children","onClick","className","fileName","_jsxFileName","lineNumber","columnNumber","Intl","NumberFormat","style","format","map","p","info","type","onChange","e","target","placeholder","disabled"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/components/payments/MobileMoneyWrapper.tsx"],"sourcesContent":["/**\r\n * Mobile Money Payment Wrapper\r\n * Supports M-Pesa, MTN Mobile Money, and Airtel Money via Paystack\r\n */\r\n\r\nimport React, { useState } from 'react';\r\nimport { toast } from 'react-hot-toast';\r\nimport { Fee } from '../../types';\r\nimport { initializeTransaction, verifyTransaction } from '../../lib/payments';\r\nimport { supabase } from '../../lib/supabase';\r\n\r\ninterface MobileMoneyWrapperProps {\r\n    fee: Fee;\r\n    email: string;\r\n    name: string;\r\n    onSuccess?: () => void;\r\n    onClose?: () => void;\r\n}\r\n\r\ntype MobileMoneyProvider = 'mpesa' | 'mtn' | 'airtel';\r\n\r\nexport const MobileMoneyWrapper: React.FC<MobileMoneyWrapperProps> = ({\r\n    fee,\r\n    email,\r\n    name,\r\n    onSuccess,\r\n    onClose\r\n}) => {\r\n    const [provider, setProvider] = useState<MobileMoneyProvider>('mpesa');\r\n    const [phoneNumber, setPhoneNumber] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    const publicKey = import.meta.env.VITE_PAYSTACK_PUBLIC_KEY || 'pk_test_placeholder';\r\n\r\n    const getProviderCode = (provider: MobileMoneyProvider): string => {\r\n        switch (provider) {\r\n            case 'mpesa':\r\n                return 'mpesa'; // Kenya\r\n            case 'mtn':\r\n                return 'mtn'; // Ghana, Uganda, etc.\r\n            case 'airtel':\r\n                return 'ATM'; // Airtel Money\r\n            default:\r\n                return 'mpesa';\r\n        }\r\n    };\r\n\r\n    const handlePayment = async () => {\r\n        if (!phoneNumber) {\r\n            toast.error('Please enter your mobile money number');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n\r\n        try {\r\n            const reference = `MM-${Date.now()}-${fee.id}`;\r\n\r\n            // Create pending transaction\r\n            await initializeTransaction(\r\n                fee.id,\r\n                fee.studentId,\r\n                fee.amount,\r\n                reference,\r\n                'Mobile Money'\r\n            );\r\n\r\n            // Initialize Paystack Mobile Money payment\r\n            const response = await fetch('https://api.paystack.co/transaction/initialize', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': `Bearer ${publicKey.replace('pk_', 'sk_')}`, // Note: This should use secret key\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    email: email,\r\n                    amount: fee.amount * 100, // Convert to kobo\r\n                    currency: 'NGN',\r\n                    reference: reference,\r\n                    mobile_money: {\r\n                        phone: phoneNumber,\r\n                        provider: getProviderCode(provider)\r\n                    },\r\n                    metadata: {\r\n                        fee_id: fee.id,\r\n                        student_id: fee.studentId,\r\n                        fee_title: fee.title,\r\n                        custom_fields: [\r\n                            { display_name: 'Fee Title', variable_name: 'fee_title', value: fee.title },\r\n                            { display_name: 'Student ID', variable_name: 'student_id', value: fee.studentId.toString() }\r\n                        ]\r\n                    }\r\n                })\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (data.status && data.data) {\r\n                // Show USSD prompt or payment instructions\r\n                // Show USSD prompt or payment instructions\r\n                toast.success(\r\n                    `Payment initiated! Check your phone for a prompt from ${provider.toUpperCase()}.`,\r\n                    { duration: 6000 }\r\n                );\r\n\r\n                // Poll for payment status\r\n                pollPaymentStatus(reference);\r\n            } else {\r\n                throw new Error(data.message || 'Failed to initialize payment');\r\n            }\r\n        } catch (error) {\r\n            console.error('Mobile money payment error:', error);\r\n            toast.error('Failed to initialize mobile money payment. Please try again.');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const pollPaymentStatus = async (reference: string) => {\r\n        let attempts = 0;\r\n        const maxAttempts = 60; // Poll for up to 5 minutes\r\n\r\n        const interval = setInterval(async () => {\r\n            attempts++;\r\n\r\n            try {\r\n                const result = await verifyTransaction(reference);\r\n\r\n                if (result.success) {\r\n                    clearInterval(interval);\r\n                    setLoading(false);\r\n\r\n                    // Send payment confirmation\r\n                    try {\r\n                        const { data: transaction } = await supabase\r\n                            .from('transactions')\r\n                            .select('id')\r\n                            .eq('reference', reference)\r\n                            .single();\r\n\r\n                        if (transaction?.id) {\r\n                            const { sendPaymentConfirmation } = await import('../../lib/payment-notifications');\r\n                            await sendPaymentConfirmation({ transactionId: transaction.id });\r\n                        }\r\n                    } catch (notifError) {\r\n                        console.error('Error sending payment notification:', notifError);\r\n                    }\r\n\r\n                    if (onSuccess) onSuccess();\r\n                }\r\n            } catch (error) {\r\n                console.error('Polling error:', error);\r\n            }\r\n\r\n            if (attempts >= maxAttempts) {\r\n                clearInterval(interval);\r\n                setLoading(false);\r\n                toast.error('Payment verification timed out. Please check your transaction history.');\r\n            }\r\n        }, 5000); // Poll every 5 seconds\r\n    };\r\n\r\n    const getProviderInfo = (provider: MobileMoneyProvider) => {\r\n        switch (provider) {\r\n            case 'mpesa':\r\n                return { name: 'M-Pesa', color: 'green', countries: 'Kenya, Tanzania' };\r\n            case 'mtn':\r\n                return { name: 'MTN Mobile Money', color: 'yellow', countries: 'Ghana, Uganda, Nigeria' };\r\n            case 'airtel':\r\n                return { name: 'Airtel Money', color: 'red', countries: 'Kenya, Uganda, Nigeria' };\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                onClick={() => setShowModal(true)}\r\n                className=\"hidden\"\r\n                id={`mobilemoney-btn-${fee.id}`}\r\n            >\r\n                Pay with Mobile Money\r\n            </button>\r\n\r\n            {showModal && (\r\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n                    <div className=\"bg-white rounded-2xl w-full max-w-md p-6\">\r\n                        <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Mobile Money Payment</h2>\r\n\r\n                        {/* Amount */}\r\n                        <div className=\"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6\">\r\n                            <p className=\"text-sm text-indigo-700 mb-1\">Payment Amount</p>\r\n                            <p className=\"text-3xl font-bold text-indigo-900\">\r\n                                {new Intl.NumberFormat('en-NG', { style: 'currency', currency: 'NGN' }).format(fee.amount)}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Provider Selection */}\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Select Provider\r\n                            </label>\r\n                            <div className=\"grid grid-cols-3 gap-2\">\r\n                                {(['mpesa', 'mtn', 'airtel'] as MobileMoneyProvider[]).map((p) => {\r\n                                    const info = getProviderInfo(p);\r\n                                    return (\r\n                                        <button\r\n                                            key={p}\r\n                                            onClick={() => setProvider(p)}\r\n                                            className={`px-3 py-3 rounded-lg border-2 font-medium transition ${provider === p\r\n                                                ? 'border-indigo-600 bg-indigo-50 text-indigo-700'\r\n                                                : 'border-gray-200 bg-white text-gray-700 hover:border-gray-300'\r\n                                                }`}\r\n                                        >\r\n                                            <div className=\"text-xs\">{info.name}</div>\r\n                                        </button>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                            <p className=\"text-xs text-gray-500 mt-2\">\r\n                                Available in: {getProviderInfo(provider).countries}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Phone Number */}\r\n                        <div className=\"mb-6\">\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                Mobile Money Number\r\n                            </label>\r\n                            <input\r\n                                type=\"tel\"\r\n                                value={phoneNumber}\r\n                                onChange={(e) => setPhoneNumber(e.target.value)}\r\n                                placeholder=\"e.g., 0712345678\"\r\n                                className=\"w-full border border-gray-300 rounded-lg px-4 py-3\"\r\n                            />\r\n                            <p className=\"text-xs text-gray-500 mt-1\">\r\n                                Enter the number registered with {getProviderInfo(provider).name}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Info */}\r\n                        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-6\">\r\n                            <p className=\"text-sm text-blue-800\">\r\n                                You'll receive a payment prompt on your phone. Complete the transaction to proceed.\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"flex gap-3\">\r\n                            <button\r\n                                onClick={() => {\r\n                                    setShowModal(false);\r\n                                    if (onClose) onClose();\r\n                                }}\r\n                                disabled={loading}\r\n                                className=\"flex-1 px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition\"\r\n                            >\r\n                                Cancel\r\n                            </button>\r\n                            <button\r\n                                onClick={handlePayment}\r\n                                disabled={loading || !phoneNumber}\r\n                                className=\"flex-1 px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 disabled:opacity-50 transition\"\r\n                            >\r\n                                {loading ? 'Processing...' : 'Pay Now'}\r\n                            </button>\r\n                        </div>\r\n\r\n                        {loading && (\r\n                            <div className=\"mt-4 text-center\">\r\n                                <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600\"></div>\r\n                                <p className=\"text-sm text-gray-600 mt-2\">\r\n                                    Waiting for payment confirmation...\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}