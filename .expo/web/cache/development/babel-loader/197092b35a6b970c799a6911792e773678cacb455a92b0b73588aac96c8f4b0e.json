{"ast":null,"code":"export const GEMINI_MODEL_NAME = \"gemini-2.5-flash\";\nexport const AI_MODEL_NAME = GEMINI_MODEL_NAME;\nexport const AI_GENERATION_CONFIG = {\n  responseMimeType: \"application/json\"\n};\nexport let SchemaType = function (SchemaType) {\n  SchemaType[\"STRING\"] = \"STRING\";\n  SchemaType[\"NUMBER\"] = \"NUMBER\";\n  SchemaType[\"INTEGER\"] = \"INTEGER\";\n  SchemaType[\"BOOLEAN\"] = \"BOOLEAN\";\n  SchemaType[\"ARRAY\"] = \"ARRAY\";\n  SchemaType[\"OBJECT\"] = \"OBJECT\";\n  return SchemaType;\n}({});\nexport class GeminiClient {\n  constructor(apiKey, options = {}) {\n    this.apiKey = apiKey;\n    this.defaultModelName = options.model || GEMINI_MODEL_NAME;\n  }\n  async generateContent(params) {\n    if (!this.apiKey) {\n      return {\n        text: \"Error: AI API Key is missing. Please check your settings.\"\n      };\n    }\n    let model = this.defaultModelName;\n    let contents = params;\n    let generationConfig = {};\n    let systemInstruction = undefined;\n    if (params && typeof params === 'object' && !Array.isArray(params) && params.contents) {\n      model = params.model || this.defaultModelName;\n      contents = params.contents;\n      generationConfig = params.generationConfig || params.config || {};\n      if (params.systemInstruction) {\n        systemInstruction = params.systemInstruction;\n      } else if (generationConfig && generationConfig.systemInstruction) {\n        systemInstruction = generationConfig.systemInstruction;\n        delete generationConfig.systemInstruction;\n      }\n    }\n    let finalContents = [];\n    if (typeof contents === 'string') {\n      finalContents = [{\n        role: 'user',\n        parts: [{\n          text: contents\n        }]\n      }];\n    } else if (contents.parts) {\n      finalContents = [{\n        role: 'user',\n        parts: contents.parts\n      }];\n    } else if (Array.isArray(contents)) {\n      finalContents = contents;\n    } else {\n      finalContents = [contents];\n    }\n    finalContents = finalContents.map(c => {\n      if (c.role && c.parts) return c;\n      if (typeof c === 'string') return {\n        role: 'user',\n        parts: [{\n          text: c\n        }]\n      };\n      return {\n        role: 'user',\n        parts: [{\n          text: JSON.stringify(c)\n        }]\n      };\n    });\n    const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.apiKey}`;\n    const requestBody = {\n      contents: finalContents,\n      generationConfig: generationConfig\n    };\n    if (systemInstruction) {\n      requestBody.systemInstruction = systemInstruction;\n    }\n    const makeRequest = async (retries = 3, delay = 2000) => {\n      try {\n        const response = await fetch(url, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(requestBody)\n        });\n        if (response.status === 429) {\n          if (retries > 0) {\n            console.warn(`Gemini Rate Limit Exceeded. Retrying in ${delay}ms... (${retries} retries left)`);\n            await new Promise(resolve => setTimeout(resolve, delay));\n            return makeRequest(retries - 1, delay * 2);\n          } else {\n            throw new Error(\"AI Busy: Too many requests. Please wait a minute and try again.\");\n          }\n        }\n        if (!response.ok) {\n          const errorText = await response.text();\n          console.error(`Gemini API Error ${response.status}: ${errorText}`);\n          throw new Error(`Gemini API Error: ${response.statusText}`);\n        }\n        const data = await response.json();\n        const text = data.candidates?.[0]?.content?.parts?.[0]?.text || \"\";\n        return {\n          text: text,\n          candidates: data.candidates,\n          promptFeedback: data.promptFeedback,\n          response: {\n            text: () => text,\n            candidates: data.candidates\n          }\n        };\n      } catch (error) {\n        if (error.message.includes(\"AI Busy\")) throw error;\n        throw error;\n      }\n    };\n    try {\n      return await makeRequest();\n    } catch (error) {\n      console.error(\"Gemini Request Failed:\", error);\n      return {\n        text: `AI Error: ${error.message || \"Connection failed\"}`,\n        error: error\n      };\n    }\n  }\n  get models() {\n    return {\n      generateContent: this.generateContent.bind(this),\n      generateVideos: async () => {\n        console.warn(\"Video generation stub called.\");\n        throw new Error(\"Video generation is currently unavailable.\");\n      }\n    };\n  }\n  get live() {\n    return {\n      connect: async () => {\n        console.warn(\"Live stub called.\");\n        throw new Error(\"Live voice features are currently unavailable.\");\n      }\n    };\n  }\n  async chat(params) {\n    const history = params.messages || [];\n    const model = params.model || this.defaultModelName;\n    const config = params.config;\n    return {\n      sendMessage: async msg => {\n        const userMsg = typeof msg === 'string' ? {\n          role: 'user',\n          parts: [{\n            text: msg\n          }]\n        } : msg;\n        const newHistory = [...history, userMsg];\n        const result = await this.generateContent({\n          model: model,\n          contents: newHistory,\n          config: config\n        });\n        return result;\n      },\n      sendMessageStream: async msg => {\n        console.warn(\"Streaming not implemented in basic fetch client.\");\n        const result = await this.generateContent({\n          model: model,\n          contents: [...history, typeof msg === 'string' ? {\n            role: 'user',\n            parts: [{\n              text: msg\n            }]\n          } : msg],\n          config: config\n        });\n        return {\n          stream: async function* () {\n            yield {\n              text: () => result.text\n            };\n          }(),\n          response: Promise.resolve(result)\n        };\n      }\n    };\n  }\n  startChat(config) {\n    return {\n      sendMessage: async msg => this.generateContent({\n        model: this.defaultModelName,\n        contents: [...(config.history || []), {\n          role: 'user',\n          parts: [{\n            text: msg\n          }]\n        }]\n      }),\n      sendMessageStream: async msg => {\n        const res = await this.generateContent({\n          model: this.defaultModelName,\n          contents: [...(config.history || []), {\n            role: 'user',\n            parts: [{\n              text: msg\n            }]\n          }]\n        });\n        return {\n          stream: async function* () {\n            yield {\n              text: () => res.text\n            };\n          }(),\n          response: Promise.resolve(res)\n        };\n      }\n    };\n  }\n}\nlet aiClientInstance = null;\nlet aiClientInstanceKey = null;\nexport const getAIClient = apiKey => {\n  let envKey = '';\n  try {\n    if (typeof import.meta !== 'undefined' && import.meta.env) {\n      envKey = import.meta.env.VITE_GEMINI_API_KEY;\n    } else if (typeof process !== 'undefined' && process.env) {\n      envKey = process.env.VITE_GEMINI_API_KEY || '';\n    }\n  } catch (e) {\n    console.warn(\"Error accessing environment variables:\", e);\n  }\n  const finalKey = apiKey || envKey;\n  if (!finalKey) {\n    console.warn(\"Gemini API Key missing. Ensure VITE_GEMINI_API_KEY is set.\");\n  }\n  if (!aiClientInstance || finalKey && aiClientInstanceKey !== finalKey) {\n    aiClientInstance = new GeminiClient(finalKey || 'dummy-key-for-test');\n    aiClientInstanceKey = finalKey;\n  }\n  return aiClientInstance;\n};","map":{"version":3,"names":["GEMINI_MODEL_NAME","AI_MODEL_NAME","AI_GENERATION_CONFIG","responseMimeType","SchemaType","GeminiClient","constructor","apiKey","options","defaultModelName","model","generateContent","params","text","contents","generationConfig","systemInstruction","undefined","Array","isArray","config","finalContents","role","parts","map","c","JSON","stringify","url","requestBody","makeRequest","retries","delay","response","fetch","method","headers","body","status","console","warn","Promise","resolve","setTimeout","Error","ok","errorText","error","statusText","data","json","candidates","content","promptFeedback","message","includes","models","bind","generateVideos","live","connect","chat","history","messages","sendMessage","msg","userMsg","newHistory","result","sendMessageStream","stream","startChat","res","aiClientInstance","aiClientInstanceKey","getAIClient","envKey","import","meta","env","VITE_GEMINI_API_KEY","process","e","finalKey"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/lib/ai.ts"],"sourcesContent":["\r\nexport const GEMINI_MODEL_NAME = \"gemini-2.5-flash\";\r\nexport const AI_MODEL_NAME = GEMINI_MODEL_NAME;\r\n\r\nexport const AI_GENERATION_CONFIG = {\r\n    responseMimeType: \"application/json\"\r\n};\r\n\r\nexport enum SchemaType {\r\n    STRING = \"STRING\",\r\n    NUMBER = \"NUMBER\",\r\n    INTEGER = \"INTEGER\",\r\n    BOOLEAN = \"BOOLEAN\",\r\n    ARRAY = \"ARRAY\",\r\n    OBJECT = \"OBJECT\"\r\n}\r\n\r\n/**\r\n * Google Gemini AI Client (Fetch Implementation)\r\n */\r\nexport class GeminiClient {\r\n    private apiKey: string;\r\n    private defaultModelName: string;\r\n\r\n    constructor(apiKey: string, options: { model?: string } = {}) {\r\n        this.apiKey = apiKey;\r\n        this.defaultModelName = options.model || GEMINI_MODEL_NAME;\r\n    }\r\n\r\n    /**\r\n     * Unified generate content method supporting:\r\n     * - params.config (legacy/component specific)\r\n     * - params.generationConfig (SDK standard)\r\n     * - params.systemInstruction (SDK standard)\r\n     * - Automatic content normalization\r\n     */\r\n    async generateContent(params: { model?: string; contents: any; config?: any; generationConfig?: any; systemInstruction?: any } | any) {\r\n        if (!this.apiKey) {\r\n            return { text: \"Error: AI API Key is missing. Please check your settings.\" };\r\n        }\r\n\r\n        // Handle both object params and direct content pass (legacy support if any)\r\n        let model = this.defaultModelName;\r\n        let contents = params;\r\n        let generationConfig: any = {};\r\n        let systemInstruction: any = undefined;\r\n\r\n        if (params && typeof params === 'object' && !Array.isArray(params) && params.contents) {\r\n            // It's the params object\r\n            model = params.model || this.defaultModelName;\r\n            contents = params.contents;\r\n            // Extract generationConfig\r\n            generationConfig = params.generationConfig || params.config || {};\r\n\r\n            // Extract systemInstruction - check top level first, then inside config\r\n            if (params.systemInstruction) {\r\n                systemInstruction = params.systemInstruction;\r\n            } else if (generationConfig && generationConfig.systemInstruction) {\r\n                // Fix: Move systemInstruction out of generationConfig if incorrectly placed there\r\n                systemInstruction = generationConfig.systemInstruction;\r\n                delete generationConfig.systemInstruction;\r\n            }\r\n        }\r\n\r\n        // Normalize contents to Gemini API format\r\n        let finalContents: any[] = [];\r\n        if (typeof contents === 'string') {\r\n            finalContents = [{ role: 'user', parts: [{ text: contents }] }];\r\n        } else if (contents.parts) {\r\n            finalContents = [{ role: 'user', parts: contents.parts }];\r\n        } else if (Array.isArray(contents)) {\r\n            finalContents = contents;\r\n        } else {\r\n            finalContents = [contents]; // Fallback\r\n        }\r\n\r\n        // Ensure parts structure is correct\r\n        finalContents = finalContents.map(c => {\r\n            // If c has role and parts, it's good.\r\n            if (c.role && c.parts) return c;\r\n            // If c is just { text: ... } or string, structure it.\r\n            if (typeof c === 'string') return { role: 'user', parts: [{ text: c }] };\r\n            return { role: 'user', parts: [{ text: JSON.stringify(c) }] }; // Last resort fallback\r\n        });\r\n\r\n\r\n        const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.apiKey}`;\r\n\r\n        const requestBody: any = {\r\n            contents: finalContents,\r\n            generationConfig: generationConfig\r\n        };\r\n\r\n        if (systemInstruction) {\r\n            requestBody.systemInstruction = systemInstruction;\r\n        }\r\n\r\n        const makeRequest = async (retries = 3, delay = 2000): Promise<any> => {\r\n            try {\r\n                const response = await fetch(url, {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify(requestBody)\r\n                });\r\n\r\n                if (response.status === 429) {\r\n                    if (retries > 0) {\r\n                        console.warn(`Gemini Rate Limit Exceeded. Retrying in ${delay}ms... (${retries} retries left)`);\r\n                        await new Promise(resolve => setTimeout(resolve, delay));\r\n                        return makeRequest(retries - 1, delay * 2); // Exponential backoff\r\n                    } else {\r\n                        throw new Error(\"AI Busy: Too many requests. Please wait a minute and try again.\");\r\n                    }\r\n                }\r\n\r\n                if (!response.ok) {\r\n                    const errorText = await response.text();\r\n                    console.error(`Gemini API Error ${response.status}: ${errorText}`);\r\n                    throw new Error(`Gemini API Error: ${response.statusText}`);\r\n                }\r\n\r\n                const data = await response.json();\r\n                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || \"\";\r\n\r\n                return {\r\n                    text: text,\r\n                    candidates: data.candidates,\r\n                    promptFeedback: data.promptFeedback,\r\n                    // Mocking response object for compatibility\r\n                    response: {\r\n                        text: () => text,\r\n                        candidates: data.candidates\r\n                    }\r\n                };\r\n\r\n            } catch (error: any) {\r\n                // If it's a network error or other fetch error, we might want to retry too, \r\n                // but for now let's focus on the explicit recursion for 429.\r\n                // If the error was thrown from the 429 block, rethrow it.\r\n                if (error.message.includes(\"AI Busy\")) throw error;\r\n\r\n                throw error;\r\n            }\r\n        };\r\n\r\n        try {\r\n            return await makeRequest();\r\n        } catch (error: any) {\r\n            console.error(\"Gemini Request Failed:\", error);\r\n            // Return safe error object\r\n            return {\r\n                text: `AI Error: ${error.message || \"Connection failed\"}`,\r\n                error: error\r\n            };\r\n        }\r\n    }\r\n\r\n    // --- Feature Stubs ---\r\n\r\n    get models() {\r\n        return {\r\n            generateContent: this.generateContent.bind(this),\r\n            generateVideos: async () => {\r\n                console.warn(\"Video generation stub called.\");\r\n                throw new Error(\"Video generation is currently unavailable.\");\r\n            }\r\n        };\r\n    }\r\n\r\n    get live() {\r\n        return {\r\n            connect: async () => {\r\n                console.warn(\"Live stub called.\");\r\n                throw new Error(\"Live voice features are currently unavailable.\");\r\n            }\r\n        };\r\n    }\r\n\r\n    // Legacy Chat Support - redirects to generateContent but manages history manually in UI usually\r\n    async chat(params: { model: string; messages: any[]; config?: any }) {\r\n        // We just return a helper that has sendMessage\r\n        const history = params.messages || [];\r\n        const model = params.model || this.defaultModelName;\r\n        const config = params.config;\r\n\r\n        return {\r\n            sendMessage: async (msg: string | any) => {\r\n                const userMsg = typeof msg === 'string' ? { role: 'user', parts: [{ text: msg }] } : msg;\r\n                const newHistory = [...history, userMsg];\r\n                const result = await this.generateContent({\r\n                    model: model,\r\n                    contents: newHistory,\r\n                    config: config\r\n                });\r\n                return result;\r\n            },\r\n            // Streaming stub\r\n            sendMessageStream: async (msg: string | any) => {\r\n                console.warn(\"Streaming not implemented in basic fetch client.\");\r\n                const result = await this.generateContent({\r\n                    model: model,\r\n                    contents: [...history, typeof msg === 'string' ? { role: 'user', parts: [{ text: msg }] } : msg],\r\n                    config: config\r\n                });\r\n                // Mock stream response\r\n                return {\r\n                    stream: (async function* () {\r\n                        yield { text: () => result.text };\r\n                    })(),\r\n                    response: Promise.resolve(result)\r\n                };\r\n            }\r\n        };\r\n    }\r\n\r\n    // Legacy startChat for backward compatibility\r\n    startChat(config: any) {\r\n        return {\r\n            sendMessage: async (msg: string) => this.generateContent({\r\n                model: this.defaultModelName,\r\n                contents: [...(config.history || []), { role: 'user', parts: [{ text: msg }] }]\r\n            }),\r\n            sendMessageStream: async (msg: string) => {\r\n                const res = await this.generateContent({\r\n                    model: this.defaultModelName,\r\n                    contents: [...(config.history || []), { role: 'user', parts: [{ text: msg }] }]\r\n                });\r\n                return {\r\n                    stream: (async function* () { yield { text: () => res.text }; })(),\r\n                    response: Promise.resolve(res)\r\n                };\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\n// Singleton Management\r\nlet aiClientInstance: GeminiClient | null = null;\r\nlet aiClientInstanceKey: string | null = null;\r\n\r\nexport const getAIClient = (apiKey?: string) => {\r\n    let envKey = '';\r\n    // Safe environment variable access for both Vite (Browser) and Node (Test)\r\n    try {\r\n        if (typeof import.meta !== 'undefined' && import.meta.env) {\r\n            envKey = import.meta.env.VITE_GEMINI_API_KEY;\r\n        } else if (typeof process !== 'undefined' && process.env) {\r\n            envKey = process.env.VITE_GEMINI_API_KEY || '';\r\n        }\r\n    } catch (e) {\r\n        console.warn(\"Error accessing environment variables:\", e);\r\n    }\r\n\r\n    const finalKey = apiKey || envKey;\r\n\r\n    if (!finalKey) {\r\n        console.warn(\"Gemini API Key missing. Ensure VITE_GEMINI_API_KEY is set.\");\r\n    }\r\n\r\n    if (!aiClientInstance || (finalKey && aiClientInstanceKey !== finalKey)) {\r\n        aiClientInstance = new GeminiClient(finalKey || 'dummy-key-for-test');\r\n        aiClientInstanceKey = finalKey;\r\n    }\r\n\r\n    return aiClientInstance; // Returns the class instance directly\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}