{"ast":null,"code":"const RESEND_API_KEY = import.meta.env.VITE_RESEND_API_KEY || '';\nconst FROM_EMAIL = import.meta.env.VITE_FROM_EMAIL || 'onboarding@resend.dev';\nconst SCHOOL_NAME = 'Oliskey School App';\nexport const sendWelcomeEmail = async ({\n  toEmail,\n  userName,\n  username,\n  password,\n  userType\n}) => {\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send. Set VITE_RESEND_API_KEY in .env');\n    return {\n      success: true\n    };\n  }\n  try {\n    const emailHtml = `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset=\"utf-8\">\n          <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background: linear-gradient(135deg, #0EA5E9 0%, #06B6D4 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }\n            .content { background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; }\n            .credentials-box { background: white; border: 2px solid #0EA5E9; padding: 20px; margin: 20px 0; border-radius: 8px; }\n            .credential-row { display: flex; justify-content: space-between; margin: 10px 0; padding: 10px; background: #f0f9ff; border-radius: 4px; }\n            .label { font-weight: bold; color: #0369a1; }\n            .value { font-family: monospace; background: white; padding: 5px 10px; border-radius: 4px; }\n            .button { display: inline-block; background: #0EA5E9; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; margin: 20px 0; }\n            .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 20px; }\n            .warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 20px 0; }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <div class=\"header\">\n              <h1>üéì Welcome to ${SCHOOL_NAME}!</h1>\n              <p>Your account has been created successfully</p>\n            </div>\n            <div class=\"content\">\n              <p>Hello <strong>${userName}</strong>,</p>\n              \n              <p>Your <strong>${userType}</strong> account has been created and is ready to use. You can now access the school portal using the credentials below:</p>\n              \n              <div class=\"credentials-box\">\n                <h3>üîê Login Credentials</h3>\n                <div class=\"credential-row\">\n                  <span class=\"label\">Username:</span>\n                  <span class=\"value\">${username}</span>\n                </div>\n                <div class=\"credential-row\">\n                  <span class=\"label\">Password:</span>\n                  <span class=\"value\">${password}</span>\n                </div>\n                <div class=\"credential-row\">\n                  <span class=\"label\">Email:</span>\n                  <span class=\"value\">${toEmail}</span>\n                </div>\n              </div>\n\n              <div class=\"warning\">\n                ‚ö†Ô∏è <strong>Security Note:</strong> Please change your password after first login. Do not share these credentials with anyone.\n              </div>\n\n              <div style=\"text-align: center;\">\n                <a href=\"http://localhost:5173\" class=\"button\">Login to Portal</a>\n              </div>\n\n              <h3>üìö What's Next?</h3>\n              <ul>\n                <li>Log in to your account using the credentials above</li>\n                <li>Complete your profile information</li>\n                <li>Explore the dashboard and features</li>\n                <li>Change your password in Settings ‚Üí Security</li>\n              </ul>\n\n              <p>If you have any questions or need assistance, please contact the school administration.</p>\n\n              <div class=\"footer\">\n                <p>This is an automated message from ${SCHOOL_NAME}</p>\n                <p>Please do not reply to this email</p>\n              </div>\n            </div>\n          </div>\n        </body>\n      </html>\n    `;\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: FROM_EMAIL,\n        to: toEmail,\n        subject: `üéì Welcome to ${SCHOOL_NAME} - Your Account is Ready!`,\n        html: emailHtml\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error('Resend API error:', errorData);\n      return {\n        success: false,\n        error: `Email service error: ${errorData.message || 'Unknown error'}`\n      };\n    }\n    const result = await response.json();\n    console.log('‚úÖ Welcome email sent successfully:', result.id);\n    return {\n      success: true\n    };\n  } catch (err) {\n    console.error('Error sending welcome email:', err);\n    return {\n      success: false,\n      error: err.message\n    };\n  }\n};\nexport const sendPasswordResetEmail = async (toEmail, userName, resetToken) => {\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\n    return {\n      success: true\n    };\n  }\n  try {\n    const resetLink = `http://localhost:5173/reset-password?token=${resetToken}`;\n    const emailHtml = `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset=\"utf-8\">\n          <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background: linear-gradient(135deg, #dc2626 0%, #ea580c 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }\n            .content { background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; }\n            .button { display: inline-block; background: #dc2626; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; margin: 20px 0; }\n            .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 20px; }\n            .warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 20px 0; }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <div class=\"header\">\n              <h1>üîê Password Reset Request</h1>\n            </div>\n            <div class=\"content\">\n              <p>Hello <strong>${userName}</strong>,</p>\n              \n              <p>We received a request to reset your password for your ${SCHOOL_NAME} account.</p>\n              \n              <div style=\"text-align: center;\">\n                <a href=\"${resetLink}\" class=\"button\">Reset Password</a>\n              </div>\n\n              <div class=\"warning\">\n                ‚ö†Ô∏è This link will expire in 1 hour. If you did not request this password reset, please ignore this email.\n              </div>\n\n              <p>Or copy and paste this link in your browser:</p>\n              <p style=\"word-break: break-all; background: #f3f4f6; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 12px;\">\n                ${resetLink}\n              </p>\n\n              <div class=\"footer\">\n                <p>This is an automated message from ${SCHOOL_NAME}</p>\n                <p>Please do not reply to this email</p>\n              </div>\n            </div>\n          </div>\n        </body>\n      </html>\n    `;\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: FROM_EMAIL,\n        to: toEmail,\n        subject: `üîê Password Reset - ${SCHOOL_NAME}`,\n        html: emailHtml\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      return {\n        success: false,\n        error: errorData.message\n      };\n    }\n    return {\n      success: true\n    };\n  } catch (err) {\n    console.error('Error sending password reset email:', err);\n    return {\n      success: false,\n      error: err.message\n    };\n  }\n};\nimport { generateFeeAssignmentEmail, generatePaymentConfirmationEmail, generateAbsenceNotificationEmail, generateEmergencyBroadcastEmail } from './email-templates';\nexport const sendFeeAssignmentEmail = async data => {\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\n    return {\n      success: true\n    };\n  }\n  try {\n    const emailHtml = generateFeeAssignmentEmail(data);\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: FROM_EMAIL,\n        to: data.toEmail,\n        subject: `üí∞ New Fee Assigned - ${data.feeTitle}`,\n        html: emailHtml\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error('Resend API error:', errorData);\n      return {\n        success: false,\n        error: errorData.message\n      };\n    }\n    const result = await response.json();\n    console.log('‚úÖ Fee assignment email sent:', result.id);\n    return {\n      success: true\n    };\n  } catch (err) {\n    console.error('Error sending fee assignment email:', err);\n    return {\n      success: false,\n      error: err.message\n    };\n  }\n};\nexport const sendPaymentConfirmationEmail = async data => {\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\n    return {\n      success: true\n    };\n  }\n  try {\n    const emailHtml = generatePaymentConfirmationEmail(data);\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: FROM_EMAIL,\n        to: data.toEmail,\n        subject: `‚úÖ Payment Received - ${data.feeTitle}`,\n        html: emailHtml\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error('Resend API error:', errorData);\n      return {\n        success: false,\n        error: errorData.message\n      };\n    }\n    const result = await response.json();\n    console.log('‚úÖ Payment confirmation email sent:', result.id);\n    return {\n      success: true\n    };\n  } catch (err) {\n    console.error('Error sending payment confirmation email:', err);\n    return {\n      success: false,\n      error: err.message\n    };\n  }\n};\nexport const sendAbsenceNotificationEmail = async data => {\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\n    return {\n      success: true\n    };\n  }\n  try {\n    const emailHtml = generateAbsenceNotificationEmail(data);\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: FROM_EMAIL,\n        to: data.toEmail,\n        subject: `‚ö†Ô∏è Absence Notification - ${data.studentName}`,\n        html: emailHtml\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error('Resend API error:', errorData);\n      return {\n        success: false,\n        error: errorData.message\n      };\n    }\n    const result = await response.json();\n    console.log('‚úÖ Absence notification email sent:', result.id);\n    return {\n      success: true\n    };\n  } catch (err) {\n    console.error('Error sending absence notification email:', err);\n    return {\n      success: false,\n      error: err.message\n    };\n  }\n};\nexport const sendEmergencyBroadcastEmail = async data => {\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\n    return {\n      success: true\n    };\n  }\n  try {\n    const emailHtml = generateEmergencyBroadcastEmail(data);\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        from: FROM_EMAIL,\n        to: data.toEmail,\n        subject: `üö® ${data.urgencyLevel.toUpperCase()} ALERT: ${data.title}`,\n        html: emailHtml\n      })\n    });\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error('Resend API error:', errorData);\n      return {\n        success: false,\n        error: errorData.message\n      };\n    }\n    const result = await response.json();\n    console.log('‚úÖ Emergency broadcast email sent:', result.id);\n    return {\n      success: true\n    };\n  } catch (err) {\n    console.error('Error sending emergency broadcast email:', err);\n    return {\n      success: false,\n      error: err.message\n    };\n  }\n};","map":{"version":3,"names":["RESEND_API_KEY","import","meta","env","VITE_RESEND_API_KEY","FROM_EMAIL","VITE_FROM_EMAIL","SCHOOL_NAME","sendWelcomeEmail","toEmail","userName","username","password","userType","console","warn","success","emailHtml","response","fetch","method","headers","body","JSON","stringify","from","to","subject","html","ok","errorData","json","error","message","result","log","id","err","sendPasswordResetEmail","resetToken","resetLink","generateFeeAssignmentEmail","generatePaymentConfirmationEmail","generateAbsenceNotificationEmail","generateEmergencyBroadcastEmail","sendFeeAssignmentEmail","data","feeTitle","sendPaymentConfirmationEmail","sendAbsenceNotificationEmail","studentName","sendEmergencyBroadcastEmail","urgencyLevel","toUpperCase","title"],"sources":["C:/Users/USER/OneDrive/Desktop/Project/school-app-/lib/emailService.ts"],"sourcesContent":["/**\r\n * Email Service using Resend API\r\n * Sends welcome and verification emails to new users\r\n */\r\n\r\nconst RESEND_API_KEY = import.meta.env.VITE_RESEND_API_KEY || '';\r\nconst FROM_EMAIL = import.meta.env.VITE_FROM_EMAIL || 'onboarding@resend.dev';\r\nconst SCHOOL_NAME = 'Oliskey School App';\r\n\r\ninterface SendWelcomeEmailParams {\r\n  toEmail: string;\r\n  userName: string;\r\n  username: string;\r\n  password: string;\r\n  userType: string;\r\n}\r\n\r\n/**\r\n * Sends a welcome email with login credentials\r\n */\r\nexport const sendWelcomeEmail = async ({\r\n  toEmail,\r\n  userName,\r\n  username,\r\n  password,\r\n  userType\r\n}: SendWelcomeEmailParams): Promise<{ success: boolean; error?: string }> => {\r\n\r\n  // If no API key is configured, skip email sending (development mode)\r\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\r\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send. Set VITE_RESEND_API_KEY in .env');\r\n    return { success: true }; // Don't fail the account creation\r\n  }\r\n\r\n  try {\r\n    const emailHtml = `\r\n      <!DOCTYPE html>\r\n      <html>\r\n        <head>\r\n          <meta charset=\"utf-8\">\r\n          <style>\r\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\r\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\r\n            .header { background: linear-gradient(135deg, #0EA5E9 0%, #06B6D4 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }\r\n            .content { background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; }\r\n            .credentials-box { background: white; border: 2px solid #0EA5E9; padding: 20px; margin: 20px 0; border-radius: 8px; }\r\n            .credential-row { display: flex; justify-content: space-between; margin: 10px 0; padding: 10px; background: #f0f9ff; border-radius: 4px; }\r\n            .label { font-weight: bold; color: #0369a1; }\r\n            .value { font-family: monospace; background: white; padding: 5px 10px; border-radius: 4px; }\r\n            .button { display: inline-block; background: #0EA5E9; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; margin: 20px 0; }\r\n            .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 20px; }\r\n            .warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 20px 0; }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <div class=\"container\">\r\n            <div class=\"header\">\r\n              <h1>üéì Welcome to ${SCHOOL_NAME}!</h1>\r\n              <p>Your account has been created successfully</p>\r\n            </div>\r\n            <div class=\"content\">\r\n              <p>Hello <strong>${userName}</strong>,</p>\r\n              \r\n              <p>Your <strong>${userType}</strong> account has been created and is ready to use. You can now access the school portal using the credentials below:</p>\r\n              \r\n              <div class=\"credentials-box\">\r\n                <h3>üîê Login Credentials</h3>\r\n                <div class=\"credential-row\">\r\n                  <span class=\"label\">Username:</span>\r\n                  <span class=\"value\">${username}</span>\r\n                </div>\r\n                <div class=\"credential-row\">\r\n                  <span class=\"label\">Password:</span>\r\n                  <span class=\"value\">${password}</span>\r\n                </div>\r\n                <div class=\"credential-row\">\r\n                  <span class=\"label\">Email:</span>\r\n                  <span class=\"value\">${toEmail}</span>\r\n                </div>\r\n              </div>\r\n\r\n              <div class=\"warning\">\r\n                ‚ö†Ô∏è <strong>Security Note:</strong> Please change your password after first login. Do not share these credentials with anyone.\r\n              </div>\r\n\r\n              <div style=\"text-align: center;\">\r\n                <a href=\"http://localhost:5173\" class=\"button\">Login to Portal</a>\r\n              </div>\r\n\r\n              <h3>üìö What's Next?</h3>\r\n              <ul>\r\n                <li>Log in to your account using the credentials above</li>\r\n                <li>Complete your profile information</li>\r\n                <li>Explore the dashboard and features</li>\r\n                <li>Change your password in Settings ‚Üí Security</li>\r\n              </ul>\r\n\r\n              <p>If you have any questions or need assistance, please contact the school administration.</p>\r\n\r\n              <div class=\"footer\">\r\n                <p>This is an automated message from ${SCHOOL_NAME}</p>\r\n                <p>Please do not reply to this email</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </body>\r\n      </html>\r\n    `;\r\n\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        from: FROM_EMAIL,\r\n        to: toEmail,\r\n        subject: `üéì Welcome to ${SCHOOL_NAME} - Your Account is Ready!`,\r\n        html: emailHtml\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      console.error('Resend API error:', errorData);\r\n      return { success: false, error: `Email service error: ${errorData.message || 'Unknown error'}` };\r\n    }\r\n\r\n    const result = await response.json();\r\n    console.log('‚úÖ Welcome email sent successfully:', result.id);\r\n\r\n    return { success: true };\r\n  } catch (err: any) {\r\n    console.error('Error sending welcome email:', err);\r\n    return { success: false, error: err.message };\r\n  }\r\n};\r\n\r\n/**\r\n * Sends a password reset email\r\n */\r\nexport const sendPasswordResetEmail = async (\r\n  toEmail: string,\r\n  userName: string,\r\n  resetToken: string\r\n): Promise<{ success: boolean; error?: string }> => {\r\n\r\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\r\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\r\n    return { success: true };\r\n  }\r\n\r\n  try {\r\n    const resetLink = `http://localhost:5173/reset-password?token=${resetToken}`;\r\n\r\n    const emailHtml = `\r\n      <!DOCTYPE html>\r\n      <html>\r\n        <head>\r\n          <meta charset=\"utf-8\">\r\n          <style>\r\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\r\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\r\n            .header { background: linear-gradient(135deg, #dc2626 0%, #ea580c 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }\r\n            .content { background: #f9fafb; padding: 30px; border-radius: 0 0 10px 10px; }\r\n            .button { display: inline-block; background: #dc2626; color: white; padding: 12px 30px; text-decoration: none; border-radius: 6px; margin: 20px 0; }\r\n            .footer { text-align: center; color: #6b7280; font-size: 12px; margin-top: 20px; }\r\n            .warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; margin: 20px 0; }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <div class=\"container\">\r\n            <div class=\"header\">\r\n              <h1>üîê Password Reset Request</h1>\r\n            </div>\r\n            <div class=\"content\">\r\n              <p>Hello <strong>${userName}</strong>,</p>\r\n              \r\n              <p>We received a request to reset your password for your ${SCHOOL_NAME} account.</p>\r\n              \r\n              <div style=\"text-align: center;\">\r\n                <a href=\"${resetLink}\" class=\"button\">Reset Password</a>\r\n              </div>\r\n\r\n              <div class=\"warning\">\r\n                ‚ö†Ô∏è This link will expire in 1 hour. If you did not request this password reset, please ignore this email.\r\n              </div>\r\n\r\n              <p>Or copy and paste this link in your browser:</p>\r\n              <p style=\"word-break: break-all; background: #f3f4f6; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 12px;\">\r\n                ${resetLink}\r\n              </p>\r\n\r\n              <div class=\"footer\">\r\n                <p>This is an automated message from ${SCHOOL_NAME}</p>\r\n                <p>Please do not reply to this email</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </body>\r\n      </html>\r\n    `;\r\n\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        from: FROM_EMAIL,\r\n        to: toEmail,\r\n        subject: `üîê Password Reset - ${SCHOOL_NAME}`,\r\n        html: emailHtml\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      return { success: false, error: errorData.message };\r\n    }\r\n\r\n    return { success: true };\r\n  } catch (err: any) {\r\n    console.error('Error sending password reset email:', err);\r\n    return { success: false, error: err.message };\r\n  }\r\n};\r\n\r\n/**\r\n * Import email templates\r\n */\r\nimport {\r\n  generateFeeAssignmentEmail,\r\n  generatePaymentConfirmationEmail,\r\n  generateAbsenceNotificationEmail,\r\n  generateEmergencyBroadcastEmail,\r\n  type FeeAssignmentEmailData,\r\n  type PaymentConfirmationEmailData,\r\n  type AbsenceNotificationEmailData,\r\n  type EmergencyBroadcastEmailData\r\n} from './email-templates';\r\n\r\n/**\r\n * Send fee assignment notification email to parent\r\n */\r\nexport const sendFeeAssignmentEmail = async (\r\n  data: FeeAssignmentEmailData & { toEmail: string }\r\n): Promise<{ success: boolean; error?: string }> => {\r\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\r\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\r\n    return { success: true };\r\n  }\r\n\r\n  try {\r\n    const emailHtml = generateFeeAssignmentEmail(data);\r\n\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        from: FROM_EMAIL,\r\n        to: data.toEmail,\r\n        subject: `üí∞ New Fee Assigned - ${data.feeTitle}`,\r\n        html: emailHtml\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      console.error('Resend API error:', errorData);\r\n      return { success: false, error: errorData.message };\r\n    }\r\n\r\n    const result = await response.json();\r\n    console.log('‚úÖ Fee assignment email sent:', result.id);\r\n    return { success: true };\r\n  } catch (err: any) {\r\n    console.error('Error sending fee assignment email:', err);\r\n    return { success: false, error: err.message };\r\n  }\r\n};\r\n\r\n/**\r\n * Send payment confirmation email to parent\r\n */\r\nexport const sendPaymentConfirmationEmail = async (\r\n  data: PaymentConfirmationEmailData & { toEmail: string }\r\n): Promise<{ success: boolean; error?: string }> => {\r\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\r\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\r\n    return { success: true };\r\n  }\r\n\r\n  try {\r\n    const emailHtml = generatePaymentConfirmationEmail(data);\r\n\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        from: FROM_EMAIL,\r\n        to: data.toEmail,\r\n        subject: `‚úÖ Payment Received - ${data.feeTitle}`,\r\n        html: emailHtml\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      console.error('Resend API error:', errorData);\r\n      return { success: false, error: errorData.message };\r\n    }\r\n\r\n    const result = await response.json();\r\n    console.log('‚úÖ Payment confirmation email sent:', result.id);\r\n    return { success: true };\r\n  } catch (err: any) {\r\n    console.error('Error sending payment confirmation email:', err);\r\n    return { success: false, error: err.message };\r\n  }\r\n};\r\n\r\n/**\r\n * Send absence notification email to parent\r\n */\r\nexport const sendAbsenceNotificationEmail = async (\r\n  data: AbsenceNotificationEmailData & { toEmail: string }\r\n): Promise<{ success: boolean; error?: string }> => {\r\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\r\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\r\n    return { success: true };\r\n  }\r\n\r\n  try {\r\n    const emailHtml = generateAbsenceNotificationEmail(data);\r\n\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        from: FROM_EMAIL,\r\n        to: data.toEmail,\r\n        subject: `‚ö†Ô∏è Absence Notification - ${data.studentName}`,\r\n        html: emailHtml\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      console.error('Resend API error:', errorData);\r\n      return { success: false, error: errorData.message };\r\n    }\r\n\r\n    const result = await response.json();\r\n    console.log('‚úÖ Absence notification email sent:', result.id);\r\n    return { success: true };\r\n  } catch (err: any) {\r\n    console.error('Error sending absence notification email:', err);\r\n    return { success: false, error: err.message };\r\n  }\r\n};\r\n\r\n/**\r\n * Send emergency broadcast email\r\n */\r\nexport const sendEmergencyBroadcastEmail = async (\r\n  data: EmergencyBroadcastEmailData & { toEmail: string }\r\n): Promise<{ success: boolean; error?: string }> => {\r\n  if (!RESEND_API_KEY || RESEND_API_KEY === '') {\r\n    console.warn('‚ö†Ô∏è Resend API key not configured. Skipping email send.');\r\n    return { success: true };\r\n  }\r\n\r\n  try {\r\n    const emailHtml = generateEmergencyBroadcastEmail(data);\r\n\r\n    const response = await fetch('https://api.resend.com/emails', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `Bearer ${RESEND_API_KEY}`,\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        from: FROM_EMAIL,\r\n        to: data.toEmail,\r\n        subject: `üö® ${data.urgencyLevel.toUpperCase()} ALERT: ${data.title}`,\r\n        html: emailHtml\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json();\r\n      console.error('Resend API error:', errorData);\r\n      return { success: false, error: errorData.message };\r\n    }\r\n\r\n    const result = await response.json();\r\n    console.log('‚úÖ Emergency broadcast email sent:', result.id);\r\n    return { success: true };\r\n  } catch (err: any) {\r\n    console.error('Error sending emergency broadcast email:', err);\r\n    return { success: false, error: err.message };\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}